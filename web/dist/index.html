<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Patina Chat</title>
    <script type="module" crossorigin>var yi=Object.defineProperty;var bi=(t,e,n)=>e in t?yi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var I=(t,e,n)=>bi(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var it,T,yn,bn,se,Kt,wn,xn,Sn,Rt,_t,gt,Ge={},Ve=[],wi=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,rt=Array.isArray;function K(t,e){for(var n in e)t[n]=e[n];return t}function At(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function xi(t,e,n){var i,r,s,c={};for(s in e)s=="key"?i=e[s]:s=="ref"?r=e[s]:c[s]=e[s];if(arguments.length>2&&(c.children=arguments.length>3?it.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(s in t.defaultProps)c[s]===void 0&&(c[s]=t.defaultProps[s]);return je(t,c,i,r,null)}function je(t,e,n,i,r){var s={type:t,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++yn,__i:-1,__u:0};return r==null&&T.vnode!=null&&T.vnode(s),s}function ue(t){return t.children}function Ce(t,e){this.props=t,this.context=e}function _e(t,e){if(e==null)return t.__?_e(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?_e(t):null}function Si(t){if(t.__P&&t.__d){var e=t.__v,n=e.__e,i=[],r=[],s=K({},e);s.__v=e.__v+1,T.vnode&&T.vnode(s),Pt(t.__P,s,e,t.__n,t.__P.namespaceURI,32&e.__u?[n]:null,i,n??_e(e),!!(32&e.__u),r),s.__v=e.__v,s.__.__k[s.__i]=s,In(i,s,r),e.__e=e.__=null,s.__e!=n&&$n(s)}}function $n(t){if((t=t.__)!=null&&t.__c!=null)return t.__e=t.__c.base=null,t.__k.some(function(e){if(e!=null&&e.__e!=null)return t.__e=t.__c.base=e.__e}),$n(t)}function Jt(t){(!t.__d&&(t.__d=!0)&&se.push(t)&&!Ke.__r++||Kt!=T.debounceRendering)&&((Kt=T.debounceRendering)||wn)(Ke)}function Ke(){for(var t,e=1;se.length;)se.length>e&&se.sort(xn),t=se.shift(),e=se.length,Si(t);Ke.__r=0}function Tn(t,e,n,i,r,s,c,a,u,o,h){var d,p,f,g,_,v,m,k=i&&i.__k||Ve,E=e.length;for(u=$i(n,e,k,u,E),d=0;d<E;d++)(f=n.__k[d])!=null&&(p=f.__i!=-1&&k[f.__i]||Ge,f.__i=d,v=Pt(t,f,p,r,s,c,a,u,o,h),g=f.__e,f.ref&&p.ref!=f.ref&&(p.ref&&Lt(p.ref,null,f),h.push(f.ref,f.__c||g,f)),_==null&&g!=null&&(_=g),(m=!!(4&f.__u))||p.__k===f.__k?u=Cn(f,u,t,m):typeof f.type=="function"&&v!==void 0?u=v:g&&(u=g.nextSibling),f.__u&=-7);return n.__e=_,u}function $i(t,e,n,i,r){var s,c,a,u,o,h=n.length,d=h,p=0;for(t.__k=new Array(r),s=0;s<r;s++)(c=e[s])!=null&&typeof c!="boolean"&&typeof c!="function"?(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?c=t.__k[s]=je(null,c,null,null,null):rt(c)?c=t.__k[s]=je(ue,{children:c},null,null,null):c.constructor===void 0&&c.__b>0?c=t.__k[s]=je(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):t.__k[s]=c,u=s+p,c.__=t,c.__b=t.__b+1,a=null,(o=c.__i=Ti(c,n,u,d))!=-1&&(d--,(a=n[o])&&(a.__u|=2)),a==null||a.__v==null?(o==-1&&(r>h?p--:r<h&&p++),typeof c.type!="function"&&(c.__u|=4)):o!=u&&(o==u-1?p--:o==u+1?p++:(o>u?p--:p++,c.__u|=4))):t.__k[s]=null;if(d)for(s=0;s<h;s++)(a=n[s])!=null&&(2&a.__u)==0&&(a.__e==i&&(i=_e(a)),An(a,a));return i}function Cn(t,e,n,i){var r,s;if(typeof t.type=="function"){for(r=t.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=t,e=Cn(r[s],e,n,i));return e}t.__e!=e&&(i&&(e&&t.type&&!e.parentNode&&(e=_e(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Ti(t,e,n,i){var r,s,c,a=t.key,u=t.type,o=e[n],h=o!=null&&(2&o.__u)==0;if(o===null&&a==null||h&&a==o.key&&u==o.type)return n;if(i>(h?1:0)){for(r=n-1,s=n+1;r>=0||s<e.length;)if((o=e[c=r>=0?r--:s++])!=null&&(2&o.__u)==0&&a==o.key&&u==o.type)return c}return-1}function Qt(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||wi.test(e)?n:n+"px"}function ze(t,e,n,i,r){var s,c;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof i=="string"&&(t.style.cssText=i=""),i)for(e in i)n&&e in n||Qt(t.style,e,"");if(n)for(e in n)i&&n[e]==i[e]||Qt(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(Sn,"$1")),c=e.toLowerCase(),e=c in t||e=="onFocusOut"||e=="onFocusIn"?c.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+s]=n,n?i?n.u=i.u:(n.u=Rt,t.addEventListener(e,s?gt:_t,s)):t.removeEventListener(e,s?gt:_t,s);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function Xt(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Rt++;else if(e.t<n.u)return;return n(T.event?T.event(e):e)}}}function Pt(t,e,n,i,r,s,c,a,u,o){var h,d,p,f,g,_,v,m,k,E,y,O,H,U,F,q=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(u=!!(32&n.__u),s=[a=e.__e=n.__e]),(h=T.__b)&&h(e);e:if(typeof q=="function")try{if(m=e.props,k="prototype"in q&&q.prototype.render,E=(h=q.contextType)&&i[h.__c],y=h?E?E.props.value:h.__:i,n.__c?v=(d=e.__c=n.__c).__=d.__E:(k?e.__c=d=new q(m,y):(e.__c=d=new Ce(m,y),d.constructor=q,d.render=Ii),E&&E.sub(d),d.state||(d.state={}),d.__n=i,p=d.__d=!0,d.__h=[],d._sb=[]),k&&d.__s==null&&(d.__s=d.state),k&&q.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=K({},d.__s)),K(d.__s,q.getDerivedStateFromProps(m,d.__s))),f=d.props,g=d.state,d.__v=e,p)k&&q.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),k&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(k&&q.getDerivedStateFromProps==null&&m!==f&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(m,y),e.__v==n.__v||!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(m,d.__s,y)===!1){e.__v!=n.__v&&(d.props=m,d.state=d.__s,d.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(ee){ee&&(ee.__=e)}),Ve.push.apply(d.__h,d._sb),d._sb=[],d.__h.length&&c.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(m,d.__s,y),k&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(f,g,_)})}if(d.context=y,d.props=m,d.__P=t,d.__e=!1,O=T.__r,H=0,k)d.state=d.__s,d.__d=!1,O&&O(e),h=d.render(d.props,d.state,d.context),Ve.push.apply(d.__h,d._sb),d._sb=[];else do d.__d=!1,O&&O(e),h=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++H<25);d.state=d.__s,d.getChildContext!=null&&(i=K(K({},i),d.getChildContext())),k&&!p&&d.getSnapshotBeforeUpdate!=null&&(_=d.getSnapshotBeforeUpdate(f,g)),U=h!=null&&h.type===ue&&h.key==null?Rn(h.props.children):h,a=Tn(t,rt(U)?U:[U],e,n,i,r,s,c,a,u,o),d.base=e.__e,e.__u&=-161,d.__h.length&&c.push(d),v&&(d.__E=d.__=null)}catch(ee){if(e.__v=null,u||s!=null)if(ee.then){for(e.__u|=u?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;s[s.indexOf(a)]=null,e.__e=a}else{for(F=s.length;F--;)At(s[F]);vt(e)}else e.__e=n.__e,e.__k=n.__k,ee.then||vt(e);T.__e(ee,e,n)}else s==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):a=e.__e=Ci(n.__e,e,n,i,r,s,c,u,o);return(h=T.diffed)&&h(e),128&e.__u?void 0:a}function vt(t){t&&(t.__c&&(t.__c.__e=!0),t.__k&&t.__k.some(vt))}function In(t,e,n){for(var i=0;i<n.length;i++)Lt(n[i],n[++i],n[++i]);T.__c&&T.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(s){s.call(r)})}catch(s){T.__e(s,r.__v)}})}function Rn(t){return typeof t!="object"||t==null||t.__b>0?t:rt(t)?t.map(Rn):K({},t)}function Ci(t,e,n,i,r,s,c,a,u){var o,h,d,p,f,g,_,v=n.props||Ge,m=e.props,k=e.type;if(k=="svg"?r="http://www.w3.org/2000/svg":k=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),s!=null){for(o=0;o<s.length;o++)if((f=s[o])&&"setAttribute"in f==!!k&&(k?f.localName==k:f.nodeType==3)){t=f,s[o]=null;break}}if(t==null){if(k==null)return document.createTextNode(m);t=document.createElementNS(r,k,m.is&&m),a&&(T.__m&&T.__m(e,s),a=!1),s=null}if(k==null)v===m||a&&t.data==m||(t.data=m);else{if(s=s&&it.call(t.childNodes),!a&&s!=null)for(v={},o=0;o<t.attributes.length;o++)v[(f=t.attributes[o]).name]=f.value;for(o in v)f=v[o],o=="dangerouslySetInnerHTML"?d=f:o=="children"||o in m||o=="value"&&"defaultValue"in m||o=="checked"&&"defaultChecked"in m||ze(t,o,null,f,r);for(o in m)f=m[o],o=="children"?p=f:o=="dangerouslySetInnerHTML"?h=f:o=="value"?g=f:o=="checked"?_=f:a&&typeof f!="function"||v[o]===f||ze(t,o,f,v[o],r);if(h)a||d&&(h.__html==d.__html||h.__html==t.innerHTML)||(t.innerHTML=h.__html),e.__k=[];else if(d&&(t.innerHTML=""),Tn(e.type=="template"?t.content:t,rt(p)?p:[p],e,n,i,k=="foreignObject"?"http://www.w3.org/1999/xhtml":r,s,c,s?s[0]:n.__k&&_e(n,0),a,u),s!=null)for(o=s.length;o--;)At(s[o]);a||(o="value",k=="progress"&&g==null?t.removeAttribute("value"):g!=null&&(g!==t[o]||k=="progress"&&!g||k=="option"&&g!=v[o])&&ze(t,o,g,v[o],r),o="checked",_!=null&&_!=t[o]&&ze(t,o,_,v[o],r))}return t}function Lt(t,e,n){try{if(typeof t=="function"){var i=typeof t.__u=="function";i&&t.__u(),i&&e==null||(t.__u=t(e))}else t.current=e}catch(r){T.__e(r,n)}}function An(t,e,n){var i,r;if(T.unmount&&T.unmount(t),(i=t.ref)&&(i.current&&i.current!=t.__e||Lt(i,null,e)),(i=t.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){T.__e(s,e)}i.base=i.__P=null}if(i=t.__k)for(r=0;r<i.length;r++)i[r]&&An(i[r],e,n||typeof t.type!="function");n||At(t.__e),t.__c=t.__=t.__e=void 0}function Ii(t,e,n){return this.constructor(t,n)}function Ri(t,e,n){var i,r,s,c;e==document&&(e=document.documentElement),T.__&&T.__(t,e),r=(i=!1)?null:e.__k,s=[],c=[],Pt(e,t=e.__k=xi(ue,null,[t]),r||Ge,Ge,e.namespaceURI,r?null:e.firstChild?it.call(e.childNodes):null,s,r?r.__e:e.firstChild,i,c),In(s,t,c)}it=Ve.slice,T={__e:function(t,e,n,i){for(var r,s,c;e=e.__;)if((r=e.__c)&&!r.__)try{if((s=r.constructor)&&s.getDerivedStateFromError!=null&&(r.setState(s.getDerivedStateFromError(t)),c=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t,i||{}),c=r.__d),c)return r.__E=r}catch(a){t=a}throw t}},yn=0,bn=function(t){return t!=null&&t.constructor===void 0},Ce.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=K({},this.state),typeof t=="function"&&(t=t(K({},n),this.props)),t&&K(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Jt(this))},Ce.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Jt(this))},Ce.prototype.render=ue,se=[],wn=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,xn=function(t,e){return t.__v.__b-e.__v.__b},Ke.__r=0,Sn=/(PointerCapture)$|Capture$/i,Rt=0,_t=Xt(!1),gt=Xt(!0);var Ai=0;function l(t,e,n,i,r,s){e||(e={});var c,a,u=e;if("ref"in u)for(a in u={},e)a=="ref"?c=e[a]:u[a]=e[a];var o={type:t,props:u,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ai,__i:-1,__u:0,__source:r,__self:s};if(typeof t=="function"&&(c=t.defaultProps))for(a in c)u[a]===void 0&&(u[a]=c[a]);return T.vnode&&T.vnode(o),o}var De,L,ut,Yt,Je=0,Pn=[],D=T,en=D.__b,tn=D.__r,nn=D.diffed,rn=D.__c,sn=D.unmount,on=D.__;function Dt(t,e){D.__h&&D.__h(L,t,Je||e),Je=0;var n=L.__H||(L.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function w(t){return Je=1,Pi(Dn,t)}function Pi(t,e,n){var i=Dt(De++,2);if(i.t=t,!i.__c&&(i.__=[Dn(void 0,e),function(a){var u=i.__N?i.__N[0]:i.__[0],o=i.t(u,a);u!==o&&(i.__N=[o,i.__[1]],i.__c.setState({}))}],i.__c=L,!L.__f)){var r=function(a,u,o){if(!i.__c.__H)return!0;var h=i.__c.__H.__.filter(function(p){return p.__c});if(h.every(function(p){return!p.__N}))return!s||s.call(this,a,u,o);var d=i.__c.props!==a;return h.some(function(p){if(p.__N){var f=p.__[0];p.__=p.__N,p.__N=void 0,f!==p.__[0]&&(d=!0)}}),s&&s.call(this,a,u,o)||d};L.__f=!0;var s=L.shouldComponentUpdate,c=L.componentWillUpdate;L.componentWillUpdate=function(a,u,o){if(this.__e){var h=s;s=void 0,r(a,u,o),s=h}c&&c.call(this,a,u,o)},L.shouldComponentUpdate=r}return i.__N||i.__}function X(t,e){var n=Dt(De++,3);!D.__s&&Ln(n.__H,e)&&(n.__=t,n.u=e,L.__H.__h.push(n))}function oe(t){return Je=5,Et(function(){return{current:t}},[])}function Et(t,e){var n=Dt(De++,7);return Ln(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Li(){for(var t;t=Pn.shift();){var e=t.__H;if(t.__P&&e)try{e.__h.some(Fe),e.__h.some(mt),e.__h=[]}catch(n){e.__h=[],D.__e(n,t.__v)}}}D.__b=function(t){L=null,en&&en(t)},D.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),on&&on(t,e)},D.__r=function(t){tn&&tn(t),De=0;var e=(L=t.__c).__H;e&&(ut===L?(e.__h=[],L.__h=[],e.__.some(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.some(Fe),e.__h.some(mt),e.__h=[],De=0)),ut=L},D.diffed=function(t){nn&&nn(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(Pn.push(e)!==1&&Yt===D.requestAnimationFrame||((Yt=D.requestAnimationFrame)||Di)(Li)),e.__H.__.some(function(n){n.u&&(n.__H=n.u),n.u=void 0})),ut=L=null},D.__c=function(t,e){e.some(function(n){try{n.__h.some(Fe),n.__h=n.__h.filter(function(i){return!i.__||mt(i)})}catch(i){e.some(function(r){r.__h&&(r.__h=[])}),e=[],D.__e(i,n.__v)}}),rn&&rn(t,e)},D.unmount=function(t){sn&&sn(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.some(function(i){try{Fe(i)}catch(r){e=r}}),n.__H=void 0,e&&D.__e(e,n.__v))};var an=typeof requestAnimationFrame=="function";function Di(t){var e,n=function(){clearTimeout(i),an&&cancelAnimationFrame(e),setTimeout(t)},i=setTimeout(n,35);an&&(e=requestAnimationFrame(n))}function Fe(t){var e=L,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),L=e}function mt(t){var e=L;t.__c=t.__(),L=e}function Ln(t,e){return!t||t.length!==e.length||e.some(function(n,i){return n!==t[i]})}function Dn(t,e){return typeof e=="function"?e(t):e}var Ei=Symbol.for("preact-signals");function st(){if(te>1)te--;else{for(var t,e=!1;Ie!==void 0;){var n=Ie;for(Ie=void 0,kt++;n!==void 0;){var i=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&Bn(n))try{n.c()}catch(r){e||(t=r,e=!0)}n=i}}if(kt=0,te--,e)throw t}}function Mi(t){if(te>0)return t();te++;try{return t()}finally{st()}}var S=void 0;function En(t){var e=S;S=void 0;try{return t()}finally{S=e}}var Ie=void 0,te=0,kt=0,Qe=0;function Mn(t){if(S!==void 0){var e=t.n;if(e===void 0||e.t!==S)return e={i:0,S:t,p:S.s,n:void 0,t:S,e:void 0,x:void 0,r:e},S.s!==void 0&&(S.s.n=e),S.s=e,t.n=e,32&S.f&&t.S(e),e;if(e.i===-1)return e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=S.s,e.n=void 0,S.s.n=e,S.s=e),e}}function B(t,e){this.v=t,this.i=0,this.n=void 0,this.t=void 0,this.W=e==null?void 0:e.watched,this.Z=e==null?void 0:e.unwatched,this.name=e==null?void 0:e.name}B.prototype.brand=Ei;B.prototype.h=function(){return!0};B.prototype.S=function(t){var e=this,n=this.t;n!==t&&t.e===void 0&&(t.x=n,this.t=t,n!==void 0?n.e=t:En(function(){var i;(i=e.W)==null||i.call(e)}))};B.prototype.U=function(t){var e=this;if(this.t!==void 0){var n=t.e,i=t.x;n!==void 0&&(n.x=i,t.e=void 0),i!==void 0&&(i.e=n,t.x=void 0),t===this.t&&(this.t=i,i===void 0&&En(function(){var r;(r=e.Z)==null||r.call(e)}))}};B.prototype.subscribe=function(t){var e=this;return Me(function(){var n=e.value,i=S;S=void 0;try{t(n)}finally{S=i}},{name:"sub"})};B.prototype.valueOf=function(){return this.value};B.prototype.toString=function(){return this.value+""};B.prototype.toJSON=function(){return this.value};B.prototype.peek=function(){var t=S;S=void 0;try{return this.value}finally{S=t}};Object.defineProperty(B.prototype,"value",{get:function(){var t=Mn(this);return t!==void 0&&(t.i=this.i),this.v},set:function(t){if(t!==this.v){if(kt>100)throw new Error("Cycle detected");this.v=t,this.i++,Qe++,te++;try{for(var e=this.t;e!==void 0;e=e.x)e.t.N()}finally{st()}}}});function R(t,e){return new B(t,e)}function Bn(t){for(var e=t.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function Nn(t){for(var e=t.s;e!==void 0;e=e.n){var n=e.S.n;if(n!==void 0&&(e.r=n),e.S.n=e,e.i=-1,e.n===void 0){t.s=e;break}}}function zn(t){for(var e=t.s,n=void 0;e!==void 0;){var i=e.p;e.i===-1?(e.S.U(e),i!==void 0&&(i.n=e.n),e.n!==void 0&&(e.n.p=i)):n=e,e.S.n=e.r,e.r!==void 0&&(e.r=void 0),e=i}t.s=n}function he(t,e){B.call(this,void 0),this.x=t,this.s=void 0,this.g=Qe-1,this.f=4,this.W=e==null?void 0:e.watched,this.Z=e==null?void 0:e.unwatched,this.name=e==null?void 0:e.name}he.prototype=new B;he.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Qe))return!0;if(this.g=Qe,this.f|=1,this.i>0&&!Bn(this))return this.f&=-2,!0;var t=S;try{Nn(this),S=this;var e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return S=t,zn(this),this.f&=-2,!0};he.prototype.S=function(t){if(this.t===void 0){this.f|=36;for(var e=this.s;e!==void 0;e=e.n)e.S.S(e)}B.prototype.S.call(this,t)};he.prototype.U=function(t){if(this.t!==void 0&&(B.prototype.U.call(this,t),this.t===void 0)){this.f&=-33;for(var e=this.s;e!==void 0;e=e.n)e.S.U(e)}};he.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var t=this.t;t!==void 0;t=t.x)t.t.N()}};Object.defineProperty(he.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var t=Mn(this);if(this.h(),t!==void 0&&(t.i=this.i),16&this.f)throw this.v;return this.v}});function ln(t,e){return new he(t,e)}function On(t){var e=t.u;if(t.u=void 0,typeof e=="function"){te++;var n=S;S=void 0;try{e()}catch(i){throw t.f&=-2,t.f|=8,Mt(t),i}finally{S=n,st()}}}function Mt(t){for(var e=t.s;e!==void 0;e=e.n)e.S.U(e);t.x=void 0,t.s=void 0,On(t)}function Bi(t){if(S!==this)throw new Error("Out-of-order effect");zn(this),S=t,this.f&=-2,8&this.f&&Mt(this),st()}function ve(t,e){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=e==null?void 0:e.name}ve.prototype.c=function(){var t=this.S();try{if(8&this.f||this.x===void 0)return;var e=this.x();typeof e=="function"&&(this.u=e)}finally{t()}};ve.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,On(this),Nn(this),te++;var t=S;return S=this,Bi.bind(this,t)};ve.prototype.N=function(){2&this.f||(this.f|=2,this.o=Ie,Ie=this)};ve.prototype.d=function(){this.f|=8,1&this.f||Mt(this)};ve.prototype.dispose=function(){this.d()};function Me(t,e){var n=new ve(t,e);try{n.c()}catch(r){throw n.d(),r}var i=n.d.bind(n);return i[Symbol.dispose]=i,i}var Hn,Oe,Ni=typeof window<"u"&&!!window.__PREACT_SIGNALS_DEVTOOLS__,Un=[];Me(function(){Hn=this.N})();function me(t,e){T[t]=e.bind(null,T[t]||function(){})}function Xe(t){if(Oe){var e=Oe;Oe=void 0,e()}Oe=t&&t.S()}function qn(t){var e=this,n=t.data,i=Oi(n);i.value=n;var r=Et(function(){for(var a=e,u=e.__v;u=u.__;)if(u.__c){u.__c.__$f|=4;break}var o=ln(function(){var f=i.value.value;return f===0?0:f===!0?"":f||""}),h=ln(function(){return!Array.isArray(o.value)&&!bn(o.value)}),d=Me(function(){if(this.N=jn,h.value){var f=o.value;a.__v&&a.__v.__e&&a.__v.__e.nodeType===3&&(a.__v.__e.data=f)}}),p=e.__$u.d;return e.__$u.d=function(){d(),p.call(this)},[h,o]},[]),s=r[0],c=r[1];return s.value?c.peek():c.value}qn.displayName="ReactiveTextNode";Object.defineProperties(B.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:qn},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});me("__b",function(t,e){if(typeof e.type=="string"){var n,i=e.props;for(var r in i)if(r!=="children"){var s=i[r];s instanceof B&&(n||(e.__np=n={}),n[r]=s,i[r]=s.peek())}}t(e)});me("__r",function(t,e){if(t(e),e.type!==ue){Xe();var n,i=e.__c;i&&(i.__$f&=-2,(n=i.__$u)===void 0&&(i.__$u=n=(function(r,s){var c;return Me(function(){c=this},{name:s}),c.c=r,c})(function(){var r;Ni&&((r=n.y)==null||r.call(n)),i.__$f|=1,i.setState({})},typeof e.type=="function"?e.type.displayName||e.type.name:""))),Xe(n)}});me("__e",function(t,e,n,i){Xe(),t(e,n,i)});me("diffed",function(t,e){Xe();var n;if(typeof e.type=="string"&&(n=e.__e)){var i=e.__np,r=e.props;if(i){var s=n.U;if(s)for(var c in s){var a=s[c];a!==void 0&&!(c in i)&&(a.d(),s[c]=void 0)}else s={},n.U=s;for(var u in i){var o=s[u],h=i[u];o===void 0?(o=zi(n,u,h),s[u]=o):o.o(h,r)}for(var d in i)r[d]=i[d]}}t(e)});function zi(t,e,n,i){var r=e in t&&t.ownerSVGElement===void 0,s=R(n),c=n.peek();return{o:function(a,u){s.value=a,c=a.peek()},d:Me(function(){this.N=jn;var a=s.value.value;c!==a?(c=void 0,r?t[e]=a:a!=null&&(a!==!1||e[4]==="-")?t.setAttribute(e,a):t.removeAttribute(e)):c=void 0})}}me("unmount",function(t,e){if(typeof e.type=="string"){var n=e.__e;if(n){var i=n.U;if(i){n.U=void 0;for(var r in i){var s=i[r];s&&s.d()}}}e.__np=void 0}else{var c=e.__c;if(c){var a=c.__$u;a&&(c.__$u=void 0,a.d())}}t(e)});me("__h",function(t,e,n,i){(i<3||i===9)&&(e.__$f|=2),t(e,n,i)});Ce.prototype.shouldComponentUpdate=function(t,e){if(this.__R)return!0;var n=this.__$u,i=n&&n.s!==void 0;for(var r in e)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var s=2&this.__$f;if(!(i||s||4&this.__$f)||1&this.__$f)return!0}else if(!(i||4&this.__$f)||3&this.__$f)return!0;for(var c in t)if(c!=="__source"&&t[c]!==this.props[c])return!0;for(var a in this.props)if(!(a in t))return!0;return!1};function Oi(t,e){return Et(function(){return R(t,e)},[])}var Hi=function(t){queueMicrotask(function(){queueMicrotask(t)})};function Ui(){Mi(function(){for(var t;t=Un.shift();)Hn.call(t)})}function jn(){Un.push(this)===1&&(T.requestAnimationFrame||Hi)(Ui)}const qi=["chats","tasks","usage"];function Fn(){const t=window.location.hash.replace(/^#\/?/,"");return qi.includes(t)?t:"chats"}const Bt=R(Fn());function ji(t){window.location.hash=`/${t}`}window.addEventListener("hashchange",()=>{Bt.value=Fn()});function Wn(t){const e=Object.entries(t).filter(([,n])=>n).map(([n,i])=>`${encodeURIComponent(n)}=${encodeURIComponent(i)}`);return e.length?`?${e.join("&")}`:""}async function Fi(){return(await fetch("/api/sessions")).json()}async function Wi(){try{return await(await fetch("/api/personas")).json()}catch{return[]}}async function Zi(t){const e=await fetch("/api/personas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){const n=await e.json();throw new Error(n.error)}return e.json()}async function Gi(t,e){const n=await fetch(`/api/personas/${encodeURIComponent(t)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const i=await n.json();throw new Error(i.error)}return n.json()}async function Vi(t){const e=await fetch(`/api/personas/${encodeURIComponent(t)}`,{method:"DELETE"});if(!e.ok){const n=await e.json();throw new Error(n.error)}}async function Ki(t){return(await fetch("/api/personas/generate-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}async function Ji(){try{return await(await fetch("/api/model-tiers")).json()}catch{return["default"]}}async function Qi(t){return(await fetch(`/api/usage/summary${Wn(t)}`)).json()}async function $e(t){return(await fetch(`/api/usage/daily${Wn(t)}`)).json()}async function Xi(){return(await fetch("/api/usage/filters")).json()}async function Yi(){return(await fetch("/api/tasks")).json()}async function er(t){return(await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}async function Zn(t,e){await fetch(`/api/tasks/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async function Gn(t){await fetch(`/api/tasks/${t}`,{method:"DELETE"})}async function Vn(t,e){await fetch(`/api/tasks/${t}/move`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e})})}async function Kn(t,e){await fetch(`/api/tasks/${t}/assign`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({assignee:e})})}const A=R([]),Z=R(null),ae=R({}),Jn="patina-sessions";function tr(){const t=localStorage.getItem("patina-session"),e=localStorage.getItem(Jn);if(e)try{A.value=JSON.parse(e)}catch{A.value=[]}else t&&(A.value=[{id:t,title:"Chat",updatedAt:new Date().toISOString()}],localStorage.removeItem("patina-session"));ke()}function ke(){localStorage.setItem(Jn,JSON.stringify(A.value))}function ot(t){return A.value.find(e=>e.id===t)||null}function Qn(t){A.value=[t,...A.value],ke()}function Xn(t){A.value=A.value.filter(n=>n.id!==t);const e={...ae.value};delete e[t],ae.value=e,ke()}function Yn(t,e){const n=ot(t);n&&n.title==="New Chat"&&(n.title=e.length>50?e.substring(0,50)+"...":e,A.value=[...A.value],ke())}function yt(t){const e=ot(t);e&&(e.updatedAt=new Date().toISOString(),A.value=[...A.value],ke())}function cn(t){ae.value={...ae.value,[t]:!0}}function nr(t){const e={...ae.value};delete e[t],ae.value=e}function ir(t){const e=ot(t);return(e==null?void 0:e.persona)||null}function rr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}async function sr(){try{const t=await Fi(),e={},n=A.value;for(const i of t){e[i.key]=!0;const r=n.find(s=>s.id===i.key);r?(i.title&&i.title!==r.title&&(r.title=i.title),i.persona&&(r.persona=i.persona)):n.push({id:i.key,title:i.title||i.key.slice(0,8),updatedAt:i.updated_at||new Date().toISOString(),persona:i.persona||null})}A.value=[...n],ke()}catch{}}const Y=R([]),ei=R(["default"]);async function Nt(){Y.value=await Wi()}async function or(){ei.value=await Ji()}function ar(t){return Y.value.find(e=>e.key===t)||null}const lr=["#e74c3c","#e67e22","#f1c40f","#2ecc71","#1abc9c","#3498db","#9b59b6","#e91e63","#795548","#607d8b"],cr="_sidebar_1pufl_1",ur="_header_1pufl_12",hr="_titleWrap_1pufl_21",dr="_menuBtn_1pufl_25",pr="_chevron_1pufl_41",fr="_actions_1pufl_51",_r="_iconBtn_1pufl_56",gr="_newChatBtn_1pufl_75 _iconBtn_1pufl_56",vr="_sessionList_1pufl_81",mr="_sessionItem_1pufl_87",kr="_active_1pufl_103",yr="_avatar_1pufl_107",br="_content_1pufl_121",wr="_title_1pufl_21",xr="_unreadDot_1pufl_136",Sr="_time_1pufl_144",$r="_deleteBtn_1pufl_150",M={sidebar:cr,header:ur,titleWrap:hr,menuBtn:dr,chevron:pr,actions:fr,iconBtn:_r,newChatBtn:gr,sessionList:vr,sessionItem:mr,active:kr,avatar:yr,content:br,title:wr,unreadDot:xr,time:Sr,deleteBtn:$r},ht=[{key:"chats",label:"Chats"},{key:"tasks",label:"Tasks"},{key:"usage",label:"Usage"}];function Tr(t){try{const e=new Date(t),n=new Date;return e.toDateString()===n.toDateString()?e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):e.toLocaleDateString([],{month:"short",day:"numeric"})}catch{return""}}function Cr(t,e){return!t.persona||!e.length?null:e.find(n=>n.key===t.persona)||null}function Ir({onNewChat:t,onSwitchChat:e,onDeleteChat:n,onManagePersonas:i,sidebarHidden:r}){const[s,c]=w(!1),a=oe(null),u=Bt.value,o=ht.find(_=>_.key===u)||ht[0],h=A.value,d=Z.value,p=ae.value,f=Y.value,g=u==="chats";return X(()=>{if(!s)return;const _=v=>{a.current&&!a.current.contains(v.target)&&c(!1)};return document.addEventListener("click",_),()=>document.removeEventListener("click",_)},[s]),r?null:l("aside",{class:M.sidebar,children:[l("div",{class:M.header,children:[l("div",{class:M.titleWrap,ref:a,children:[l("button",{class:M.menuBtn,onClick:_=>{_.stopPropagation(),c(!s)},children:[l("h2",{children:o.label}),l("span",{class:M.chevron,children:"▾"})]}),s&&l("div",{class:"dropdown",children:ht.map(_=>l("button",{class:`dropdown-item${_.key===u?" active":""}`,onClick:()=>{ji(_.key),c(!1)},children:_.label},_.key))})]}),l("div",{class:M.actions,children:g&&l(ue,{children:[l("button",{class:M.iconBtn,title:"Manage Personas",onClick:i,children:"⚙"}),l("button",{class:M.newChatBtn,title:"New Chat",onClick:t,children:"+"})]})})]}),g&&l("div",{class:M.sessionList,children:h.map(_=>{const v=Cr(_,f),m=_.id===d;return l("div",{class:`${M.sessionItem}${m?` ${M.active}`:""}`,onClick:()=>{e(_.id)},children:[l("div",{class:M.avatar,style:{background:(v==null?void 0:v.color)||"#888"},children:v!=null&&v.name?v.name.charAt(0):"P"}),l("div",{class:M.content,children:[l("div",{class:M.title,children:[p[_.id]&&l("span",{class:M.unreadDot}),l("span",{children:_.title||"New Chat"})]}),_.updatedAt&&l("div",{class:M.time,children:Tr(_.updatedAt)})]}),l("button",{class:M.deleteBtn,title:"Delete chat",onClick:k=>{k.stopPropagation(),confirm("Delete this chat?")&&n(_.id)},children:"×"})]},_.id)})})]})}const le=R([]),Be=R(""),ye=R(!1),fe=R(!1),ie=R(!1);function We(t,e){le.value=[...le.value,{role:t,content:e}]}function Re(){le.value=[],Be.value="",ye.value=!1,ie.value=!1}function Rr(t){le.value=t}function Ar(){ye.value=!0,Be.value="",ie.value=!1}function Pr(t){ye.value||Ar(),ie.value=!1,Be.value+=t}function Lr(t){ye.value=!1,Be.value="",fe.value=!1,le.value=[...le.value,{role:"assistant",content:t}]}const pe=R("disconnected"),Te=R("disconnected");let j=null,He=1e3;const bt=R(null),W=R([]),Ye=R(""),Ae=R(!1);function ne(t){j&&j.readyState===WebSocket.OPEN&&j.send(JSON.stringify(t))}function zt(){if(j)return;pe.value="reconnecting",Te.value="connecting...";let e=`${location.protocol==="https:"?"wss:":"ws:"}//${location.host}/ws`;const n=localStorage.getItem("patina-password");n&&(e+=`?password=${encodeURIComponent(n)}`),j=new WebSocket(e),j.onopen=()=>{pe.value="connected",Te.value="connected",He=1e3;const i=Z.value;i&&ne({type:"get_history",chatId:i})},j.onmessage=i=>{let r;try{r=JSON.parse(i.data)}catch{return}Dr(r)},j.onclose=i=>{if(j=null,ie.value=!1,i.code===4001){pe.value="disconnected",Te.value="auth failed",ti();return}pe.value="disconnected",Te.value="disconnected",setTimeout(zt,He),He=Math.min(He*2,3e4)},j.onerror=()=>{}}function Dr(t){var i,r;const e=Z.value,n=bt.value;switch(t.type){case"connected":break;case"history":t.chatId===e&&((i=t.messages)!=null&&i.length)&&(Re(),Rr(t.messages));break;case"text_delta":t.chatId===n&&t.content?(Ae.value=!0,Ye.value+=t.content):t.chatId===e&&t.content&&Pr(t.content);break;case"message":if(t.chatId===n){Ae.value?(Ae.value=!1,W.value=[...W.value,{role:"assistant",content:t.content}],Ye.value=""):W.value=[...W.value,{role:"assistant",content:t.content}];break}fe.value=!1,t.chatId===e?ye.value?Lr(t.content):We("assistant",t.content):t.chatId&&cn(t.chatId),t.chatId&&yt(t.chatId);break;case"user_message":t.chatId===n?W.value=[...W.value,{role:"user",content:t.content}]:t.chatId===e&&We("user",t.content),t.chatId&&(Yn(t.chatId,t.content),yt(t.chatId),t.chatId!==e&&cn(t.chatId));break;case"thinking":t.chatId===n||t.chatId===e&&(ie.value=!0);break;case"session_created":t.chatId&&!ot(t.chatId)&&Qn({id:t.chatId,title:"New Chat",updatedAt:t.timestamp||new Date().toISOString(),persona:t.content||null});break;case"session_deleted":t.chatId&&(Xn(t.chatId),t.chatId===e&&(A.value.length>0?Z.value=A.value[0].id:(Z.value=null,Re())));break;case"task_history":t.chatId===n&&(W.value=t.messages||[]);break;case"error":(r=t.content)!=null&&r.includes("Authentication")&&ti(),We("system",t.content||"Unknown error");break}}function ti(){const t=prompt("Enter password:");t!==null&&(localStorage.setItem("patina-password",t),j&&(j.close(),j=null),zt())}function Ot(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var de=Ot();function ni(t){de=t}var Pe={exec:()=>null};function C(t,e=""){let n=typeof t=="string"?t:t.source;const i={replace:(r,s)=>{let c=typeof s=="string"?s:s.source;return c=c.replace(N.caret,"$1"),n=n.replace(r,c),i},getRegex:()=>new RegExp(n,e)};return i}var N={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},Er=/^(?:[ \t]*(?:\n|$))+/,Mr=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Br=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Ne=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Nr=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Ht=/(?:[*+-]|\d{1,9}[.)])/,ii=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,ri=C(ii).replace(/bull/g,Ht).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),zr=C(ii).replace(/bull/g,Ht).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Ut=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Or=/^[^\n]+/,qt=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Hr=C(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",qt).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Ur=C(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ht).getRegex(),at="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",jt=/\x3C!--(?:-?>|[\s\S]*?(?:-->|$))/,qr=C("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",jt).replace("tag",at).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),si=C(Ut).replace("hr",Ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",at).getRegex(),jr=C(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",si).getRegex(),Ft={blockquote:jr,code:Mr,def:Hr,fences:Br,heading:Nr,hr:Ne,html:qr,lheading:ri,list:Ur,newline:Er,paragraph:si,table:Pe,text:Or},un=C("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",at).getRegex(),Fr={...Ft,lheading:zr,table:un,paragraph:C(Ut).replace("hr",Ne).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",un).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",at).getRegex()},Wr={...Ft,html:C(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",jt).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Pe,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:C(Ut).replace("hr",Ne).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ri).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Zr=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Gr=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,oi=/^( {2,}|\\)\n(?!\s*$)/,Vr=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,lt=/[\p{P}\p{S}]/u,Wt=/[\s\p{P}\p{S}]/u,ai=/[^\s\p{P}\p{S}]/u,Kr=C(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Wt).getRegex(),li=/(?!~)[\p{P}\p{S}]/u,Jr=/(?!~)[\s\p{P}\p{S}]/u,Qr=/(?:[^\s\p{P}\p{S}]|~)/u,Xr=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,ci=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Yr=C(ci,"u").replace(/punct/g,lt).getRegex(),es=C(ci,"u").replace(/punct/g,li).getRegex(),ui="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",ts=C(ui,"gu").replace(/notPunctSpace/g,ai).replace(/punctSpace/g,Wt).replace(/punct/g,lt).getRegex(),ns=C(ui,"gu").replace(/notPunctSpace/g,Qr).replace(/punctSpace/g,Jr).replace(/punct/g,li).getRegex(),is=C("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,ai).replace(/punctSpace/g,Wt).replace(/punct/g,lt).getRegex(),rs=C(/\\(punct)/,"gu").replace(/punct/g,lt).getRegex(),ss=C(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),os=C(jt).replace("(?:-->|$)","-->").getRegex(),as=C("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",os).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),et=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,ls=C(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",et).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),hi=C(/^!?\[(label)\]\[(ref)\]/).replace("label",et).replace("ref",qt).getRegex(),di=C(/^!?\[(ref)\](?:\[\])?/).replace("ref",qt).getRegex(),cs=C("reflink|nolink(?!\\()","g").replace("reflink",hi).replace("nolink",di).getRegex(),Zt={_backpedal:Pe,anyPunctuation:rs,autolink:ss,blockSkip:Xr,br:oi,code:Gr,del:Pe,emStrongLDelim:Yr,emStrongRDelimAst:ts,emStrongRDelimUnd:is,escape:Zr,link:ls,nolink:di,punctuation:Kr,reflink:hi,reflinkSearch:cs,tag:as,text:Vr,url:Pe},us={...Zt,link:C(/^!?\[(label)\]\((.*?)\)/).replace("label",et).getRegex(),reflink:C(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",et).getRegex()},wt={...Zt,emStrongRDelimAst:ns,emStrongLDelim:es,url:C(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},hs={...wt,br:C(oi).replace("{2,}","*").getRegex(),text:C(wt.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Ue={normal:Ft,gfm:Fr,pedantic:Wr},be={normal:Zt,gfm:wt,breaks:hs,pedantic:us},ds={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},hn=t=>ds[t];function G(t,e){if(e){if(N.escapeTest.test(t))return t.replace(N.escapeReplace,hn)}else if(N.escapeTestNoEncode.test(t))return t.replace(N.escapeReplaceNoEncode,hn);return t}function dn(t){try{t=encodeURI(t).replace(N.percentDecode,"%")}catch{return null}return t}function pn(t,e){var s;const n=t.replace(N.findPipe,(c,a,u)=>{let o=!1,h=a;for(;--h>=0&&u[h]==="\\";)o=!o;return o?"|":" |"}),i=n.split(N.splitPipe);let r=0;if(i[0].trim()||i.shift(),i.length>0&&!((s=i.at(-1))!=null&&s.trim())&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(N.slashPipe,"|");return i}function we(t,e,n){const i=t.length;if(i===0)return"";let r=0;for(;r<i&&t.charAt(i-r-1)===e;)r++;return t.slice(0,i-r)}function ps(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let i=0;i<t.length;i++)if(t[i]==="\\")i++;else if(t[i]===e[0])n++;else if(t[i]===e[1]&&(n--,n<0))return i;return n>0?-2:-1}function fn(t,e,n,i,r){const s=e.href,c=e.title||null,a=t[1].replace(r.other.outputLinkReplace,"$1");i.state.inLink=!0;const u={type:t[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:c,text:a,tokens:i.inlineTokens(a)};return i.state.inLink=!1,u}function fs(t,e,n){const i=t.match(n.other.indentCodeCompensation);if(i===null)return e;const r=i[1];return e.split(`
`).map(s=>{const c=s.match(n.other.beginningSpace);if(c===null)return s;const[a]=c;return a.length>=r.length?s.slice(r.length):s}).join(`
`)}var tt=class{constructor(t){I(this,"options");I(this,"rules");I(this,"lexer");this.options=t||de}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:we(n,`
`)}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const n=e[0],i=fs(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:i}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){const i=we(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:we(e[0],`
`)}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){let n=we(e[0],`
`).split(`
`),i="",r="";const s=[];for(;n.length>0;){let c=!1;const a=[];let u;for(u=0;u<n.length;u++)if(this.rules.other.blockquoteStart.test(n[u]))a.push(n[u]),c=!0;else if(!c)a.push(n[u]);else break;n=n.slice(u);const o=a.join(`
`),h=o.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${o}`:o,r=r?`${r}
${h}`:h;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(h,s,!0),this.lexer.state.top=d,n.length===0)break;const p=s.at(-1);if((p==null?void 0:p.type)==="code")break;if((p==null?void 0:p.type)==="blockquote"){const f=p,g=f.raw+`
`+n.join(`
`),_=this.blockquote(g);s[s.length-1]=_,i=i.substring(0,i.length-f.raw.length)+_.raw,r=r.substring(0,r.length-f.text.length)+_.text;break}else if((p==null?void 0:p.type)==="list"){const f=p,g=f.raw+`
`+n.join(`
`),_=this.list(g);s[s.length-1]=_,i=i.substring(0,i.length-p.raw.length)+_.raw,r=r.substring(0,r.length-f.raw.length)+_.raw,n=g.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:s,text:r}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n=e[1].trim();const i=n.length>1,r={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");const s=this.rules.other.listItemRegex(n);let c=!1;for(;t;){let u=!1,o="",h="";if(!(e=s.exec(t))||this.rules.block.hr.test(t))break;o=e[0],t=t.substring(o.length);let d=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,m=>" ".repeat(3*m.length)),p=t.split(`
`,1)[0],f=!d.trim(),g=0;if(this.options.pedantic?(g=2,h=d.trimStart()):f?g=e[1].length+1:(g=e[2].search(this.rules.other.nonSpaceChar),g=g>4?1:g,h=d.slice(g),g+=e[1].length),f&&this.rules.other.blankLine.test(p)&&(o+=p+`
`,t=t.substring(p.length+1),u=!0),!u){const m=this.rules.other.nextBulletRegex(g),k=this.rules.other.hrRegex(g),E=this.rules.other.fencesBeginRegex(g),y=this.rules.other.headingBeginRegex(g),O=this.rules.other.htmlBeginRegex(g);for(;t;){const H=t.split(`
`,1)[0];let U;if(p=H,this.options.pedantic?(p=p.replace(this.rules.other.listReplaceNesting,"  "),U=p):U=p.replace(this.rules.other.tabCharGlobal,"    "),E.test(p)||y.test(p)||O.test(p)||m.test(p)||k.test(p))break;if(U.search(this.rules.other.nonSpaceChar)>=g||!p.trim())h+=`
`+U.slice(g);else{if(f||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||E.test(d)||y.test(d)||k.test(d))break;h+=`
`+p}!f&&!p.trim()&&(f=!0),o+=H+`
`,t=t.substring(H.length+1),d=U.slice(g)}}r.loose||(c?r.loose=!0:this.rules.other.doubleBlankLine.test(o)&&(c=!0));let _=null,v;this.options.gfm&&(_=this.rules.other.listIsTask.exec(h),_&&(v=_[0]!=="[ ] ",h=h.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:o,task:!!_,checked:v,loose:!1,text:h,tokens:[]}),r.raw+=o}const a=r.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let u=0;u<r.items.length;u++)if(this.lexer.state.top=!1,r.items[u].tokens=this.lexer.blockTokens(r.items[u].text,[]),!r.loose){const o=r.items[u].tokens.filter(d=>d.type==="space"),h=o.length>0&&o.some(d=>this.rules.other.anyLine.test(d.raw));r.loose=h}if(r.loose)for(let u=0;u<r.items.length;u++)r.items[u].loose=!0;return r}}html(t){const e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){const e=this.rules.block.def.exec(t);if(e){const n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:i,title:r}}}table(t){var c;const e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const n=pn(e[1]),i=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===i.length){for(const a of i)this.rules.other.tableAlignRight.test(a)?s.align.push("right"):this.rules.other.tableAlignCenter.test(a)?s.align.push("center"):this.rules.other.tableAlignLeft.test(a)?s.align.push("left"):s.align.push(null);for(let a=0;a<n.length;a++)s.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:!0,align:s.align[a]});for(const a of r)s.rows.push(pn(a,s.header.length).map((u,o)=>({text:u,tokens:this.lexer.inline(u),header:!1,align:s.align[o]})));return s}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){const e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const s=we(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{const s=ps(e[2],"()");if(s===-2)return;if(s>-1){const a=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let i=e[2],r="";if(this.options.pedantic){const s=this.rules.other.pedanticHrefTitle.exec(i);s&&(i=s[1],r=s[3])}else r=e[3]?e[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),fn(e,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){const i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[i.toLowerCase()];if(!r){const s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return fn(n,r,n[0],this.lexer,this.rules)}}emStrong(t,e,n=""){let i=this.rules.inline.emStrongLDelim.exec(t);if(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const s=[...i[0]].length-1;let c,a,u=s,o=0;const h=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,e=e.slice(-1*t.length+s);(i=h.exec(e))!=null;){if(c=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!c)continue;if(a=[...c].length,i[3]||i[4]){u+=a;continue}else if((i[5]||i[6])&&s%3&&!((s+a)%3)){o+=a;continue}if(u-=a,u>0)continue;a=Math.min(a,a+u+o);const d=[...i[0]][0].length,p=t.slice(0,s+i.index+d+a);if(Math.min(s,a)%2){const g=p.slice(1,-1);return{type:"em",raw:p,text:g,tokens:this.lexer.inlineTokens(g)}}const f=p.slice(2,-2);return{type:"strong",raw:p,text:f,tokens:this.lexer.inlineTokens(f)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," ");const i=this.rules.other.nonSpaceChar.test(n),r=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&r&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){const e=this.rules.inline.autolink.exec(t);if(e){let n,i;return e[2]==="@"?(n=e[1],i="mailto:"+n):(n=e[1],i=n),{type:"link",raw:e[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(t){var n;let e;if(e=this.rules.inline.url.exec(t)){let i,r;if(e[2]==="@")i=e[0],r="mailto:"+i;else{let s;do s=e[0],e[0]=((n=this.rules.inline._backpedal.exec(e[0]))==null?void 0:n[0])??"";while(s!==e[0]);i=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(t){const e=this.rules.inline.text.exec(t);if(e){const n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},J=class xt{constructor(e){I(this,"tokens");I(this,"options");I(this,"state");I(this,"tokenizer");I(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||de,this.options.tokenizer=this.options.tokenizer||new tt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:N,block:Ue.normal,inline:be.normal};this.options.pedantic?(n.block=Ue.pedantic,n.inline=be.pedantic):this.options.gfm&&(n.block=Ue.gfm,this.options.breaks?n.inline=be.breaks:n.inline=be.gfm),this.tokenizer.rules=n}static get rules(){return{block:Ue,inline:be}}static lex(e,n){return new xt(n).lex(e)}static lexInline(e,n){return new xt(n).inlineTokens(e)}lex(e){e=e.replace(N.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const i=this.inlineQueue[n];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],i=!1){var r,s,c;for(this.options.pedantic&&(e=e.replace(N.tabCharGlobal,"    ").replace(N.spaceLine,""));e;){let a;if((s=(r=this.options.extensions)==null?void 0:r.block)!=null&&s.some(o=>(a=o.call({lexer:this},e,n))?(e=e.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);const o=n.at(-1);a.raw.length===1&&o!==void 0?o.raw+=`
`:n.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);const o=n.at(-1);(o==null?void 0:o.type)==="paragraph"||(o==null?void 0:o.type)==="text"?(o.raw+=`
`+a.raw,o.text+=`
`+a.text,this.inlineQueue.at(-1).src=o.text):n.push(a);continue}if(a=this.tokenizer.fences(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.heading(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.hr(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.blockquote(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.list(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.html(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);const o=n.at(-1);(o==null?void 0:o.type)==="paragraph"||(o==null?void 0:o.type)==="text"?(o.raw+=`
`+a.raw,o.text+=`
`+a.raw,this.inlineQueue.at(-1).src=o.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.lheading(e)){e=e.substring(a.raw.length),n.push(a);continue}let u=e;if((c=this.options.extensions)!=null&&c.startBlock){let o=1/0;const h=e.slice(1);let d;this.options.extensions.startBlock.forEach(p=>{d=p.call({lexer:this},h),typeof d=="number"&&d>=0&&(o=Math.min(o,d))}),o<1/0&&o>=0&&(u=e.substring(0,o+1))}if(this.state.top&&(a=this.tokenizer.paragraph(u))){const o=n.at(-1);i&&(o==null?void 0:o.type)==="paragraph"?(o.raw+=`
`+a.raw,o.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):n.push(a),i=u.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);const o=n.at(-1);(o==null?void 0:o.type)==="text"?(o.raw+=`
`+a.raw,o.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):n.push(a);continue}if(e){const o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var a,u,o;let i=e,r=null;if(this.tokens.links){const h=Object.keys(this.tokens.links);if(h.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)h.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,r.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(r=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,c="";for(;e;){s||(c=""),s=!1;let h;if((u=(a=this.options.extensions)==null?void 0:a.inline)!=null&&u.some(p=>(h=p.call({lexer:this},e,n))?(e=e.substring(h.raw.length),n.push(h),!0):!1))continue;if(h=this.tokenizer.escape(e)){e=e.substring(h.raw.length),n.push(h);continue}if(h=this.tokenizer.tag(e)){e=e.substring(h.raw.length),n.push(h);continue}if(h=this.tokenizer.link(e)){e=e.substring(h.raw.length),n.push(h);continue}if(h=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(h.raw.length);const p=n.at(-1);h.type==="text"&&(p==null?void 0:p.type)==="text"?(p.raw+=h.raw,p.text+=h.text):n.push(h);continue}if(h=this.tokenizer.emStrong(e,i,c)){e=e.substring(h.raw.length),n.push(h);continue}if(h=this.tokenizer.codespan(e)){e=e.substring(h.raw.length),n.push(h);continue}if(h=this.tokenizer.br(e)){e=e.substring(h.raw.length),n.push(h);continue}if(h=this.tokenizer.del(e)){e=e.substring(h.raw.length),n.push(h);continue}if(h=this.tokenizer.autolink(e)){e=e.substring(h.raw.length),n.push(h);continue}if(!this.state.inLink&&(h=this.tokenizer.url(e))){e=e.substring(h.raw.length),n.push(h);continue}let d=e;if((o=this.options.extensions)!=null&&o.startInline){let p=1/0;const f=e.slice(1);let g;this.options.extensions.startInline.forEach(_=>{g=_.call({lexer:this},f),typeof g=="number"&&g>=0&&(p=Math.min(p,g))}),p<1/0&&p>=0&&(d=e.substring(0,p+1))}if(h=this.tokenizer.inlineText(d)){e=e.substring(h.raw.length),h.raw.slice(-1)!=="_"&&(c=h.raw.slice(-1)),s=!0;const p=n.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=h.raw,p.text+=h.text):n.push(h);continue}if(e){const p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return n}},Ee=class{constructor(t){I(this,"options");I(this,"parser");this.options=t||de}space(t){return""}code({text:t,lang:e,escaped:n}){var s;const i=(s=(e||"").match(N.notSpaceStart))==null?void 0:s[0],r=t.replace(N.endingNewline,"")+`
`;return i?'<pre><code class="language-'+G(i)+'">'+(n?r:G(r,!0))+`</code></pre>
`:"<pre><code>"+(n?r:G(r,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){const e=t.ordered,n=t.start;let i="";for(let c=0;c<t.items.length;c++){const a=t.items[c];i+=this.listitem(a)}const r=e?"ol":"ul",s=e&&n!==1?' start="'+n+'"':"";return"<"+r+s+`>
`+i+"</"+r+`>
`}listitem(t){var n;let e="";if(t.task){const i=this.checkbox({checked:!!t.checked});t.loose?((n=t.tokens[0])==null?void 0:n.type)==="paragraph"?(t.tokens[0].text=i+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=i+" "+G(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):e+=i+" "}return e+=this.parser.parse(t.tokens,!!t.loose),`<li>${e}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",n="";for(let r=0;r<t.header.length;r++)n+=this.tablecell(t.header[r]);e+=this.tablerow({text:n});let i="";for(let r=0;r<t.rows.length;r++){const s=t.rows[r];n="";for(let c=0;c<s.length;c++)n+=this.tablecell(s[c]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+i+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){const e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${G(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:n}){const i=this.parser.parseInline(n),r=dn(t);if(r===null)return i;t=r;let s='<a href="'+t+'"';return e&&(s+=' title="'+G(e)+'"'),s+=">"+i+"</a>",s}image({href:t,title:e,text:n,tokens:i}){i&&(n=this.parser.parseInline(i,this.parser.textRenderer));const r=dn(t);if(r===null)return G(n);t=r;let s=`<img src="${t}" alt="${n}"`;return e&&(s+=` title="${G(e)}"`),s+=">",s}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:G(t.text)}},Gt=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}},Q=class St{constructor(e){I(this,"options");I(this,"renderer");I(this,"textRenderer");this.options=e||de,this.options.renderer=this.options.renderer||new Ee,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Gt}static parse(e,n){return new St(n).parse(e)}static parseInline(e,n){return new St(n).parseInline(e)}parse(e,n=!0){var r,s;let i="";for(let c=0;c<e.length;c++){const a=e[c];if((s=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&s[a.type]){const o=a,h=this.options.extensions.renderers[o.type].call({parser:this},o);if(h!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){i+=h||"";continue}}const u=a;switch(u.type){case"space":{i+=this.renderer.space(u);continue}case"hr":{i+=this.renderer.hr(u);continue}case"heading":{i+=this.renderer.heading(u);continue}case"code":{i+=this.renderer.code(u);continue}case"table":{i+=this.renderer.table(u);continue}case"blockquote":{i+=this.renderer.blockquote(u);continue}case"list":{i+=this.renderer.list(u);continue}case"html":{i+=this.renderer.html(u);continue}case"paragraph":{i+=this.renderer.paragraph(u);continue}case"text":{let o=u,h=this.renderer.text(o);for(;c+1<e.length&&e[c+1].type==="text";)o=e[++c],h+=`
`+this.renderer.text(o);n?i+=this.renderer.paragraph({type:"paragraph",raw:h,text:h,tokens:[{type:"text",raw:h,text:h,escaped:!0}]}):i+=h;continue}default:{const o='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}parseInline(e,n=this.renderer){var r,s;let i="";for(let c=0;c<e.length;c++){const a=e[c];if((s=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&s[a.type]){const o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){i+=o||"";continue}}const u=a;switch(u.type){case"escape":{i+=n.text(u);break}case"html":{i+=n.html(u);break}case"link":{i+=n.link(u);break}case"image":{i+=n.image(u);break}case"strong":{i+=n.strong(u);break}case"em":{i+=n.em(u);break}case"codespan":{i+=n.codespan(u);break}case"br":{i+=n.br(u);break}case"del":{i+=n.del(u);break}case"text":{i+=n.text(u);break}default:{const o='Token with "'+u.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}},ft,Ze=(ft=class{constructor(t){I(this,"options");I(this,"block");this.options=t||de}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?J.lex:J.lexInline}provideParser(){return this.block?Q.parse:Q.parseInline}},I(ft,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),ft),_s=class{constructor(...t){I(this,"defaults",Ot());I(this,"options",this.setOptions);I(this,"parse",this.parseMarkdown(!0));I(this,"parseInline",this.parseMarkdown(!1));I(this,"Parser",Q);I(this,"Renderer",Ee);I(this,"TextRenderer",Gt);I(this,"Lexer",J);I(this,"Tokenizer",tt);I(this,"Hooks",Ze);this.use(...t)}walkTokens(t,e){var i,r;let n=[];for(const s of t)switch(n=n.concat(e.call(this,s)),s.type){case"table":{const c=s;for(const a of c.header)n=n.concat(this.walkTokens(a.tokens,e));for(const a of c.rows)for(const u of a)n=n.concat(this.walkTokens(u.tokens,e));break}case"list":{const c=s;n=n.concat(this.walkTokens(c.items,e));break}default:{const c=s;(r=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&r[c.type]?this.defaults.extensions.childTokens[c.type].forEach(a=>{const u=c[a].flat(1/0);n=n.concat(this.walkTokens(u,e))}):c.tokens&&(n=n.concat(this.walkTokens(c.tokens,e)))}}return n}use(...t){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{const i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const s=e.renderers[r.name];s?e.renderers[r.name]=function(...c){let a=r.renderer.apply(this,c);return a===!1&&(a=s.apply(this,c)),a}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=e[r.level];s?s.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),i.extensions=e),n.renderer){const r=this.defaults.renderer||new Ee(this.defaults);for(const s in n.renderer){if(!(s in r))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const c=s,a=n.renderer[c],u=r[c];r[c]=(...o)=>{let h=a.apply(r,o);return h===!1&&(h=u.apply(r,o)),h||""}}i.renderer=r}if(n.tokenizer){const r=this.defaults.tokenizer||new tt(this.defaults);for(const s in n.tokenizer){if(!(s in r))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const c=s,a=n.tokenizer[c],u=r[c];r[c]=(...o)=>{let h=a.apply(r,o);return h===!1&&(h=u.apply(r,o)),h}}i.tokenizer=r}if(n.hooks){const r=this.defaults.hooks||new Ze;for(const s in n.hooks){if(!(s in r))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const c=s,a=n.hooks[c],u=r[c];Ze.passThroughHooks.has(s)?r[c]=o=>{if(this.defaults.async)return Promise.resolve(a.call(r,o)).then(d=>u.call(r,d));const h=a.call(r,o);return u.call(r,h)}:r[c]=(...o)=>{let h=a.apply(r,o);return h===!1&&(h=u.apply(r,o)),h}}i.hooks=r}if(n.walkTokens){const r=this.defaults.walkTokens,s=n.walkTokens;i.walkTokens=function(c){let a=[];return a.push(s.call(this,c)),r&&(a=a.concat(r.call(this,c))),a}}this.defaults={...this.defaults,...i}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return J.lex(t,e??this.defaults)}parser(t,e){return Q.parse(t,e??this.defaults)}parseMarkdown(t){return(n,i)=>{const r={...i},s={...this.defaults,...r},c=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&r.async===!1)return c(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return c(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return c(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=t);const a=s.hooks?s.hooks.provideLexer():t?J.lex:J.lexInline,u=s.hooks?s.hooks.provideParser():t?Q.parse:Q.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(n):n).then(o=>a(o,s)).then(o=>s.hooks?s.hooks.processAllTokens(o):o).then(o=>s.walkTokens?Promise.all(this.walkTokens(o,s.walkTokens)).then(()=>o):o).then(o=>u(o,s)).then(o=>s.hooks?s.hooks.postprocess(o):o).catch(c);try{s.hooks&&(n=s.hooks.preprocess(n));let o=a(n,s);s.hooks&&(o=s.hooks.processAllTokens(o)),s.walkTokens&&this.walkTokens(o,s.walkTokens);let h=u(o,s);return s.hooks&&(h=s.hooks.postprocess(h)),h}catch(o){return c(o)}}}onError(t,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const i="<p>An error occurred:</p><pre>"+G(n.message+"",!0)+"</pre>";return e?Promise.resolve(i):i}if(e)return Promise.reject(n);throw n}}},ce=new _s;function $(t,e){return ce.parse(t,e)}$.options=$.setOptions=function(t){return ce.setOptions(t),$.defaults=ce.defaults,ni($.defaults),$};$.getDefaults=Ot;$.defaults=de;$.use=function(...t){return ce.use(...t),$.defaults=ce.defaults,ni($.defaults),$};$.walkTokens=function(t,e){return ce.walkTokens(t,e)};$.parseInline=ce.parseInline;$.Parser=Q;$.parser=Q.parse;$.Renderer=Ee;$.TextRenderer=Gt;$.Lexer=J;$.lexer=J.lex;$.Tokenizer=tt;$.Hooks=Ze;$.parse=$;$.options;$.setOptions;$.use;$.walkTokens;$.parseInline;Q.parse;J.lex;const nt=new Ee,gs=nt.link.bind(nt);nt.link=function(t){return gs(t).replace("<a ",'<a target="_blank" rel="noopener" ')};$.setOptions({renderer:nt,gfm:!0,breaks:!0});function Le(t){return $.parse(t,{async:!1})}function vs({message:t}){return t.role==="user"||t.role==="system"?l("div",{class:`message ${t.role}`,children:t.content}):l("div",{class:"message assistant",dangerouslySetInnerHTML:{__html:Le(t.content)}})}function ms(){return l("div",{class:"thinking",children:[l("span",{}),l("span",{}),l("span",{})]})}function ks({onScroll:t}){const e=oe(null),n=le.value,i=Be.value,r=ye.value,s=ie.value;return X(()=>{const c=e.current;c&&(c.scrollTop=c.scrollHeight)},[n,i,s]),l("div",{ref:e,"data-messages":!0,style:ys,onScroll:t,children:[n.map((c,a)=>l(vs,{message:c},a)),r&&i&&l("div",{class:"message assistant",dangerouslySetInnerHTML:{__html:Le(i)}}),s&&l(ms,{})]})}const ys={flex:"1",overflowY:"auto",padding:"16px",display:"flex",flexDirection:"column",gap:"12px"},bs="_form_572ba_1",ws="_input_572ba_10",xs="_sendBtn_572ba_28",dt={form:bs,input:ws,sendBtn:xs};function Ss({onSend:t,onCancel:e}){const n=oe(null),i=fe.value,r=pe.value==="connected";function s(u){if(u.preventDefault(),i){e();return}const o=n.current;if(!o)return;const h=o.value.trim();h&&(t(h),o.value="",o.style.height="auto")}function c(){const u=n.current;u&&(u.style.height="auto",u.style.height=Math.min(u.scrollHeight,120)+"px")}function a(u){u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),s(u))}return l("form",{class:dt.form,onSubmit:s,children:[l("textarea",{ref:n,class:dt.input,placeholder:"Type a message...",rows:1,autoComplete:"off",disabled:i,onInput:c,onKeyDown:a}),l("button",{type:"submit",class:dt.sendBtn,disabled:!i&&!r,children:i?"Stop":"Send"})]})}const $s="_chatArea_1n9gw_1",Ts="_header_1n9gw_10",Cs="_sidebarToggle_1n9gw_25",Is="_chatId_1n9gw_35",Rs="_scrollBtn_1n9gw_49",xe={chatArea:$s,header:Ts,sidebarToggle:Cs,chatId:Is,scrollBtn:Rs};function As({sidebarHidden:t,onToggleSidebar:e}){var p;const n=Z.value,i=pe.value,r=Te.value,s=n?ir(n):null,c=s?ar(s):null;function a(){n&&ne({type:"cancel",chatId:n}),fe.value=!1,ie.value=!1}X(()=>{function f(g){g.key==="Escape"&&fe.value&&(g.preventDefault(),a())}return document.addEventListener("keydown",f),()=>document.removeEventListener("keydown",f)},[n]);function u(f){if(!n)return;We("user",f),ie.value=!0,Yn(n,f),yt(n);const g={type:"message",content:f,chatId:n};s&&(g.persona=s),ne(g),fe.value=!0}function o(){if(!n)return;const f="web:"+n;navigator.clipboard.writeText(f).catch(()=>{const g=document.createElement("textarea");g.value=f,g.style.position="fixed",g.style.opacity="0",document.body.appendChild(g),g.select(),document.execCommand("copy"),document.body.removeChild(g)})}function h(f){const g=f.target,_=g.scrollHeight-g.scrollTop-g.clientHeight<100,v=document.getElementById("scroll-bottom-btn");v&&v.classList.toggle("hidden",_)}function d(){const f=document.querySelector("[data-messages]");f&&(f.scrollTop=f.scrollHeight)}return l("div",{class:xe.chatArea,children:[l("header",{class:xe.header,children:[t&&l("button",{class:xe.sidebarToggle,title:"Toggle sidebar",onClick:e,style:{display:"block"},children:"☰"}),l("h1",{children:["Patina",c&&l("span",{class:"persona-badge",children:[l("span",{class:"header-avatar",style:{background:c.color||"#888"},children:((p=c.name)==null?void 0:p.charAt(0))||"P"}),l("span",{children:c.name||c.key})]})]}),l("span",{class:`status ${i}`,children:r}),n&&l("span",{class:xe.chatId,title:"Click to copy session key",onClick:o,children:n.slice(0,8)})]}),l(ks,{onScroll:h}),l("button",{id:"scroll-bottom-btn",class:`${xe.scrollBtn} hidden`,title:"Scroll to bottom",onClick:d,children:"↓"}),l(Ss,{onSend:u,onCancel:a})]})}const pi=R([]),fi=R([]),_i=R({models:[],providers:[],agents:[]}),$t=R("-"),Tt=R("-"),Ct=R("-"),It=R("-");function gi(t){return t==null?"0":t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":String(t)}function vi(t){return t==null?"—":t<.01?"<$0.01":"$"+t.toFixed(2)}function qe(t){let e=0,n=0,i=!1;for(const s of t)e+=s.total_tokens||0,s.estimated_cost!=null&&(n+=s.estimated_cost,i=!0);let r=gi(e);return i&&n>0&&(r+=" ("+vi(n)+")"),r}async function Ps(){try{_i.value=await Xi()}catch{}}async function Ls(t){try{const n=await Qi(t);Array.isArray(n)&&(pi.value=n)}catch{}const e={...t};delete e.groupBy;try{const n=await $e(e);Array.isArray(n)&&(fi.value=n)}catch{}await Ds()}async function Ds(){const t=new Date,e=t.toISOString().slice(0,10),n=e+"T00:00:00Z",i=e+"T23:59:59Z";try{const o=await $e({from:n,to:i});$t.value=qe(o)}catch{$t.value="-"}const r=t.getDay(),s=r===0?6:r-1,c=new Date(t);c.setDate(t.getDate()-s);const a=c.toISOString().slice(0,10)+"T00:00:00Z";try{const o=await $e({from:a,to:i});Tt.value=qe(o)}catch{Tt.value="-"}const u=e.slice(0,7)+"-01T00:00:00Z";try{const o=await $e({from:u,to:i});Ct.value=qe(o)}catch{Ct.value="-"}try{const o=await $e({});It.value=qe(o)}catch{It.value="-"}}const Es="_view_1v8xi_1",Ms="_header_1v8xi_9",Bs="_content_1v8xi_34",Ns="_filters_1v8xi_50",zs="_summaryCards_1v8xi_83",Os="_card_1v8xi_90",Hs="_cardLabel_1v8xi_98",Us="_cardValue_1v8xi_104",qs="_tableWrap_1v8xi_110",js="_table_1v8xi_110",Fs="_sortAsc_1v8xi_152",Ws="_sortDesc_1v8xi_157",Zs="_noData_1v8xi_162",P={view:Es,header:Ms,content:Bs,filters:Ns,summaryCards:zs,card:Os,cardLabel:Hs,cardValue:Us,tableWrap:qs,table:js,sortAsc:Fs,sortDesc:Ws,noData:Zs},Gs=[{key:"first",label:"Group"},{key:"calls",label:"Calls"},{key:"input_tokens",label:"Input"},{key:"output_tokens",label:"Output"},{key:"total_tokens",label:"Total"},{key:"cached_input_tokens",label:"Cached"},{key:"estimated_cost",label:"Cost"}];function _n(t){const e=t.trim();return e.endsWith("M")?parseFloat(e)*1e6:e.endsWith("K")?parseFloat(e)*1e3:parseFloat(e)||0}function pt(t,e,n){if(e==="first")return String(t[n]||"-");if(e==="estimated_cost")return vi(t.estimated_cost);const i=t[e];return gi(i)}function gn({rows:t,firstCol:e}){const[n,i]=w("total_tokens"),[r,s]=w(!1),c=Gs.map(o=>o.key==="first"?{...o,label:e==="date"?"Date":"Group"}:o);function a(o){o===n?s(!r):(i(o),s(!1))}const u=[...t].sort((o,h)=>{const d=pt(o,n,e),p=pt(h,n,e),f=_n(d),g=_n(p);return!isNaN(f)&&!isNaN(g)?r?f-g:g-f:r?d.localeCompare(p):p.localeCompare(d)});return t.length?l("div",{class:P.tableWrap,children:l("table",{class:P.table,children:[l("thead",{children:l("tr",{children:c.map(o=>l("th",{class:n===o.key?r?P.sortAsc:P.sortDesc:"",onClick:()=>a(o.key),children:o.label},o.key))})}),l("tbody",{children:u.map((o,h)=>l("tr",{children:c.map(d=>l("td",{children:pt(o,d.key,e)},d.key))},h))})]})}):l("div",{class:P.noData,children:"No data"})}function Vs(){const[t,e]=w(""),[n,i]=w(""),[r,s]=w(""),[c,a]=w(""),[u,o]=w(""),[h,d]=w("model"),p=_i.value;X(()=>{Ps(),g()},[]);function f(){const _={};return t&&(_.from=t+"T00:00:00Z"),n&&(_.to=n+"T23:59:59Z"),r&&(_.model=r),c&&(_.provider=c),u&&(_.agent=u),h&&(_.groupBy=h),_}function g(){Ls(f())}return l("div",{class:P.view,children:[l("header",{class:P.header,children:l("h1",{children:"Usage"})}),l("div",{class:P.content,children:[l("div",{class:P.filters,children:[l("label",{children:["From",l("input",{type:"date",value:t,onInput:_=>e(_.target.value)})]}),l("label",{children:["To",l("input",{type:"date",value:n,onInput:_=>i(_.target.value)})]}),l("label",{children:["Model",l("select",{value:r,onChange:_=>s(_.target.value),children:[l("option",{value:"",children:"All"}),p.models.map(_=>l("option",{value:_,children:_},_))]})]}),l("label",{children:["Provider",l("select",{value:c,onChange:_=>a(_.target.value),children:[l("option",{value:"",children:"All"}),p.providers.map(_=>l("option",{value:_,children:_},_))]})]}),l("label",{children:["Agent",l("select",{value:u,onChange:_=>o(_.target.value),children:[l("option",{value:"",children:"All"}),p.agents.map(_=>l("option",{value:_,children:_},_))]})]}),l("label",{children:["Group by",l("select",{value:h,onChange:_=>d(_.target.value),children:[l("option",{value:"model",children:"Model"}),l("option",{value:"provider",children:"Provider"}),l("option",{value:"agent",children:"Agent"}),l("option",{value:"session",children:"Session"}),l("option",{value:"call_type",children:"Call Type"})]})]}),l("button",{class:"btn-primary",style:{alignSelf:"flex-end",padding:"6px 16px",fontSize:"13px"},onClick:g,children:"Refresh"})]}),l("div",{class:P.summaryCards,children:[l("div",{class:P.card,children:[l("div",{class:P.cardLabel,children:"Today"}),l("div",{class:P.cardValue,children:$t.value})]}),l("div",{class:P.card,children:[l("div",{class:P.cardLabel,children:"This Week"}),l("div",{class:P.cardValue,children:Tt.value})]}),l("div",{class:P.card,children:[l("div",{class:P.cardLabel,children:"This Month"}),l("div",{class:P.cardValue,children:Ct.value})]}),l("div",{class:P.card,children:[l("div",{class:P.cardLabel,children:"All Time"}),l("div",{class:P.cardValue,children:It.value})]})]}),l("h3",{children:"Summary"}),l(gn,{rows:pi.value,firstCol:"group_key"}),l("h3",{children:"Daily Breakdown"}),l(gn,{rows:fi.value,firstCol:"date"})]})]})}const mi=R([]);async function ge(){try{mi.value=await Yi()}catch(t){console.error("Failed to load tasks:",t)}}function ct({visible:t,onClose:e,wide:n,children:i}){return t?l("div",{class:"modal",onClick:r=>{r.target===r.currentTarget&&e()},children:l("div",{class:`modal-content${n?" modal-wide":""}`,children:i})}):null}const Ks="_view_7t6ed_1",Js="_header_7t6ed_9",Qs="_board_7t6ed_24",Xs="_column_7t6ed_33",Ys="_columnHeader_7t6ed_45",eo="_columnTitle_7t6ed_54",to="_columnCount_7t6ed_62",no="_cards_7t6ed_71",io="_dragOver_7t6ed_81",ro="_card_7t6ed_71",so="_dragging_7t6ed_101",oo="_cardTitle_7t6ed_105",ao="_priorityDot_7t6ed_114",lo="_priorityLow_7t6ed_121",co="_priorityMedium_7t6ed_122",uo="_priorityHigh_7t6ed_123",ho="_priorityUrgent_7t6ed_124",po="_cardMeta_7t6ed_126",fo="_cardAssignee_7t6ed_133",_o="_cardTag_7t6ed_147",go="_detailContent_7t6ed_157",vo="_detailHeader_7t6ed_167",mo="_detailTitleInput_7t6ed_175",ko="_detailId_7t6ed_190",yo="_detailBody_7t6ed_204",bo="_detailLeft_7t6ed_210",wo="_detailRight_7t6ed_219",xo="_detailMeta_7t6ed_228",So="_sectionLabel_7t6ed_262",$o="_description_7t6ed_270",To="_descriptionPlaceholder_7t6ed_285",Co="_descriptionEdit_7t6ed_291",Io="_taskMessages_7t6ed_307",Ro="_taskMessagesEmpty_7t6ed_321",Ao="_taskInputForm_7t6ed_328",Po="_editorForm_7t6ed_369",b={view:Ks,header:Js,board:Qs,column:Xs,columnHeader:Ys,columnTitle:eo,columnCount:to,cards:no,dragOver:io,card:ro,dragging:so,cardTitle:oo,priorityDot:ao,priorityLow:lo,priorityMedium:co,priorityHigh:uo,priorityUrgent:ho,cardMeta:po,cardAssignee:fo,cardTag:_o,detailContent:go,detailHeader:vo,detailTitleInput:mo,detailId:ko,detailBody:yo,detailLeft:bo,detailRight:wo,detailMeta:xo,sectionLabel:So,description:$o,descriptionPlaceholder:To,descriptionEdit:Co,taskMessages:Io,taskMessagesEmpty:Ro,taskInputForm:Ao,editorForm:Po};function Lo({visible:t,task:e,onClose:n}){const[i,r]=w(""),[s,c]=w(""),[a,u]=w("medium"),[o,h]=w(""),[d,p]=w(""),f=Y.value;X(()=>{t&&(e?(r(e.title),c(e.description||""),u(e.priority||"medium"),h(e.assignee||""),p((e.tags||[]).join(", "))):(r(""),c(""),u("medium"),h(""),p("")))},[t,e]);async function g(v){v.preventDefault();const m=d.split(",").map(k=>k.trim()).filter(k=>k.length>0);try{if(e){await Zn(e.id,{title:i,description:s,priority:a,tags:m});const k=o||null,E=e.assignee||null;k!==E&&await Kn(e.id,k)}else await er({title:i,description:s,priority:a,assignee:o||null,tags:m});await ge(),n()}catch(k){console.error("Task save failed:",k)}}async function _(){!e||!confirm("Delete this task?")||(await Gn(e.id),await ge(),n())}return l(ct,{visible:t,onClose:n,wide:!0,children:[l("h3",{children:e?"Edit Task":"New Task"}),l("form",{class:b.editorForm,onSubmit:g,children:[l("label",{children:["Title",l("input",{type:"text",required:!0,placeholder:"Task title",value:i,onInput:v=>r(v.target.value)})]}),l("label",{children:["Description",l("textarea",{rows:3,placeholder:"Markdown description...",value:s,onInput:v=>c(v.target.value)})]}),l("label",{children:["Priority",l("select",{value:a,onChange:v=>u(v.target.value),children:[l("option",{value:"low",children:"Low"}),l("option",{value:"medium",children:"Medium"}),l("option",{value:"high",children:"High"}),l("option",{value:"urgent",children:"Urgent"})]})]}),l("label",{children:["Assignee",l("select",{value:o,onChange:v=>h(v.target.value),children:[l("option",{value:"",children:"Unassigned"}),f.map(v=>l("option",{value:v.key,children:v.name},v.key))]})]}),l("label",{children:["Tags (comma-separated)",l("input",{type:"text",placeholder:"e.g. bug, frontend",value:d,onInput:v=>p(v.target.value)})]}),l("div",{class:"modal-actions",children:[e&&l("button",{type:"button",class:"btn-danger",style:{marginRight:"auto"},onClick:_,children:"Delete"}),l("button",{type:"button",class:"btn-secondary",style:{width:"auto"},onClick:n,children:"Cancel"}),l("button",{type:"submit",class:"btn-primary",children:"Save"})]})]})]})}function Do({task:t,onClose:e}){const[n,i]=w(t.title),[r,s]=w(t.status),[c,a]=w(t.priority),[u,o]=w(t.assignee||""),[h,d]=w((t.tags||[]).join(", ")),[p,f]=w(t.description||""),[g,_]=w(!1),v=oe(null),m=oe(null),k=Y.value,E=W.value,y=Ye.value,O=Ae.value,H=oe(t.status),U=oe(t.assignee||"");X(()=>(bt.value=t.id,W.value=[],Ye.value="",Ae.value=!1,ne({type:"get_task_history",chatId:t.id}),()=>{bt.value=null}),[t.id]),X(()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)},[E,y]);async function F(){const x=h.split(",").map(V=>V.trim()).filter(V=>V.length>0),z=[];z.push(Zn(t.id,{title:n,description:p,priority:c,tags:x})),r!==H.current&&z.push(Vn(t.id,r).then(()=>{H.current=r})),u!==U.current&&z.push(Kn(t.id,u||null).then(()=>{U.current=u})),await Promise.all(z).catch(V=>console.error("Save failed:",V))}function q(){F().then(()=>{ge(),e()})}async function ee(){confirm("Delete this task?")&&(await Gn(t.id),await ge(),e())}function Vt(x){x.preventDefault();const z=m.current;if(!z)return;const V=z.value.trim();V&&(W.value=[...W.value,{role:"user",content:V}],z.value="",ne({type:"task_message",chatId:t.id,content:V}))}function ki(){const x="task:"+t.id;navigator.clipboard.writeText(x).catch(()=>{})}return l("div",{class:"modal",onClick:x=>{x.target===x.currentTarget&&q()},children:l("div",{class:`modal-content ${b.detailContent}`,children:[l("div",{class:b.detailHeader,children:[l("input",{type:"text",class:b.detailTitleInput,placeholder:"Task title",value:n,onInput:x=>i(x.target.value),onChange:()=>F()}),l("span",{class:b.detailId,onClick:ki,children:["#",t.id]}),l("button",{class:"btn-danger btn-sm",title:"Delete task",onClick:ee,children:"Delete"}),l("button",{class:"btn-text",title:"Close",onClick:q,children:"×"})]}),l("div",{class:b.detailBody,children:[l("div",{class:b.detailLeft,children:[l("div",{class:b.detailMeta,children:[l("label",{children:["Status",l("select",{value:r,onChange:x=>{s(x.target.value),F()},children:[l("option",{value:"backlog",children:"Backlog"}),l("option",{value:"todo",children:"Todo"}),l("option",{value:"in_progress",children:"In Progress"}),l("option",{value:"done",children:"Done"})]})]}),l("label",{children:["Priority",l("select",{value:c,onChange:x=>{a(x.target.value),F()},children:[l("option",{value:"low",children:"Low"}),l("option",{value:"medium",children:"Medium"}),l("option",{value:"high",children:"High"}),l("option",{value:"urgent",children:"Urgent"})]})]}),l("label",{children:["Assignee",l("select",{value:u,onChange:x=>{o(x.target.value),F()},children:[l("option",{value:"",children:"Unassigned"}),k.map(x=>l("option",{value:x.key,children:x.name},x.key))]})]}),l("label",{children:["Tags",l("input",{type:"text",placeholder:"comma-separated",value:h,onInput:x=>d(x.target.value),onChange:()=>F()})]})]}),l("div",{class:b.sectionLabel,children:"Description"}),g?l("textarea",{class:b.descriptionEdit,placeholder:"Description (markdown supported)...",value:p,onInput:x=>f(x.target.value),onBlur:()=>{_(!1),F()},autoFocus:!0}):l("div",{class:b.description,onClick:()=>_(!0),dangerouslySetInnerHTML:{__html:p?Le(p):'<span class="'+b.descriptionPlaceholder+'">Click to add a description...</span>'}})]}),l("div",{class:b.detailRight,children:[l("div",{class:b.taskMessages,ref:v,children:[E.length===0&&!O&&l("div",{class:b.taskMessagesEmpty,children:"No messages yet. Start a conversation about this task."}),E.map((x,z)=>l("div",{class:`message ${x.role}`,children:x.role==="assistant"?l("span",{dangerouslySetInnerHTML:{__html:Le(x.content)}}):x.content},z)),O&&y&&l("div",{class:"message assistant",dangerouslySetInnerHTML:{__html:Le(y)}})]}),l("form",{class:b.taskInputForm,onSubmit:Vt,children:[l("textarea",{ref:m,placeholder:"Discuss this task...",rows:1,onKeyDown:x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),Vt(x))},onInput:x=>{const z=x.target;z.style.height="auto",z.style.height=Math.min(z.scrollHeight,120)+"px"}}),l("button",{type:"submit",children:"Send"})]})]})]})]})})}const Eo=[{key:"backlog",label:"Backlog"},{key:"todo",label:"Todo"},{key:"in_progress",label:"In Progress"},{key:"done",label:"Done"}],vn={urgent:0,high:1,medium:2,low:3};function Mo(t){switch(t){case"low":return b.priorityLow;case"medium":return b.priorityMedium;case"high":return b.priorityHigh;case"urgent":return b.priorityUrgent;default:return b.priorityMedium}}function Bo(){const[t,e]=w(!1),[n,i]=w(null),[r,s]=w(null),[c,a]=w(null),u=mi.value,o=Y.value;X(()=>{ge()},[]);const h={backlog:[],todo:[],in_progress:[],done:[]};for(const f of u)h[f.status]&&h[f.status].push(f);for(const f of Object.values(h))f.sort((g,_)=>(vn[g.priority]??3)-(vn[_.priority]??3));function d(f,g){var v;f.preventDefault(),a(null);const _=(v=f.dataTransfer)==null?void 0:v.getData("text/plain");!_||!g||Vn(_,g).then(()=>ge())}function p(f){const g=o.find(_=>_.key===f);return(g==null?void 0:g.color)||"var(--accent)"}return l("div",{class:b.view,children:[l("header",{class:b.header,children:[l("h1",{children:"Tasks"}),l("button",{class:"btn-primary",onClick:()=>{i(null),e(!0)},children:"+ New Task"})]}),l("div",{class:b.board,children:Eo.map(({key:f,label:g})=>l("div",{class:b.column,children:[l("div",{class:b.columnHeader,children:[l("span",{class:b.columnTitle,children:g}),l("span",{class:b.columnCount,children:h[f].length})]}),l("div",{class:`${b.cards}${c===f?` ${b.dragOver}`:""}`,onDragOver:_=>{_.preventDefault(),a(f)},onDragLeave:()=>a(null),onDrop:_=>d(_,f),children:h[f].map(_=>{var v;return l("div",{class:b.card,draggable:!0,onDragStart:m=>{var k;(k=m.dataTransfer)==null||k.setData("text/plain",_.id),m.target.classList.add(b.dragging)},onDragEnd:m=>{m.target.classList.remove(b.dragging)},onClick:()=>s(_),children:[l("div",{class:b.cardTitle,children:[l("span",{class:`${b.priorityDot} ${Mo(_.priority)}`}),_.title]}),(_.assignee||_.tags&&_.tags.length>0)&&l("div",{class:b.cardMeta,children:[_.assignee&&l("span",{class:b.cardAssignee,style:{background:p(_.assignee)},title:_.assignee,children:_.assignee.charAt(0)}),(v=_.tags)==null?void 0:v.map(m=>l("span",{class:b.cardTag,children:m},m))]})]},_.id)})})]},f))}),l(Lo,{visible:t,task:n,onClose:()=>e(!1)}),r&&l(Do,{task:r,onClose:()=>s(null)})]})}const No="_list_1b5ps_1",zo="_card_1b5ps_7",Oo="_name_1b5ps_19",Ho="_desc_1b5ps_24",Uo="_tier_1b5ps_30",Se={list:No,card:zo,name:Oo,desc:Ho,tier:Uo};function qo({visible:t,personas:e,onSelect:n,onCancel:i}){return l(ct,{visible:t,onClose:i,children:[l("h3",{children:"Choose a Persona"}),l("div",{class:Se.list,children:e.map(r=>l("div",{class:Se.card,onClick:()=>n(r.key),children:[l("div",{class:Se.name,children:r.name}),r.description&&l("div",{class:Se.desc,children:r.description}),r.modelTier&&r.modelTier!=="default"&&l("div",{class:Se.tier,children:["Model: ",r.modelTier]})]},r.key))}),l("button",{class:"btn-secondary",onClick:()=>n(null),children:"No Persona (default)"}),l("button",{class:"btn-text",onClick:i,children:"Cancel"})]})}const jo="_list_1kr7a_1",Fo="_item_1kr7a_7",Wo="_info_1kr7a_16",Zo="_name_1kr7a_21",Go="_desc_1kr7a_26",Vo="_actions_1kr7a_34",Ko="_empty_1kr7a_41",re={list:jo,item:Fo,info:Wo,name:Zo,desc:Go,actions:Vo,empty:Ko};function Jo({visible:t,onClose:e,onEdit:n}){const i=Y.value;async function r(s,c){confirm(`Delete persona "${c}"?`)&&(await Vi(s),await Nt())}return l(ct,{visible:t,onClose:e,wide:!0,children:[l("div",{class:"modal-header",children:[l("h3",{children:"Manage Personas"}),l("button",{class:"btn-text",onClick:e,children:"×"})]}),l("div",{class:re.list,children:[i.map(s=>l("div",{class:re.item,children:[l("div",{class:re.info,children:[l("div",{class:re.name,children:s.name}),l("div",{class:re.desc,children:s.description||s.key})]}),l("div",{class:re.actions,children:[l("button",{class:"btn-text",onClick:()=>{e(),n(s)},children:"Edit"}),l("button",{class:"btn-danger",onClick:()=>r(s.key,s.name),children:"Delete"})]})]},s.key)),i.length===0&&l("div",{class:re.empty,children:"No personas yet. Create one to get started."})]}),l("button",{class:"btn-primary",onClick:()=>{e(),n(null)},children:"+ New Persona"})]})}const Qo="_form_14npq_1",Xo="_labelWithAction_14npq_41",mn={form:Qo,labelWithAction:Xo};function Yo({visible:t,persona:e,onClose:n}){const[i,r]=w(""),[s,c]=w(""),[a,u]=w(""),[o,h]=w(""),[d,p]=w(""),[f,g]=w("default"),[_,v]=w(!1),m=ei.value;X(()=>{t&&(or(),e?(r(e.key),c(e.name),u(e.description||""),h(e.preamble||""),p(e.color||""),g(e.modelTier||"default")):(r(""),c(""),u(""),h(""),p(""),g("default")))},[t,e]);async function k(y){y.preventDefault();const O={key:i,name:s,description:a,preamble:o,modelTier:f,color:d};try{e?await Gi(e.key,O):await Zi(O),await Nt(),n()}catch(H){alert("Error: "+(H instanceof Error?H.message:String(H)))}}async function E(){if(!s.trim()){alert("Enter a persona name first.");return}v(!0);try{const y=await Ki({name:s.trim(),description:a.trim()});y.preamble&&h(y.preamble)}catch(y){alert("Generation failed: "+(y instanceof Error?y.message:String(y)))}finally{v(!1)}}return l(ct,{visible:t,onClose:n,wide:!0,children:[l("h3",{children:e?"Edit Persona":"New Persona"}),l("form",{class:mn.form,onSubmit:k,children:[l("label",{children:["Key (unique ID)",l("input",{type:"text",required:!0,placeholder:"e.g. coder",value:i,disabled:!!e,onInput:y=>r(y.target.value)})]}),l("label",{children:["Name",l("input",{type:"text",required:!0,placeholder:"e.g. Code Assistant",value:s,onInput:y=>c(y.target.value)})]}),l("label",{children:["Description",l("input",{type:"text",placeholder:"Short description",value:a,onInput:y=>u(y.target.value)})]}),l("label",{children:["Color",l("div",{class:"color-swatches",children:lr.map(y=>l("div",{class:`color-swatch${y===d?" selected":""}`,style:{background:y},onClick:()=>p(y)},y))})]}),l("label",{children:[l("span",{class:mn.labelWithAction,children:["System Prompt",l("button",{type:"button",class:"btn-inline",disabled:_,onClick:E,children:_?"Generating...":"Generate"})]}),l("textarea",{rows:5,placeholder:"Custom system prompt...",value:o,onInput:y=>h(y.target.value)})]}),l("label",{children:["Model Tier",l("select",{value:f,onChange:y=>g(y.target.value),children:[!m.includes("default")&&l("option",{value:"default",children:"default"}),m.map(y=>l("option",{value:y,children:y},y))]})]}),l("div",{class:"modal-actions",children:[l("button",{type:"button",class:"btn-secondary",style:{width:"auto"},onClick:n,children:"Cancel"}),l("button",{type:"submit",class:"btn-primary",children:"Save"})]})]})]})}function kn(t){window.innerWidth<=768&&t(!0)}function ea(){const[t,e]=w(window.innerWidth<=768),[n,i]=w(!1),[r,s]=w(!1),[c,a]=w(null),[u,o]=w(!1),h=Bt.value;function d(m){const k=rr();Qn({id:k,title:"New Chat",updatedAt:new Date().toISOString(),persona:m}),ne({type:"create_session",chatId:k,content:m||""}),Z.value=k,Re(),kn(e)}function p(){Y.value.length>0?o(!0):d(null)}function f(m){Z.value=m,nr(m),Re(),ne({type:"get_history",chatId:m}),kn(e)}function g(m){fetch(`/api/sessions/${encodeURIComponent(m)}`,{method:"DELETE"}).catch(()=>{}),ne({type:"delete_session",chatId:m}),Xn(m),m===Z.value&&(A.value.length>0?f(A.value[0].id):(Z.value=null,Re(),p()))}function _(m){a(m),s(!0)}function v(){switch(h){case"tasks":return l(Bo,{});case"usage":return l(Vs,{});case"chats":default:return l(As,{sidebarHidden:t,onToggleSidebar:()=>e(!t)})}}return l(ue,{children:[l(Ir,{onNewChat:p,onSwitchChat:f,onDeleteChat:g,onManagePersonas:()=>i(!0),sidebarHidden:t,onToggleSidebar:()=>e(!t)}),v(),l(qo,{visible:u,personas:Y.value,onSelect:m=>{o(!1),d(m)},onCancel:()=>{o(!1),A.value.length===0&&d(null)}}),l(Jo,{visible:n,onClose:()=>i(!1),onEdit:_}),l(Yo,{visible:r,persona:c,onClose:()=>s(!1)})]})}tr();sr();A.value.length>0&&(Z.value=A.value[0].id);Nt();zt();Ri(l(ea,{}),document.getElementById("app"));</script>
    <style rel="stylesheet" crossorigin>._sidebar_1pufl_1{width:260px;flex-shrink:0;background:var(--sidebar-bg);border-right:1px solid var(--border);display:flex;flex-direction:column;height:100dvh;overflow:hidden}._header_1pufl_12{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border);flex-shrink:0}._titleWrap_1pufl_21{position:relative}._menuBtn_1pufl_25{display:flex;align-items:center;gap:4px;background:none;border:none;cursor:pointer;padding:0;color:inherit}._menuBtn_1pufl_25 h2{font-size:16px;font-weight:600}._chevron_1pufl_41{font-size:10px;color:var(--text-secondary);transition:transform .15s}._menuBtn_1pufl_25:hover ._chevron_1pufl_41{color:var(--text)}._actions_1pufl_51{display:flex;gap:4px}._iconBtn_1pufl_56{width:32px;height:32px;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--text-secondary);font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center}._iconBtn_1pufl_56:hover{background:var(--bg-tertiary);color:var(--text)}._newChatBtn_1pufl_75{color:var(--text);font-size:18px}._sessionList_1pufl_81{flex:1;overflow-y:auto;padding:8px}._sessionItem_1pufl_87{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:6px;cursor:pointer;margin-bottom:2px;overflow:hidden;position:relative}._sessionItem_1pufl_87:hover{background:var(--sidebar-hover)}._sessionItem_1pufl_87._active_1pufl_103{background:var(--sidebar-active)}._avatar_1pufl_107{width:28px;height:28px;border-radius:50%;flex-shrink:0;display:flex;align-items:center;justify-content:center;color:#fff;font-size:13px;font-weight:600;text-transform:uppercase}._content_1pufl_121{flex:1;min-width:0}._title_1pufl_21{font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:flex;align-items:center;gap:8px}._unreadDot_1pufl_136{width:8px;height:8px;border-radius:50%;background:var(--accent);flex-shrink:0}._time_1pufl_144{font-size:11px;color:var(--text-secondary);margin-top:2px}._deleteBtn_1pufl_150{display:none;position:absolute;right:8px;top:50%;transform:translateY(-50%);background:var(--bg-secondary);border:1px solid var(--border);border-radius:4px;color:var(--text-secondary);font-size:12px;width:20px;height:20px;cursor:pointer;align-items:center;justify-content:center;padding:0;line-height:1}._deleteBtn_1pufl_150:hover{color:var(--status-disconnected);border-color:var(--status-disconnected)}._sessionItem_1pufl_87:hover ._deleteBtn_1pufl_150{display:flex}._form_572ba_1{display:flex;gap:8px;padding:12px 16px;border-top:1px solid var(--border);background:var(--bg);flex-shrink:0}._input_572ba_10{flex:1;padding:10px 14px;border:1px solid var(--border);border-radius:8px;background:var(--bg-secondary);color:var(--text);font-family:inherit;font-size:16px;resize:none;max-height:120px;outline:none}._input_572ba_10:focus{border-color:var(--accent)}._sendBtn_572ba_28{padding:10px 20px;background:var(--accent);color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;flex-shrink:0}._sendBtn_572ba_28:hover{opacity:.9}._chatArea_1n9gw_1{flex:1;display:flex;flex-direction:column;height:100dvh;min-width:0;position:relative}._header_1n9gw_10{display:flex;align-items:center;gap:12px;padding:12px 16px;border-bottom:1px solid var(--border);flex-shrink:0}._header_1n9gw_10 h1{font-size:18px;font-weight:600;flex:1}._sidebarToggle_1n9gw_25{display:none;background:none;border:none;color:var(--text);font-size:20px;cursor:pointer;padding:4px}._chatId_1n9gw_35{font-size:11px;font-family:monospace;color:var(--text-secondary);opacity:.5;cursor:pointer;flex-shrink:0;-webkit-user-select:none;user-select:none}._chatId_1n9gw_35:hover{opacity:.8}._scrollBtn_1n9gw_49{position:absolute;bottom:80px;right:24px;width:36px;height:36px;border-radius:50%;border:1px solid var(--border);background:var(--bg-secondary);color:var(--text);font-size:18px;cursor:pointer;opacity:.7;z-index:10}._scrollBtn_1n9gw_49:hover{opacity:1}@media(max-width:768px){._sidebarToggle_1n9gw_25{display:block}}._view_1v8xi_1{flex:1;display:flex;flex-direction:column;height:100dvh;min-width:0}._header_1v8xi_9{display:flex;align-items:center;gap:12px;padding:12px 16px;border-bottom:1px solid var(--border);flex-shrink:0}._header_1v8xi_9 h1{font-size:18px;font-weight:600;flex:1}._sidebarToggle_1v8xi_24{display:none;background:none;border:none;color:var(--text);font-size:20px;cursor:pointer;padding:4px}._content_1v8xi_34{flex:1;overflow-y:auto;padding:16px 24px}._content_1v8xi_34 h3{font-size:15px;font-weight:600;margin:20px 0 10px}._content_1v8xi_34 h3:first-of-type{margin-top:16px}._filters_1v8xi_50{display:flex;flex-wrap:wrap;gap:10px;align-items:flex-end}._filters_1v8xi_50 label{display:flex;flex-direction:column;gap:3px;font-size:12px;color:var(--text-secondary)}._filters_1v8xi_50 input,._filters_1v8xi_50 select{padding:6px 8px;border:1px solid var(--border);border-radius:6px;background:var(--bg-secondary);color:var(--text);font-family:inherit;font-size:13px;outline:none;min-width:120px}._filters_1v8xi_50 input:focus,._filters_1v8xi_50 select:focus{border-color:var(--accent)}._summaryCards_1v8xi_83{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-top:16px}._card_1v8xi_90{background:var(--bg-secondary);border:1px solid var(--border);border-radius:8px;padding:14px 16px;text-align:center}._cardLabel_1v8xi_98{font-size:12px;color:var(--text-secondary);margin-bottom:4px}._cardValue_1v8xi_104{font-size:22px;font-weight:700;color:var(--text)}._tableWrap_1v8xi_110{overflow-x:auto}._table_1v8xi_110{width:100%;border-collapse:collapse;font-size:13px}._table_1v8xi_110 th,._table_1v8xi_110 td{padding:8px 12px;border:1px solid var(--border);text-align:left}._table_1v8xi_110 th{background:var(--bg-tertiary);font-weight:600;-webkit-user-select:none;user-select:none;white-space:nowrap;cursor:pointer}._table_1v8xi_110 th:hover{background:var(--border)}._table_1v8xi_110 td:not(:first-child){text-align:right;font-variant-numeric:tabular-nums}._table_1v8xi_110 tr:nth-child(2n){background:color-mix(in srgb,var(--bg-tertiary) 40%,transparent)}._table_1v8xi_110 tr:hover{background:color-mix(in srgb,var(--accent) 8%,transparent)}._sortAsc_1v8xi_152:after{content:" ▲";font-size:10px}._sortDesc_1v8xi_157:after{content:" ▼";font-size:10px}._noData_1v8xi_162{text-align:center;color:var(--text-secondary);padding:12px}@media(max-width:768px){._sidebarToggle_1v8xi_24{display:block}._content_1v8xi_34{padding:12px}._filters_1v8xi_50{flex-direction:column;align-items:stretch}._filters_1v8xi_50 label{width:100%}._filters_1v8xi_50 input,._filters_1v8xi_50 select{width:100%;min-width:0}._summaryCards_1v8xi_83{grid-template-columns:repeat(2,1fr)}}._view_7t6ed_1{flex:1;display:flex;flex-direction:column;height:100dvh;min-width:0}._header_7t6ed_9{display:flex;align-items:center;gap:12px;padding:12px 16px;border-bottom:1px solid var(--border);flex-shrink:0}._header_7t6ed_9 h1{font-size:18px;font-weight:600;flex:1}._board_7t6ed_24{flex:1;display:flex;gap:12px;padding:16px;overflow-x:auto;align-items:flex-start}._column_7t6ed_33{flex:1;min-width:220px;max-width:320px;background:var(--bg-secondary);border:1px solid var(--border);border-radius:10px;display:flex;flex-direction:column;max-height:calc(100dvh - 80px)}._columnHeader_7t6ed_45{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-bottom:1px solid var(--border);flex-shrink:0}._columnTitle_7t6ed_54{font-size:13px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--text-secondary)}._columnCount_7t6ed_62{font-size:11px;font-weight:600;background:var(--bg-tertiary);color:var(--text-secondary);padding:2px 7px;border-radius:10px}._cards_7t6ed_71{flex:1;overflow-y:auto;padding:8px;display:flex;flex-direction:column;gap:6px;min-height:40px}._dragOver_7t6ed_81{background:color-mix(in srgb,var(--accent) 8%,transparent);border-radius:0 0 10px 10px}._card_7t6ed_71{background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:10px 12px;cursor:pointer;transition:box-shadow .15s,border-color .15s;-webkit-user-select:none;user-select:none}._card_7t6ed_71:hover{border-color:var(--accent);box-shadow:0 2px 8px #00000014}._dragging_7t6ed_101{opacity:.4}._cardTitle_7t6ed_105{font-size:13px;font-weight:500;margin-bottom:6px;display:flex;align-items:center;gap:6px}._priorityDot_7t6ed_114{width:8px;height:8px;border-radius:50%;flex-shrink:0}._priorityLow_7t6ed_121{background:#94a3b8}._priorityMedium_7t6ed_122{background:#3b82f6}._priorityHigh_7t6ed_123{background:#f59e0b}._priorityUrgent_7t6ed_124{background:#ef4444}._cardMeta_7t6ed_126{display:flex;align-items:center;gap:6px;flex-wrap:wrap}._cardAssignee_7t6ed_133{font-size:11px;font-weight:600;width:20px;height:20px;border-radius:50%;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;text-transform:uppercase}._cardTag_7t6ed_147{font-size:10px;padding:1px 6px;background:var(--bg-tertiary);color:var(--text-secondary);border-radius:4px}._detailContent_7t6ed_157{max-width:960px;width:95%;max-height:90vh;display:flex;flex-direction:column;padding:0;overflow:hidden}._detailHeader_7t6ed_167{display:flex;align-items:center;gap:8px;padding:16px 20px 8px;border-bottom:1px solid var(--border)}._detailTitleInput_7t6ed_175{flex:1;font-size:18px;font-weight:600;border:none;background:transparent;color:var(--text);outline:none;padding:4px 0}._detailTitleInput_7t6ed_175::placeholder{color:var(--text-secondary)}._detailId_7t6ed_190{font-size:11px;font-family:monospace;color:var(--text-secondary);flex-shrink:0;opacity:.7;cursor:pointer;-webkit-user-select:none;user-select:none}._detailId_7t6ed_190:hover{opacity:1}._detailBody_7t6ed_204{display:flex;flex:1;overflow:hidden}._detailLeft_7t6ed_210{width:300px;flex-shrink:0;overflow-y:auto;border-right:1px solid var(--border);display:flex;flex-direction:column}._detailRight_7t6ed_219{flex:1;display:flex;flex-direction:column;min-width:0;min-height:0;overflow:hidden}._detailMeta_7t6ed_228{display:flex;flex-wrap:wrap;gap:8px;padding:10px 16px;border-bottom:1px solid var(--border)}._detailMeta_7t6ed_228 label{display:flex;flex-direction:column;gap:2px;font-size:11px;color:var(--text-secondary);flex:1 1 calc(50% - 4px);min-width:100px}._detailMeta_7t6ed_228 select,._detailMeta_7t6ed_228 input{padding:4px 8px;border:1px solid var(--border);border-radius:4px;background:var(--bg-secondary);color:var(--text);font-size:13px;outline:none}._detailMeta_7t6ed_228 select:focus,._detailMeta_7t6ed_228 input:focus{border-color:var(--accent)}._sectionLabel_7t6ed_262{padding:8px 16px 4px;font-size:11px;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.5px}._description_7t6ed_270{padding:12px 20px;font-size:13px;color:var(--text-secondary);flex:1;overflow-y:auto;cursor:pointer;min-height:80px;line-height:1.5}._description_7t6ed_270:hover{background:var(--bg-secondary)}._descriptionPlaceholder_7t6ed_285{color:var(--text-secondary);font-style:italic;opacity:.6}._descriptionEdit_7t6ed_291{padding:12px 20px;font-size:13px;color:var(--text);flex:1;min-height:80px;font-family:inherit;line-height:1.5;border:none;outline:none;background:var(--bg-secondary);resize:none;width:100%;box-sizing:border-box}._taskMessages_7t6ed_307{flex:1;overflow-y:auto;padding:12px 20px;display:flex;flex-direction:column;gap:8px;min-height:200px}._taskMessages_7t6ed_307 ._message_7t6ed_317{max-width:90%}._taskMessagesEmpty_7t6ed_321{color:var(--text-secondary);font-size:13px;text-align:center;padding:40px 0}._taskInputForm_7t6ed_328{display:flex;gap:8px;padding:10px 20px 16px;border-top:1px solid var(--border)}._taskInputForm_7t6ed_328 textarea{flex:1;padding:8px 12px;border:1px solid var(--border);border-radius:8px;background:var(--bg-secondary);color:var(--text);font-family:inherit;font-size:14px;resize:none;outline:none;max-height:120px}._taskInputForm_7t6ed_328 textarea:focus{border-color:var(--accent)}._taskInputForm_7t6ed_328 button{padding:8px 16px;background:var(--accent);color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;align-self:flex-end}._taskInputForm_7t6ed_328 button:hover{opacity:.9}._editorForm_7t6ed_369{display:flex;flex-direction:column;gap:12px}._editorForm_7t6ed_369 label{display:flex;flex-direction:column;gap:4px;font-size:13px;color:var(--text-secondary)}._editorForm_7t6ed_369 input,._editorForm_7t6ed_369 textarea,._editorForm_7t6ed_369 select{padding:8px 10px;border:1px solid var(--border);border-radius:6px;background:var(--bg-secondary);color:var(--text);font-family:inherit;font-size:14px;outline:none}._editorForm_7t6ed_369 input:focus,._editorForm_7t6ed_369 textarea:focus,._editorForm_7t6ed_369 select:focus{border-color:var(--accent)}._editorForm_7t6ed_369 textarea{resize:vertical;min-height:60px}@media(max-width:768px){._board_7t6ed_24{padding:8px;gap:8px}._column_7t6ed_33{min-width:200px}}@media(max-width:600px){._detailBody_7t6ed_204{flex-direction:column}._detailLeft_7t6ed_210{width:100%;border-right:none;border-bottom:1px solid var(--border);max-height:40vh;overflow-y:auto}._taskMessages_7t6ed_307{min-height:0}}._list_1b5ps_1{display:flex;flex-direction:column;gap:8px}._card_1b5ps_7{padding:10px 12px;border:1px solid var(--border);border-radius:8px;cursor:pointer;transition:border-color .15s}._card_1b5ps_7:hover{border-color:var(--accent)}._name_1b5ps_19{font-size:14px;font-weight:500}._desc_1b5ps_24{font-size:12px;color:var(--text-secondary);margin-top:2px}._tier_1b5ps_30{font-size:11px;color:var(--text-secondary);margin-top:4px;font-style:italic}._list_1kr7a_1{display:flex;flex-direction:column;gap:6px}._item_1kr7a_7{display:flex;align-items:center;justify-content:space-between;padding:8px 10px;border:1px solid var(--border);border-radius:6px}._info_1kr7a_16{flex:1;min-width:0}._name_1kr7a_21{font-size:14px;font-weight:500}._desc_1kr7a_26{font-size:12px;color:var(--text-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}._actions_1kr7a_34{display:flex;gap:4px;flex-shrink:0;margin-left:8px}._empty_1kr7a_41{text-align:center;color:var(--text-secondary);font-size:13px;padding:16px 0}._form_14npq_1{display:flex;flex-direction:column;gap:12px}._form_14npq_1 label{display:flex;flex-direction:column;gap:4px;font-size:13px;color:var(--text-secondary)}._form_14npq_1 input,._form_14npq_1 textarea,._form_14npq_1 select{padding:8px 10px;border:1px solid var(--border);border-radius:6px;background:var(--bg-secondary);color:var(--text);font-family:inherit;font-size:14px;outline:none}._form_14npq_1 input:focus,._form_14npq_1 textarea:focus,._form_14npq_1 select:focus{border-color:var(--accent)}._form_14npq_1 textarea{resize:vertical;min-height:80px;font-family:SF Mono,Fira Code,Cascadia Code,monospace;font-size:13px}._labelWithAction_14npq_41{display:flex;align-items:center;justify-content:space-between}:root{--bg: #ffffff;--bg-secondary: #f5f5f5;--bg-tertiary: #ebebeb;--text: #1a1a1a;--text-secondary: #666666;--border: #e0e0e0;--user-bg: #0066cc;--user-text: #ffffff;--assistant-bg: #f0f0f0;--assistant-text: #1a1a1a;--code-bg: #f5f5f5;--code-border: #ddd;--accent: #0066cc;--status-connected: #22c55e;--status-disconnected: #ef4444;--status-reconnecting: #f59e0b;--sidebar-bg: #f8f8f8;--sidebar-active: #e8e8e8;--sidebar-hover: #f0f0f0}@media(prefers-color-scheme:dark){:root{--bg: #1a1a1a;--bg-secondary: #2a2a2a;--bg-tertiary: #333333;--text: #e0e0e0;--text-secondary: #999999;--border: #333333;--user-bg: #0066cc;--user-text: #ffffff;--assistant-bg: #2a2a2a;--assistant-text: #e0e0e0;--code-bg: #333333;--code-border: #444;--accent: #4d94ff;--sidebar-bg: #222222;--sidebar-active: #333333;--sidebar-hover: #2a2a2a}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--text);height:100dvh;overflow:hidden}#app{display:flex;flex-direction:row;height:100dvh}.modal{position:fixed;top:0;right:0;bottom:0;left:0;z-index:200;display:flex;align-items:center;justify-content:center;background:#0006}.modal.hidden{display:none}.modal-content{background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:24px;max-width:420px;width:90%;max-height:80vh;overflow-y:auto;display:flex;flex-direction:column;gap:12px}.modal-content.modal-wide{max-width:520px}.modal-content h3{font-size:16px;font-weight:600}.modal-header{display:flex;align-items:center;justify-content:space-between}.modal-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:4px}.btn-primary{padding:8px 16px;background:var(--accent);color:#fff;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer}.btn-primary:hover{opacity:.9}.btn-secondary{padding:8px 16px;background:var(--bg-secondary);color:var(--text);border:1px solid var(--border);border-radius:6px;font-size:13px;cursor:pointer;width:100%}.btn-secondary:hover{background:var(--bg-tertiary)}.btn-text{background:none;border:none;color:var(--text-secondary);font-size:14px;cursor:pointer;padding:4px 8px}.btn-text:hover{color:var(--text)}.btn-danger{background:none;border:none;color:var(--status-disconnected);font-size:12px;cursor:pointer;padding:2px 6px}.btn-danger:hover{text-decoration:underline}.btn-sm{font-size:12px;padding:4px 8px}.btn-inline{background:none;border:none;color:var(--accent);cursor:pointer;font-size:12px;padding:0}.btn-inline:hover{text-decoration:underline}.hidden{display:none!important}.message{max-width:80%;padding:10px 14px;border-radius:12px;line-height:1.5;font-size:14px;word-wrap:break-word;overflow-wrap:break-word}.message.user{align-self:flex-end;background:var(--user-bg);color:var(--user-text);border-bottom-right-radius:4px}.message.assistant{align-self:flex-start;background:var(--assistant-bg);color:var(--assistant-text);border-bottom-left-radius:4px}.message.system{align-self:center;background:transparent;color:var(--text-secondary);font-size:12px;font-style:italic}.thinking{display:flex;gap:4px;padding:8px 14px;align-self:flex-start}.thinking span{width:8px;height:8px;border-radius:50%;background:var(--text-secondary);animation:pulse 1.4s infinite ease-in-out}.thinking span:nth-child(2){animation-delay:.2s}.thinking span:nth-child(3){animation-delay:.4s}@keyframes pulse{0%,80%,to{opacity:.3;transform:scale(.8)}40%{opacity:1;transform:scale(1)}}.status{font-size:12px;padding:2px 8px;border-radius:10px;font-weight:500;flex-shrink:0}.status.connected{color:var(--status-connected)}.status.disconnected{color:var(--status-disconnected)}.status.reconnecting{color:var(--status-reconnecting)}.persona-badge{font-size:11px;color:var(--accent);font-weight:500;padding:1px 6px;background:color-mix(in srgb,var(--accent) 10%,transparent);border-radius:4px;display:inline-flex;align-items:center;gap:4px}.header-avatar{width:18px;height:18px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;color:#fff;font-size:10px;font-weight:600;text-transform:uppercase;flex-shrink:0}.color-swatches{display:flex;flex-wrap:wrap;gap:6px;margin-top:4px}.color-swatch{width:24px;height:24px;border-radius:50%;cursor:pointer;border:2px solid transparent;transition:border-color .15s}.color-swatch:hover{border-color:var(--text-secondary)}.color-swatch.selected{border-color:var(--text);box-shadow:0 0 0 2px var(--bg)}.dropdown{position:absolute;left:0;top:calc(100% + 4px);background:var(--bg);border:1px solid var(--border);border-radius:8px;box-shadow:0 4px 12px #00000026;min-width:140px;z-index:50;padding:4px 0}.dropdown-item{display:block;width:100%;padding:8px 14px;background:none;border:none;color:var(--text);font-size:13px;text-align:left;cursor:pointer;font-family:inherit}.dropdown-item:hover{background:var(--sidebar-hover)}.dropdown-item.active{color:var(--accent);font-weight:600}@media(max-width:768px){.sidebar{position:fixed;left:0;top:0;bottom:0;z-index:100;transform:translate(0);transition:transform .2s ease}.sidebar-hidden .sidebar{transform:translate(-100%)}.sidebar-toggle-btn{display:block!important}.sidebar-overlay{position:fixed;top:0;right:0;bottom:0;left:0;background:#0000004d;z-index:99}}.message.assistant p{margin-bottom:8px}.message.assistant p:last-child{margin-bottom:0}.message.assistant code{background:var(--code-bg);padding:2px 5px;border-radius:3px;font-family:SF Mono,Fira Code,Cascadia Code,monospace;font-size:13px}.message.assistant pre{background:var(--code-bg);border:1px solid var(--code-border);border-radius:6px;padding:10px;margin:8px 0;overflow-x:auto;font-size:13px}.message.assistant pre code{background:none;padding:0;font-size:inherit}.message.assistant ul,.message.assistant ol{margin:4px 0;padding-left:20px}.message.assistant a{color:var(--accent);text-decoration:underline}.message.assistant blockquote{border-left:3px solid var(--border);padding-left:10px;margin:4px 0;color:var(--text-secondary)}.message.assistant table{border-collapse:collapse;margin:8px 0;font-size:13px;width:100%}.message.assistant th,.message.assistant td{border:1px solid var(--border);padding:6px 10px}.message.assistant th{background:var(--bg-tertiary);font-weight:600}.message.assistant tr:nth-child(2n){background:color-mix(in srgb,var(--bg-tertiary) 40%,transparent)}</style>
  </head>
  <body>
    <div id="app"></div>
  </body>
</html>
