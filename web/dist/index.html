<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Patina Chat</title>
    <script type="module" crossorigin>var Si=Object.defineProperty;var $i=(t,e,n)=>e in t?Si(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var R=(t,e,n)=>$i(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var ot,C,xn,Sn,oe,Xt,$n,Tn,Cn,Dt,mt,yt,Je={},Qe=[],Ti=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,at=Array.isArray;function K(t,e){for(var n in e)t[n]=e[n];return t}function Et(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function Ci(t,e,n){var i,r,s,c={};for(s in e)s=="key"?i=e[s]:s=="ref"?r=e[s]:c[s]=e[s];if(arguments.length>2&&(c.children=arguments.length>3?ot.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(s in t.defaultProps)c[s]===void 0&&(c[s]=t.defaultProps[s]);return We(t,c,i,r,null)}function We(t,e,n,i,r){var s={type:t,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:r??++xn,__i:-1,__u:0};return r==null&&C.vnode!=null&&C.vnode(s),s}function ae(t){return t.children}function Ce(t,e){this.props=t,this.context=e}function ge(t,e){if(e==null)return t.__?ge(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?ge(t):null}function Ii(t){if(t.__P&&t.__d){var e=t.__v,n=e.__e,i=[],r=[],s=K({},e);s.__v=e.__v+1,C.vnode&&C.vnode(s),Mt(t.__P,s,e,t.__n,t.__P.namespaceURI,32&e.__u?[n]:null,i,n??ge(e),!!(32&e.__u),r),s.__v=e.__v,s.__.__k[s.__i]=s,Pn(i,s,r),e.__e=e.__=null,s.__e!=n&&In(s)}}function In(t){if((t=t.__)!=null&&t.__c!=null)return t.__e=t.__c.base=null,t.__k.some(function(e){if(e!=null&&e.__e!=null)return t.__e=t.__c.base=e.__e}),In(t)}function Yt(t){(!t.__d&&(t.__d=!0)&&oe.push(t)&&!Xe.__r++||Xt!=C.debounceRendering)&&((Xt=C.debounceRendering)||$n)(Xe)}function Xe(){for(var t,e=1;oe.length;)oe.length>e&&oe.sort(Tn),t=oe.shift(),e=oe.length,Ii(t);Xe.__r=0}function An(t,e,n,i,r,s,c,a,h,o,u){var d,p,_,f,g,v,y,m=i&&i.__k||Qe,L=e.length;for(h=Ai(n,e,m,h,L),d=0;d<L;d++)(_=n.__k[d])!=null&&(p=_.__i!=-1&&m[_.__i]||Je,_.__i=d,v=Mt(t,_,p,r,s,c,a,h,o,u),f=_.__e,_.ref&&p.ref!=_.ref&&(p.ref&&Bt(p.ref,null,_),u.push(_.ref,_.__c||f,_)),g==null&&f!=null&&(g=f),(y=!!(4&_.__u))||p.__k===_.__k?h=Rn(_,h,t,y):typeof _.type=="function"&&v!==void 0?h=v:f&&(h=f.nextSibling),_.__u&=-7);return n.__e=g,h}function Ai(t,e,n,i,r){var s,c,a,h,o,u=n.length,d=u,p=0;for(t.__k=new Array(r),s=0;s<r;s++)(c=e[s])!=null&&typeof c!="boolean"&&typeof c!="function"?(typeof c=="string"||typeof c=="number"||typeof c=="bigint"||c.constructor==String?c=t.__k[s]=We(null,c,null,null,null):at(c)?c=t.__k[s]=We(ae,{children:c},null,null,null):c.constructor===void 0&&c.__b>0?c=t.__k[s]=We(c.type,c.props,c.key,c.ref?c.ref:null,c.__v):t.__k[s]=c,h=s+p,c.__=t,c.__b=t.__b+1,a=null,(o=c.__i=Ri(c,n,h,d))!=-1&&(d--,(a=n[o])&&(a.__u|=2)),a==null||a.__v==null?(o==-1&&(r>u?p--:r<u&&p++),typeof c.type!="function"&&(c.__u|=4)):o!=h&&(o==h-1?p--:o==h+1?p++:(o>h?p--:p++,c.__u|=4))):t.__k[s]=null;if(d)for(s=0;s<u;s++)(a=n[s])!=null&&(2&a.__u)==0&&(a.__e==i&&(i=ge(a)),Dn(a,a));return i}function Rn(t,e,n,i){var r,s;if(typeof t.type=="function"){for(r=t.__k,s=0;r&&s<r.length;s++)r[s]&&(r[s].__=t,e=Rn(r[s],e,n,i));return e}t.__e!=e&&(i&&(e&&t.type&&!e.parentNode&&(e=ge(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function Ri(t,e,n,i){var r,s,c,a=t.key,h=t.type,o=e[n],u=o!=null&&(2&o.__u)==0;if(o===null&&a==null||u&&a==o.key&&h==o.type)return n;if(i>(u?1:0)){for(r=n-1,s=n+1;r>=0||s<e.length;)if((o=e[c=r>=0?r--:s++])!=null&&(2&o.__u)==0&&a==o.key&&h==o.type)return c}return-1}function en(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Ti.test(e)?n:n+"px"}function He(t,e,n,i,r){var s,c;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof i=="string"&&(t.style.cssText=i=""),i)for(e in i)n&&e in n||en(t.style,e,"");if(n)for(e in n)i&&n[e]==i[e]||en(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(Cn,"$1")),c=e.toLowerCase(),e=c in t||e=="onFocusOut"||e=="onFocusIn"?c.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+s]=n,n?i?n.u=i.u:(n.u=Dt,t.addEventListener(e,s?yt:mt,s)):t.removeEventListener(e,s?yt:mt,s);else{if(r=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function tn(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=Dt++;else if(e.t<n.u)return;return n(C.event?C.event(e):e)}}}function Mt(t,e,n,i,r,s,c,a,h,o){var u,d,p,_,f,g,v,y,m,L,k,b,P,D,N,F=e.type;if(e.constructor!==void 0)return null;128&n.__u&&(h=!!(32&n.__u),s=[a=e.__e=n.__e]),(u=C.__b)&&u(e);e:if(typeof F=="function")try{if(y=e.props,m="prototype"in F&&F.prototype.render,L=(u=F.contextType)&&i[u.__c],k=u?L?L.props.value:u.__:i,n.__c?v=(d=e.__c=n.__c).__=d.__E:(m?e.__c=d=new F(y,k):(e.__c=d=new Ce(y,k),d.constructor=F,d.render=Li),L&&L.sub(d),d.state||(d.state={}),d.__n=i,p=d.__d=!0,d.__h=[],d._sb=[]),m&&d.__s==null&&(d.__s=d.state),m&&F.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=K({},d.__s)),K(d.__s,F.getDerivedStateFromProps(y,d.__s))),_=d.props,f=d.state,d.__v=e,p)m&&F.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),m&&d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(m&&F.getDerivedStateFromProps==null&&y!==_&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(y,k),e.__v==n.__v||!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(y,d.__s,k)===!1){e.__v!=n.__v&&(d.props=y,d.state=d.__s,d.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(ee){ee&&(ee.__=e)}),Qe.push.apply(d.__h,d._sb),d._sb=[],d.__h.length&&c.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(y,d.__s,k),m&&d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(_,f,g)})}if(d.context=k,d.props=y,d.__P=t,d.__e=!1,b=C.__r,P=0,m)d.state=d.__s,d.__d=!1,b&&b(e),u=d.render(d.props,d.state,d.context),Qe.push.apply(d.__h,d._sb),d._sb=[];else do d.__d=!1,b&&b(e),u=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++P<25);d.state=d.__s,d.getChildContext!=null&&(i=K(K({},i),d.getChildContext())),m&&!p&&d.getSnapshotBeforeUpdate!=null&&(g=d.getSnapshotBeforeUpdate(_,f)),D=u!=null&&u.type===ae&&u.key==null?Ln(u.props.children):u,a=An(t,at(D)?D:[D],e,n,i,r,s,c,a,h,o),d.base=e.__e,e.__u&=-161,d.__h.length&&c.push(d),v&&(d.__E=d.__=null)}catch(ee){if(e.__v=null,h||s!=null)if(ee.then){for(e.__u|=h?160:128;a&&a.nodeType==8&&a.nextSibling;)a=a.nextSibling;s[s.indexOf(a)]=null,e.__e=a}else{for(N=s.length;N--;)Et(s[N]);kt(e)}else e.__e=n.__e,e.__k=n.__k,ee.then||kt(e);C.__e(ee,e,n)}else s==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):a=e.__e=Pi(n.__e,e,n,i,r,s,c,h,o);return(u=C.diffed)&&u(e),128&e.__u?void 0:a}function kt(t){t&&(t.__c&&(t.__c.__e=!0),t.__k&&t.__k.some(kt))}function Pn(t,e,n){for(var i=0;i<n.length;i++)Bt(n[i],n[++i],n[++i]);C.__c&&C.__c(e,t),t.some(function(r){try{t=r.__h,r.__h=[],t.some(function(s){s.call(r)})}catch(s){C.__e(s,r.__v)}})}function Ln(t){return typeof t!="object"||t==null||t.__b>0?t:at(t)?t.map(Ln):K({},t)}function Pi(t,e,n,i,r,s,c,a,h){var o,u,d,p,_,f,g,v=n.props||Je,y=e.props,m=e.type;if(m=="svg"?r="http://www.w3.org/2000/svg":m=="math"?r="http://www.w3.org/1998/Math/MathML":r||(r="http://www.w3.org/1999/xhtml"),s!=null){for(o=0;o<s.length;o++)if((_=s[o])&&"setAttribute"in _==!!m&&(m?_.localName==m:_.nodeType==3)){t=_,s[o]=null;break}}if(t==null){if(m==null)return document.createTextNode(y);t=document.createElementNS(r,m,y.is&&y),a&&(C.__m&&C.__m(e,s),a=!1),s=null}if(m==null)v===y||a&&t.data==y||(t.data=y);else{if(s=s&&ot.call(t.childNodes),!a&&s!=null)for(v={},o=0;o<t.attributes.length;o++)v[(_=t.attributes[o]).name]=_.value;for(o in v)_=v[o],o=="dangerouslySetInnerHTML"?d=_:o=="children"||o in y||o=="value"&&"defaultValue"in y||o=="checked"&&"defaultChecked"in y||He(t,o,null,_,r);for(o in y)_=y[o],o=="children"?p=_:o=="dangerouslySetInnerHTML"?u=_:o=="value"?f=_:o=="checked"?g=_:a&&typeof _!="function"||v[o]===_||He(t,o,_,v[o],r);if(u)a||d&&(u.__html==d.__html||u.__html==t.innerHTML)||(t.innerHTML=u.__html),e.__k=[];else if(d&&(t.innerHTML=""),An(e.type=="template"?t.content:t,at(p)?p:[p],e,n,i,m=="foreignObject"?"http://www.w3.org/1999/xhtml":r,s,c,s?s[0]:n.__k&&ge(n,0),a,h),s!=null)for(o=s.length;o--;)Et(s[o]);a||(o="value",m=="progress"&&f==null?t.removeAttribute("value"):f!=null&&(f!==t[o]||m=="progress"&&!f||m=="option"&&f!=v[o])&&He(t,o,f,v[o],r),o="checked",g!=null&&g!=t[o]&&He(t,o,g,v[o],r))}return t}function Bt(t,e,n){try{if(typeof t=="function"){var i=typeof t.__u=="function";i&&t.__u(),i&&e==null||(t.__u=t(e))}else t.current=e}catch(r){C.__e(r,n)}}function Dn(t,e,n){var i,r;if(C.unmount&&C.unmount(t),(i=t.ref)&&(i.current&&i.current!=t.__e||Bt(i,null,e)),(i=t.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(s){C.__e(s,e)}i.base=i.__P=null}if(i=t.__k)for(r=0;r<i.length;r++)i[r]&&Dn(i[r],e,n||typeof t.type!="function");n||Et(t.__e),t.__c=t.__=t.__e=void 0}function Li(t,e,n){return this.constructor(t,n)}function Di(t,e,n){var i,r,s,c;e==document&&(e=document.documentElement),C.__&&C.__(t,e),r=(i=!1)?null:e.__k,s=[],c=[],Mt(e,t=e.__k=Ci(ae,null,[t]),r||Je,Je,e.namespaceURI,r?null:e.firstChild?ot.call(e.childNodes):null,s,r?r.__e:e.firstChild,i,c),Pn(s,t,c)}ot=Qe.slice,C={__e:function(t,e,n,i){for(var r,s,c;e=e.__;)if((r=e.__c)&&!r.__)try{if((s=r.constructor)&&s.getDerivedStateFromError!=null&&(r.setState(s.getDerivedStateFromError(t)),c=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t,i||{}),c=r.__d),c)return r.__E=r}catch(a){t=a}throw t}},xn=0,Sn=function(t){return t!=null&&t.constructor===void 0},Ce.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=K({},this.state),typeof t=="function"&&(t=t(K({},n),this.props)),t&&K(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),Yt(this))},Ce.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Yt(this))},Ce.prototype.render=ae,oe=[],$n=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Tn=function(t,e){return t.__v.__b-e.__v.__b},Xe.__r=0,Cn=/(PointerCapture)$|Capture$/i,Dt=0,mt=tn(!1),yt=tn(!0);var Ei=0;function l(t,e,n,i,r,s){e||(e={});var c,a,h=e;if("ref"in h)for(a in h={},e)a=="ref"?c=e[a]:h[a]=e[a];var o={type:t,props:h,key:n,ref:c,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ei,__i:-1,__u:0,__source:r,__self:s};if(typeof t=="function"&&(c=t.defaultProps))for(a in c)h[a]===void 0&&(h[a]=c[a]);return C.vnode&&C.vnode(o),o}var De,B,pt,nn,Ye=0,En=[],z=C,rn=z.__b,sn=z.__r,on=z.diffed,an=z.__c,ln=z.unmount,cn=z.__;function zt(t,e){z.__h&&z.__h(B,t,Ye||e),Ye=0;var n=B.__H||(B.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function S(t){return Ye=1,Mi(Bn,t)}function Mi(t,e,n){var i=zt(De++,2);if(i.t=t,!i.__c&&(i.__=[Bn(void 0,e),function(a){var h=i.__N?i.__N[0]:i.__[0],o=i.t(h,a);h!==o&&(i.__N=[o,i.__[1]],i.__c.setState({}))}],i.__c=B,!B.__f)){var r=function(a,h,o){if(!i.__c.__H)return!0;var u=i.__c.__H.__.filter(function(p){return p.__c});if(u.every(function(p){return!p.__N}))return!s||s.call(this,a,h,o);var d=i.__c.props!==a;return u.some(function(p){if(p.__N){var _=p.__[0];p.__=p.__N,p.__N=void 0,_!==p.__[0]&&(d=!0)}}),s&&s.call(this,a,h,o)||d};B.__f=!0;var s=B.shouldComponentUpdate,c=B.componentWillUpdate;B.componentWillUpdate=function(a,h,o){if(this.__e){var u=s;s=void 0,r(a,h,o),s=u}c&&c.call(this,a,h,o)},B.shouldComponentUpdate=r}return i.__N||i.__}function X(t,e){var n=zt(De++,3);!z.__s&&Mn(n.__H,e)&&(n.__=t,n.u=e,B.__H.__h.push(n))}function pe(t){return Ye=5,Nt(function(){return{current:t}},[])}function Nt(t,e){var n=zt(De++,7);return Mn(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function Bi(){for(var t;t=En.shift();){var e=t.__H;if(t.__P&&e)try{e.__h.some(Ge),e.__h.some(bt),e.__h=[]}catch(n){e.__h=[],z.__e(n,t.__v)}}}z.__b=function(t){B=null,rn&&rn(t)},z.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),cn&&cn(t,e)},z.__r=function(t){sn&&sn(t),De=0;var e=(B=t.__c).__H;e&&(pt===B?(e.__h=[],B.__h=[],e.__.some(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.some(Ge),e.__h.some(bt),e.__h=[],De=0)),pt=B},z.diffed=function(t){on&&on(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(En.push(e)!==1&&nn===z.requestAnimationFrame||((nn=z.requestAnimationFrame)||zi)(Bi)),e.__H.__.some(function(n){n.u&&(n.__H=n.u),n.u=void 0})),pt=B=null},z.__c=function(t,e){e.some(function(n){try{n.__h.some(Ge),n.__h=n.__h.filter(function(i){return!i.__||bt(i)})}catch(i){e.some(function(r){r.__h&&(r.__h=[])}),e=[],z.__e(i,n.__v)}}),an&&an(t,e)},z.unmount=function(t){ln&&ln(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.some(function(i){try{Ge(i)}catch(r){e=r}}),n.__H=void 0,e&&z.__e(e,n.__v))};var un=typeof requestAnimationFrame=="function";function zi(t){var e,n=function(){clearTimeout(i),un&&cancelAnimationFrame(e),setTimeout(t)},i=setTimeout(n,35);un&&(e=requestAnimationFrame(n))}function Ge(t){var e=B,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),B=e}function bt(t){var e=B;t.__c=t.__(),B=e}function Mn(t,e){return!t||t.length!==e.length||e.some(function(n,i){return n!==t[i]})}function Bn(t,e){return typeof e=="function"?e(t):e}var Ni=Symbol.for("preact-signals");function lt(){if(te>1)te--;else{for(var t,e=!1;Ie!==void 0;){var n=Ie;for(Ie=void 0,wt++;n!==void 0;){var i=n.o;if(n.o=void 0,n.f&=-3,!(8&n.f)&&On(n))try{n.c()}catch(r){e||(t=r,e=!0)}n=i}}if(wt=0,te--,e)throw t}}function Oi(t){if(te>0)return t();te++;try{return t()}finally{lt()}}var $=void 0;function zn(t){var e=$;$=void 0;try{return t()}finally{$=e}}var Ie=void 0,te=0,wt=0,et=0;function Nn(t){if($!==void 0){var e=t.n;if(e===void 0||e.t!==$)return e={i:0,S:t,p:$.s,n:void 0,t:$,e:void 0,x:void 0,r:e},$.s!==void 0&&($.s.n=e),$.s=e,t.n=e,32&$.f&&t.S(e),e;if(e.i===-1)return e.i=0,e.n!==void 0&&(e.n.p=e.p,e.p!==void 0&&(e.p.n=e.n),e.p=$.s,e.n=void 0,$.s.n=e,$.s=e),e}}function O(t,e){this.v=t,this.i=0,this.n=void 0,this.t=void 0,this.W=e==null?void 0:e.watched,this.Z=e==null?void 0:e.unwatched,this.name=e==null?void 0:e.name}O.prototype.brand=Ni;O.prototype.h=function(){return!0};O.prototype.S=function(t){var e=this,n=this.t;n!==t&&t.e===void 0&&(t.x=n,this.t=t,n!==void 0?n.e=t:zn(function(){var i;(i=e.W)==null||i.call(e)}))};O.prototype.U=function(t){var e=this;if(this.t!==void 0){var n=t.e,i=t.x;n!==void 0&&(n.x=i,t.e=void 0),i!==void 0&&(i.e=n,t.x=void 0),t===this.t&&(this.t=i,i===void 0&&zn(function(){var r;(r=e.Z)==null||r.call(e)}))}};O.prototype.subscribe=function(t){var e=this;return ze(function(){var n=e.value,i=$;$=void 0;try{t(n)}finally{$=i}},{name:"sub"})};O.prototype.valueOf=function(){return this.value};O.prototype.toString=function(){return this.value+""};O.prototype.toJSON=function(){return this.value};O.prototype.peek=function(){var t=$;$=void 0;try{return this.value}finally{$=t}};Object.defineProperty(O.prototype,"value",{get:function(){var t=Nn(this);return t!==void 0&&(t.i=this.i),this.v},set:function(t){if(t!==this.v){if(wt>100)throw new Error("Cycle detected");this.v=t,this.i++,et++,te++;try{for(var e=this.t;e!==void 0;e=e.x)e.t.N()}finally{lt()}}}});function A(t,e){return new O(t,e)}function On(t){for(var e=t.s;e!==void 0;e=e.n)if(e.S.i!==e.i||!e.S.h()||e.S.i!==e.i)return!0;return!1}function Hn(t){for(var e=t.s;e!==void 0;e=e.n){var n=e.S.n;if(n!==void 0&&(e.r=n),e.S.n=e,e.i=-1,e.n===void 0){t.s=e;break}}}function Un(t){for(var e=t.s,n=void 0;e!==void 0;){var i=e.p;e.i===-1?(e.S.U(e),i!==void 0&&(i.n=e.n),e.n!==void 0&&(e.n.p=i)):n=e,e.S.n=e.r,e.r!==void 0&&(e.r=void 0),e=i}t.s=n}function he(t,e){O.call(this,void 0),this.x=t,this.s=void 0,this.g=et-1,this.f=4,this.W=e==null?void 0:e.watched,this.Z=e==null?void 0:e.unwatched,this.name=e==null?void 0:e.name}he.prototype=new O;he.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===et))return!0;if(this.g=et,this.f|=1,this.i>0&&!On(this))return this.f&=-2,!0;var t=$;try{Hn(this),$=this;var e=this.x();(16&this.f||this.v!==e||this.i===0)&&(this.v=e,this.f&=-17,this.i++)}catch(n){this.v=n,this.f|=16,this.i++}return $=t,Un(this),this.f&=-2,!0};he.prototype.S=function(t){if(this.t===void 0){this.f|=36;for(var e=this.s;e!==void 0;e=e.n)e.S.S(e)}O.prototype.S.call(this,t)};he.prototype.U=function(t){if(this.t!==void 0&&(O.prototype.U.call(this,t),this.t===void 0)){this.f&=-33;for(var e=this.s;e!==void 0;e=e.n)e.S.U(e)}};he.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var t=this.t;t!==void 0;t=t.x)t.t.N()}};Object.defineProperty(he.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var t=Nn(this);if(this.h(),t!==void 0&&(t.i=this.i),16&this.f)throw this.v;return this.v}});function hn(t,e){return new he(t,e)}function jn(t){var e=t.u;if(t.u=void 0,typeof e=="function"){te++;var n=$;$=void 0;try{e()}catch(i){throw t.f&=-2,t.f|=8,Ot(t),i}finally{$=n,lt()}}}function Ot(t){for(var e=t.s;e!==void 0;e=e.n)e.S.U(e);t.x=void 0,t.s=void 0,jn(t)}function Hi(t){if($!==this)throw new Error("Out-of-order effect");Un(this),$=t,this.f&=-2,8&this.f&&Ot(this),lt()}function me(t,e){this.x=t,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32,this.name=e==null?void 0:e.name}me.prototype.c=function(){var t=this.S();try{if(8&this.f||this.x===void 0)return;var e=this.x();typeof e=="function"&&(this.u=e)}finally{t()}};me.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,jn(this),Hn(this),te++;var t=$;return $=this,Hi.bind(this,t)};me.prototype.N=function(){2&this.f||(this.f|=2,this.o=Ie,Ie=this)};me.prototype.d=function(){this.f|=8,1&this.f||Ot(this)};me.prototype.dispose=function(){this.d()};function ze(t,e){var n=new me(t,e);try{n.c()}catch(r){throw n.d(),r}var i=n.d.bind(n);return i[Symbol.dispose]=i,i}var qn,Ue,Ui=typeof window<"u"&&!!window.__PREACT_SIGNALS_DEVTOOLS__,Fn=[];ze(function(){qn=this.N})();function ye(t,e){C[t]=e.bind(null,C[t]||function(){})}function tt(t){if(Ue){var e=Ue;Ue=void 0,e()}Ue=t&&t.S()}function Zn(t){var e=this,n=t.data,i=qi(n);i.value=n;var r=Nt(function(){for(var a=e,h=e.__v;h=h.__;)if(h.__c){h.__c.__$f|=4;break}var o=hn(function(){var _=i.value.value;return _===0?0:_===!0?"":_||""}),u=hn(function(){return!Array.isArray(o.value)&&!Sn(o.value)}),d=ze(function(){if(this.N=Wn,u.value){var _=o.value;a.__v&&a.__v.__e&&a.__v.__e.nodeType===3&&(a.__v.__e.data=_)}}),p=e.__$u.d;return e.__$u.d=function(){d(),p.call(this)},[u,o]},[]),s=r[0],c=r[1];return s.value?c.peek():c.value}Zn.displayName="ReactiveTextNode";Object.defineProperties(O.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:Zn},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});ye("__b",function(t,e){if(typeof e.type=="string"){var n,i=e.props;for(var r in i)if(r!=="children"){var s=i[r];s instanceof O&&(n||(e.__np=n={}),n[r]=s,i[r]=s.peek())}}t(e)});ye("__r",function(t,e){if(t(e),e.type!==ae){tt();var n,i=e.__c;i&&(i.__$f&=-2,(n=i.__$u)===void 0&&(i.__$u=n=(function(r,s){var c;return ze(function(){c=this},{name:s}),c.c=r,c})(function(){var r;Ui&&((r=n.y)==null||r.call(n)),i.__$f|=1,i.setState({})},typeof e.type=="function"?e.type.displayName||e.type.name:""))),tt(n)}});ye("__e",function(t,e,n,i){tt(),t(e,n,i)});ye("diffed",function(t,e){tt();var n;if(typeof e.type=="string"&&(n=e.__e)){var i=e.__np,r=e.props;if(i){var s=n.U;if(s)for(var c in s){var a=s[c];a!==void 0&&!(c in i)&&(a.d(),s[c]=void 0)}else s={},n.U=s;for(var h in i){var o=s[h],u=i[h];o===void 0?(o=ji(n,h,u),s[h]=o):o.o(u,r)}for(var d in i)r[d]=i[d]}}t(e)});function ji(t,e,n,i){var r=e in t&&t.ownerSVGElement===void 0,s=A(n),c=n.peek();return{o:function(a,h){s.value=a,c=a.peek()},d:ze(function(){this.N=Wn;var a=s.value.value;c!==a?(c=void 0,r?t[e]=a:a!=null&&(a!==!1||e[4]==="-")?t.setAttribute(e,a):t.removeAttribute(e)):c=void 0})}}ye("unmount",function(t,e){if(typeof e.type=="string"){var n=e.__e;if(n){var i=n.U;if(i){n.U=void 0;for(var r in i){var s=i[r];s&&s.d()}}}e.__np=void 0}else{var c=e.__c;if(c){var a=c.__$u;a&&(c.__$u=void 0,a.d())}}t(e)});ye("__h",function(t,e,n,i){(i<3||i===9)&&(e.__$f|=2),t(e,n,i)});Ce.prototype.shouldComponentUpdate=function(t,e){if(this.__R)return!0;var n=this.__$u,i=n&&n.s!==void 0;for(var r in e)return!0;if(this.__f||typeof this.u=="boolean"&&this.u===!0){var s=2&this.__$f;if(!(i||s||4&this.__$f)||1&this.__$f)return!0}else if(!(i||4&this.__$f)||3&this.__$f)return!0;for(var c in t)if(c!=="__source"&&t[c]!==this.props[c])return!0;for(var a in this.props)if(!(a in t))return!0;return!1};function qi(t,e){return Nt(function(){return A(t,e)},[])}var Fi=function(t){queueMicrotask(function(){queueMicrotask(t)})};function Zi(){Oi(function(){for(var t;t=Fn.shift();)qn.call(t)})}function Wn(){Fn.push(this)===1&&(C.requestAnimationFrame||Fi)(Zi)}const Wi=["chats","tasks","usage"];function Gn(){const t=window.location.hash.replace(/^#\/?/,""),[e,...n]=t.split("/"),i=Wi.includes(e)?e:"chats",r=n.join("/")||null;return{name:i,param:r}}const Ee=A(Gn());function Me(t,e){const n=e?`/${t}/${e}`:`/${t}`;window.location.hash=n}window.addEventListener("hashchange",()=>{Ee.value=Gn()});function Vn(t){const e=Object.entries(t).filter(([,n])=>n).map(([n,i])=>`${encodeURIComponent(n)}=${encodeURIComponent(i)}`);return e.length?`?${e.join("&")}`:""}async function Gi(){return(await fetch("/api/sessions")).json()}async function Vi(){try{return await(await fetch("/api/personas")).json()}catch{return[]}}async function Ki(t){const e=await fetch("/api/personas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){const n=await e.json();throw new Error(n.error)}return e.json()}async function Ji(t,e){const n=await fetch(`/api/personas/${encodeURIComponent(t)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){const i=await n.json();throw new Error(i.error)}return n.json()}async function Qi(t){const e=await fetch(`/api/personas/${encodeURIComponent(t)}`,{method:"DELETE"});if(!e.ok){const n=await e.json();throw new Error(n.error)}}async function Xi(t){return(await fetch("/api/personas/generate-prompt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}async function Yi(){try{return await(await fetch("/api/model-tiers")).json()}catch{return["default"]}}async function er(t){return(await fetch(`/api/usage/summary${Vn(t)}`)).json()}async function $e(t){return(await fetch(`/api/usage/daily${Vn(t)}`)).json()}async function tr(){return(await fetch("/api/usage/filters")).json()}async function nr(){return(await fetch("/api/tasks")).json()}async function ir(t){return(await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}async function Kn(t,e){await fetch(`/api/tasks/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}async function Jn(t){await fetch(`/api/tasks/${t}`,{method:"DELETE"})}async function Qn(t,e){await fetch(`/api/tasks/${t}/move`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e})})}async function Xn(t,e){await fetch(`/api/tasks/${t}/assign`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({assignee:e})})}const E=A([]),q=A(null),le=A({}),Yn="patina-sessions";function rr(){const t=localStorage.getItem("patina-session"),e=localStorage.getItem(Yn);if(e)try{E.value=JSON.parse(e)}catch{E.value=[]}else t&&(E.value=[{id:t,title:"Chat",updatedAt:new Date().toISOString()}],localStorage.removeItem("patina-session"));ke()}function ke(){localStorage.setItem(Yn,JSON.stringify(E.value))}function ct(t){return E.value.find(e=>e.id===t)||null}function ei(t){E.value=[t,...E.value],ke()}function ti(t){E.value=E.value.filter(n=>n.id!==t);const e={...le.value};delete e[t],le.value=e,ke()}function ni(t,e){const n=ct(t);n&&n.title==="New Chat"&&(n.title=e.length>50?e.substring(0,50)+"...":e,E.value=[...E.value],ke())}function xt(t){const e=ct(t);e&&(e.updatedAt=new Date().toISOString(),E.value=[...E.value],ke())}function dn(t){le.value={...le.value,[t]:!0}}function sr(t){const e={...le.value};delete e[t],le.value=e}function ii(t){const e=ct(t);return(e==null?void 0:e.persona)||null}function or(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}async function ar(){try{const t=await Gi(),e={},n=E.value;for(const i of t){e[i.key]=!0;const r=n.find(s=>s.id===i.key);r?(i.title&&i.title!==r.title&&(r.title=i.title),i.persona&&(r.persona=i.persona)):n.push({id:i.key,title:i.title||i.key.slice(0,8),updatedAt:i.updated_at||new Date().toISOString(),persona:i.persona||null})}E.value=[...n],ke()}catch{}}const ce=A([]),Ne=A(""),be=A(!1),_e=A(!1),ie=A(!1);function Ve(t,e){ce.value=[...ce.value,{role:t,content:e}]}function Ae(){ce.value=[],Ne.value="",be.value=!1,ie.value=!1}function lr(t){ce.value=t}function cr(){be.value=!0,Ne.value="",ie.value=!1}function ur(t){be.value||cr(),ie.value=!1,Ne.value+=t}function hr(t){be.value=!1,Ne.value="",_e.value=!1,ce.value=[...ce.value,{role:"assistant",content:t}]}const fe=A("disconnected"),Te=A("disconnected");let Z=null,je=1e3;const St=A(null),W=A([]),nt=A(""),Re=A(!1);function ne(t){Z&&Z.readyState===WebSocket.OPEN&&Z.send(JSON.stringify(t))}function Ht(){if(Z)return;fe.value="reconnecting",Te.value="connecting...";let e=`${location.protocol==="https:"?"wss:":"ws:"}//${location.host}/ws`;const n=localStorage.getItem("patina-password");n&&(e+=`?password=${encodeURIComponent(n)}`),Z=new WebSocket(e),Z.onopen=()=>{fe.value="connected",Te.value="connected",je=1e3;const i=q.value;i&&ne({type:"get_history",chatId:i})},Z.onmessage=i=>{let r;try{r=JSON.parse(i.data)}catch{return}dr(r)},Z.onclose=i=>{if(Z=null,ie.value=!1,i.code===4001){fe.value="disconnected",Te.value="auth failed",ri();return}fe.value="disconnected",Te.value="disconnected",setTimeout(Ht,je),je=Math.min(je*2,3e4)},Z.onerror=()=>{}}function dr(t){var i,r;const e=q.value,n=St.value;switch(t.type){case"connected":break;case"history":t.chatId===e&&((i=t.messages)!=null&&i.length)&&(Ae(),lr(t.messages));break;case"text_delta":t.chatId===n&&t.content?(Re.value=!0,nt.value+=t.content):t.chatId===e&&t.content&&ur(t.content);break;case"message":if(t.chatId===n){Re.value?(Re.value=!1,W.value=[...W.value,{role:"assistant",content:t.content}],nt.value=""):W.value=[...W.value,{role:"assistant",content:t.content}];break}_e.value=!1,t.chatId===e?be.value?hr(t.content):Ve("assistant",t.content):t.chatId&&dn(t.chatId),t.chatId&&xt(t.chatId);break;case"user_message":t.chatId===n?W.value=[...W.value,{role:"user",content:t.content}]:t.chatId===e&&Ve("user",t.content),t.chatId&&(ni(t.chatId,t.content),xt(t.chatId),t.chatId!==e&&dn(t.chatId));break;case"thinking":t.chatId===n||t.chatId===e&&(ie.value=!0);break;case"session_created":t.chatId&&!ct(t.chatId)&&ei({id:t.chatId,title:"New Chat",updatedAt:t.timestamp||new Date().toISOString(),persona:t.content||null});break;case"session_deleted":t.chatId&&(ti(t.chatId),t.chatId===e&&(E.value.length>0?q.value=E.value[0].id:(q.value=null,Ae())));break;case"task_history":t.chatId===n&&(W.value=t.messages||[]);break;case"error":(r=t.content)!=null&&r.includes("Authentication")&&ri(),Ve("system",t.content||"Unknown error");break}}function ri(){const t=prompt("Enter password:");t!==null&&(localStorage.setItem("patina-password",t),Z&&(Z.close(),Z=null),Ht())}const pr="_header_ps8v4_1",fr="_hamburger_ps8v4_12",_r="_brand_ps8v4_23",gr="_nav_ps8v4_30",vr="_navTab_ps8v4_36",mr="_navTabActive_ps8v4_55 _navTab_ps8v4_36",yr="_actions_ps8v4_61",re={header:pr,hamburger:fr,brand:_r,nav:gr,navTab:vr,navTabActive:mr,actions:yr},kr=[{key:"chats",label:"Chats"},{key:"tasks",label:"Tasks"},{key:"usage",label:"Usage"}];function br({onToggleSidebar:t,showSidebarToggle:e,children:n}){const i=Ee.value.name,r=fe.value,s=Te.value;return l("header",{class:re.header,children:[e&&l("button",{class:re.hamburger,title:"Toggle sidebar",onClick:t,children:"☰"}),l("span",{class:re.brand,children:"Patina"}),l("nav",{class:re.nav,children:kr.map(c=>l("button",{class:c.key===i?re.navTabActive:re.navTab,onClick:()=>Me(c.key),children:c.label},c.key))}),n&&l("div",{class:re.actions,children:n}),l("span",{class:`status ${r}`,children:s})]})}const Y=A([]),si=A(["default"]);async function Ut(){Y.value=await Vi()}async function wr(){si.value=await Yi()}function xr(t){return Y.value.find(e=>e.key===t)||null}const Sr=["#e74c3c","#e67e22","#f1c40f","#2ecc71","#1abc9c","#3498db","#9b59b6","#e91e63","#795548","#607d8b"],$r="_sidebar_1v6to_1",Tr="_header_1v6to_12",Cr="_title_1v6to_21",Ir="_actions_1v6to_26",Ar="_iconBtn_1v6to_31",Rr="_newChatBtn_1v6to_50 _iconBtn_1v6to_31",Pr="_sessionList_1v6to_56",Lr="_sessionItem_1v6to_62",Dr="_active_1v6to_78",Er="_avatar_1v6to_82",Mr="_content_1v6to_96",Br="_unreadDot_1v6to_111",zr="_time_1v6to_119",Nr="_deleteBtn_1v6to_125",H={sidebar:$r,header:Tr,title:Cr,actions:Ir,iconBtn:Ar,newChatBtn:Rr,sessionList:Pr,sessionItem:Lr,active:Dr,avatar:Er,content:Mr,unreadDot:Br,time:zr,deleteBtn:Nr};function Or(t){try{const e=new Date(t),n=new Date;return e.toDateString()===n.toDateString()?e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):e.toLocaleDateString([],{month:"short",day:"numeric"})}catch{return""}}function Hr(t,e){return!t.persona||!e.length?null:e.find(n=>n.key===t.persona)||null}function Ur({onNewChat:t,onSwitchChat:e,onDeleteChat:n,onManagePersonas:i,sidebarHidden:r}){const s=E.value,c=q.value,a=le.value,h=Y.value;return r?null:l("aside",{class:H.sidebar,children:[l("div",{class:H.header,children:[l("h2",{class:H.title,children:"Chats"}),l("div",{class:H.actions,children:[l("button",{class:H.iconBtn,title:"Manage Personas",onClick:i,children:"⚙"}),l("button",{class:H.newChatBtn,title:"New Chat",onClick:t,children:"+"})]})]}),l("div",{class:H.sessionList,children:s.map(o=>{const u=Hr(o,h),d=o.id===c;return l("div",{class:`${H.sessionItem}${d?` ${H.active}`:""}`,onClick:()=>e(o.id),children:[l("div",{class:H.avatar,style:{background:(u==null?void 0:u.color)||"#888"},children:u!=null&&u.name?u.name.charAt(0):"P"}),l("div",{class:H.content,children:[l("div",{class:H.title,children:[a[o.id]&&l("span",{class:H.unreadDot}),l("span",{children:o.title||"New Chat"})]}),o.updatedAt&&l("div",{class:H.time,children:Or(o.updatedAt)})]}),l("button",{class:H.deleteBtn,title:"Delete chat",onClick:p=>{p.stopPropagation(),confirm("Delete this chat?")&&n(o.id)},children:"×"})]},o.id)})})]})}function jt(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var de=jt();function oi(t){de=t}var Pe={exec:()=>null};function I(t,e=""){let n=typeof t=="string"?t:t.source;const i={replace:(r,s)=>{let c=typeof s=="string"?s:s.source;return c=c.replace(U.caret,"$1"),n=n.replace(r,c),i},getRegex:()=>new RegExp(n,e)};return i}var U={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},jr=/^(?:[ \t]*(?:\n|$))+/,qr=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Fr=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,Oe=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Zr=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,qt=/(?:[*+-]|\d{1,9}[.)])/,ai=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,li=I(ai).replace(/bull/g,qt).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Wr=I(ai).replace(/bull/g,qt).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Ft=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Gr=/^[^\n]+/,Zt=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Vr=I(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Zt).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Kr=I(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,qt).getRegex(),ut="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Wt=/\x3C!--(?:-?>|[\s\S]*?(?:-->|$))/,Jr=I("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Wt).replace("tag",ut).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),ci=I(Ft).replace("hr",Oe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ut).getRegex(),Qr=I(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",ci).getRegex(),Gt={blockquote:Qr,code:qr,def:Vr,fences:Fr,heading:Zr,hr:Oe,html:Jr,lheading:li,list:Kr,newline:jr,paragraph:ci,table:Pe,text:Gr},pn=I("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",Oe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ut).getRegex(),Xr={...Gt,lheading:Wr,table:pn,paragraph:I(Ft).replace("hr",Oe).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",pn).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ut).getRegex()},Yr={...Gt,html:I(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Wt).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Pe,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:I(Ft).replace("hr",Oe).replace("heading",` *#{1,6} *[^
]`).replace("lheading",li).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},es=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,ts=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ui=/^( {2,}|\\)\n(?!\s*$)/,ns=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,ht=/[\p{P}\p{S}]/u,Vt=/[\s\p{P}\p{S}]/u,hi=/[^\s\p{P}\p{S}]/u,is=I(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Vt).getRegex(),di=/(?!~)[\p{P}\p{S}]/u,rs=/(?!~)[\s\p{P}\p{S}]/u,ss=/(?:[^\s\p{P}\p{S}]|~)/u,os=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,pi=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,as=I(pi,"u").replace(/punct/g,ht).getRegex(),ls=I(pi,"u").replace(/punct/g,di).getRegex(),fi="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",cs=I(fi,"gu").replace(/notPunctSpace/g,hi).replace(/punctSpace/g,Vt).replace(/punct/g,ht).getRegex(),us=I(fi,"gu").replace(/notPunctSpace/g,ss).replace(/punctSpace/g,rs).replace(/punct/g,di).getRegex(),hs=I("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,hi).replace(/punctSpace/g,Vt).replace(/punct/g,ht).getRegex(),ds=I(/\\(punct)/,"gu").replace(/punct/g,ht).getRegex(),ps=I(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),fs=I(Wt).replace("(?:-->|$)","-->").getRegex(),_s=I("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",fs).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),it=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,gs=I(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",it).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),_i=I(/^!?\[(label)\]\[(ref)\]/).replace("label",it).replace("ref",Zt).getRegex(),gi=I(/^!?\[(ref)\](?:\[\])?/).replace("ref",Zt).getRegex(),vs=I("reflink|nolink(?!\\()","g").replace("reflink",_i).replace("nolink",gi).getRegex(),Kt={_backpedal:Pe,anyPunctuation:ds,autolink:ps,blockSkip:os,br:ui,code:ts,del:Pe,emStrongLDelim:as,emStrongRDelimAst:cs,emStrongRDelimUnd:hs,escape:es,link:gs,nolink:gi,punctuation:is,reflink:_i,reflinkSearch:vs,tag:_s,text:ns,url:Pe},ms={...Kt,link:I(/^!?\[(label)\]\((.*?)\)/).replace("label",it).getRegex(),reflink:I(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",it).getRegex()},$t={...Kt,emStrongRDelimAst:us,emStrongLDelim:ls,url:I(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},ys={...$t,br:I(ui).replace("{2,}","*").getRegex(),text:I($t.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},qe={normal:Gt,gfm:Xr,pedantic:Yr},we={normal:Kt,gfm:$t,breaks:ys,pedantic:ms},ks={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},fn=t=>ks[t];function G(t,e){if(e){if(U.escapeTest.test(t))return t.replace(U.escapeReplace,fn)}else if(U.escapeTestNoEncode.test(t))return t.replace(U.escapeReplaceNoEncode,fn);return t}function _n(t){try{t=encodeURI(t).replace(U.percentDecode,"%")}catch{return null}return t}function gn(t,e){var s;const n=t.replace(U.findPipe,(c,a,h)=>{let o=!1,u=a;for(;--u>=0&&h[u]==="\\";)o=!o;return o?"|":" |"}),i=n.split(U.splitPipe);let r=0;if(i[0].trim()||i.shift(),i.length>0&&!((s=i.at(-1))!=null&&s.trim())&&i.pop(),e)if(i.length>e)i.splice(e);else for(;i.length<e;)i.push("");for(;r<i.length;r++)i[r]=i[r].trim().replace(U.slashPipe,"|");return i}function xe(t,e,n){const i=t.length;if(i===0)return"";let r=0;for(;r<i&&t.charAt(i-r-1)===e;)r++;return t.slice(0,i-r)}function bs(t,e){if(t.indexOf(e[1])===-1)return-1;let n=0;for(let i=0;i<t.length;i++)if(t[i]==="\\")i++;else if(t[i]===e[0])n++;else if(t[i]===e[1]&&(n--,n<0))return i;return n>0?-2:-1}function vn(t,e,n,i,r){const s=e.href,c=e.title||null,a=t[1].replace(r.other.outputLinkReplace,"$1");i.state.inLink=!0;const h={type:t[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:c,text:a,tokens:i.inlineTokens(a)};return i.state.inLink=!1,h}function ws(t,e,n){const i=t.match(n.other.indentCodeCompensation);if(i===null)return e;const r=i[1];return e.split(`
`).map(s=>{const c=s.match(n.other.beginningSpace);if(c===null)return s;const[a]=c;return a.length>=r.length?s.slice(r.length):s}).join(`
`)}var rt=class{constructor(t){R(this,"options");R(this,"rules");R(this,"lexer");this.options=t||de}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const n=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:xe(n,`
`)}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const n=e[0],i=ws(n,e[3]||"",this.rules);return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:i}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(this.rules.other.endingHash.test(n)){const i=xe(n,"#");(this.options.pedantic||!i||this.rules.other.endingSpaceChar.test(i))&&(n=i.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:xe(e[0],`
`)}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){let n=xe(e[0],`
`).split(`
`),i="",r="";const s=[];for(;n.length>0;){let c=!1;const a=[];let h;for(h=0;h<n.length;h++)if(this.rules.other.blockquoteStart.test(n[h]))a.push(n[h]),c=!0;else if(!c)a.push(n[h]);else break;n=n.slice(h);const o=a.join(`
`),u=o.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");i=i?`${i}
${o}`:o,r=r?`${r}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,s,!0),this.lexer.state.top=d,n.length===0)break;const p=s.at(-1);if((p==null?void 0:p.type)==="code")break;if((p==null?void 0:p.type)==="blockquote"){const _=p,f=_.raw+`
`+n.join(`
`),g=this.blockquote(f);s[s.length-1]=g,i=i.substring(0,i.length-_.raw.length)+g.raw,r=r.substring(0,r.length-_.text.length)+g.text;break}else if((p==null?void 0:p.type)==="list"){const _=p,f=_.raw+`
`+n.join(`
`),g=this.list(f);s[s.length-1]=g,i=i.substring(0,i.length-p.raw.length)+g.raw,r=r.substring(0,r.length-_.raw.length)+g.raw,n=f.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:i,tokens:s,text:r}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n=e[1].trim();const i=n.length>1,r={type:"list",raw:"",ordered:i,start:i?+n.slice(0,-1):"",loose:!1,items:[]};n=i?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=i?n:"[*+-]");const s=this.rules.other.listItemRegex(n);let c=!1;for(;t;){let h=!1,o="",u="";if(!(e=s.exec(t))||this.rules.block.hr.test(t))break;o=e[0],t=t.substring(o.length);let d=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,y=>" ".repeat(3*y.length)),p=t.split(`
`,1)[0],_=!d.trim(),f=0;if(this.options.pedantic?(f=2,u=d.trimStart()):_?f=e[1].length+1:(f=e[2].search(this.rules.other.nonSpaceChar),f=f>4?1:f,u=d.slice(f),f+=e[1].length),_&&this.rules.other.blankLine.test(p)&&(o+=p+`
`,t=t.substring(p.length+1),h=!0),!h){const y=this.rules.other.nextBulletRegex(f),m=this.rules.other.hrRegex(f),L=this.rules.other.fencesBeginRegex(f),k=this.rules.other.headingBeginRegex(f),b=this.rules.other.htmlBeginRegex(f);for(;t;){const P=t.split(`
`,1)[0];let D;if(p=P,this.options.pedantic?(p=p.replace(this.rules.other.listReplaceNesting,"  "),D=p):D=p.replace(this.rules.other.tabCharGlobal,"    "),L.test(p)||k.test(p)||b.test(p)||y.test(p)||m.test(p))break;if(D.search(this.rules.other.nonSpaceChar)>=f||!p.trim())u+=`
`+D.slice(f);else{if(_||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||L.test(d)||k.test(d)||m.test(d))break;u+=`
`+p}!_&&!p.trim()&&(_=!0),o+=P+`
`,t=t.substring(P.length+1),d=D.slice(f)}}r.loose||(c?r.loose=!0:this.rules.other.doubleBlankLine.test(o)&&(c=!0));let g=null,v;this.options.gfm&&(g=this.rules.other.listIsTask.exec(u),g&&(v=g[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),r.items.push({type:"list_item",raw:o,task:!!g,checked:v,loose:!1,text:u,tokens:[]}),r.raw+=o}const a=r.items.at(-1);if(a)a.raw=a.raw.trimEnd(),a.text=a.text.trimEnd();else return;r.raw=r.raw.trimEnd();for(let h=0;h<r.items.length;h++)if(this.lexer.state.top=!1,r.items[h].tokens=this.lexer.blockTokens(r.items[h].text,[]),!r.loose){const o=r.items[h].tokens.filter(d=>d.type==="space"),u=o.length>0&&o.some(d=>this.rules.other.anyLine.test(d.raw));r.loose=u}if(r.loose)for(let h=0;h<r.items.length;h++)r.items[h].loose=!0;return r}}html(t){const e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(t){const e=this.rules.block.def.exec(t);if(e){const n=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),i=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:i,title:r}}}table(t){var c;const e=this.rules.block.table.exec(t);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;const n=gn(e[1]),i=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),r=(c=e[3])!=null&&c.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(n.length===i.length){for(const a of i)this.rules.other.tableAlignRight.test(a)?s.align.push("right"):this.rules.other.tableAlignCenter.test(a)?s.align.push("center"):this.rules.other.tableAlignLeft.test(a)?s.align.push("left"):s.align.push(null);for(let a=0;a<n.length;a++)s.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:!0,align:s.align[a]});for(const a of r)s.rows.push(gn(a,s.header.length).map((h,o)=>({text:h,tokens:this.lexer.inline(h),header:!1,align:s.align[o]})));return s}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const n=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}}text(t){const e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const n=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const s=xe(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{const s=bs(e[2],"()");if(s===-2)return;if(s>-1){const a=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let i=e[2],r="";if(this.options.pedantic){const s=this.rules.other.pedanticHrefTitle.exec(i);s&&(i=s[1],r=s[3])}else r=e[3]?e[3].slice(1,-1):"";return i=i.trim(),this.rules.other.startAngleBracket.test(i)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?i=i.slice(1):i=i.slice(1,-1)),vn(e,{href:i&&i.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){const i=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),r=e[i.toLowerCase()];if(!r){const s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return vn(n,r,n[0],this.lexer,this.rules)}}emStrong(t,e,n=""){let i=this.rules.inline.emStrongLDelim.exec(t);if(!i||i[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(i[1]||i[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const s=[...i[0]].length-1;let c,a,h=s,o=0;const u=i[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,e=e.slice(-1*t.length+s);(i=u.exec(e))!=null;){if(c=i[1]||i[2]||i[3]||i[4]||i[5]||i[6],!c)continue;if(a=[...c].length,i[3]||i[4]){h+=a;continue}else if((i[5]||i[6])&&s%3&&!((s+a)%3)){o+=a;continue}if(h-=a,h>0)continue;a=Math.min(a,a+h+o);const d=[...i[0]][0].length,p=t.slice(0,s+i.index+d+a);if(Math.min(s,a)%2){const f=p.slice(1,-1);return{type:"em",raw:p,text:f,tokens:this.lexer.inlineTokens(f)}}const _=p.slice(2,-2);return{type:"strong",raw:p,text:_,tokens:this.lexer.inlineTokens(_)}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(this.rules.other.newLineCharGlobal," ");const i=this.rules.other.nonSpaceChar.test(n),r=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return i&&r&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:e[0],text:n}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(t){const e=this.rules.inline.autolink.exec(t);if(e){let n,i;return e[2]==="@"?(n=e[1],i="mailto:"+n):(n=e[1],i=n),{type:"link",raw:e[0],text:n,href:i,tokens:[{type:"text",raw:n,text:n}]}}}url(t){var n;let e;if(e=this.rules.inline.url.exec(t)){let i,r;if(e[2]==="@")i=e[0],r="mailto:"+i;else{let s;do s=e[0],e[0]=((n=this.rules.inline._backpedal.exec(e[0]))==null?void 0:n[0])??"";while(s!==e[0]);i=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:i,href:r,tokens:[{type:"text",raw:i,text:i}]}}}inlineText(t){const e=this.rules.inline.text.exec(t);if(e){const n=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:n}}}},J=class Tt{constructor(e){R(this,"tokens");R(this,"options");R(this,"state");R(this,"tokenizer");R(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||de,this.options.tokenizer=this.options.tokenizer||new rt,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:U,block:qe.normal,inline:we.normal};this.options.pedantic?(n.block=qe.pedantic,n.inline=we.pedantic):this.options.gfm&&(n.block=qe.gfm,this.options.breaks?n.inline=we.breaks:n.inline=we.gfm),this.tokenizer.rules=n}static get rules(){return{block:qe,inline:we}}static lex(e,n){return new Tt(n).lex(e)}static lexInline(e,n){return new Tt(n).inlineTokens(e)}lex(e){e=e.replace(U.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const i=this.inlineQueue[n];this.inlineTokens(i.src,i.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,n=[],i=!1){var r,s,c;for(this.options.pedantic&&(e=e.replace(U.tabCharGlobal,"    ").replace(U.spaceLine,""));e;){let a;if((s=(r=this.options.extensions)==null?void 0:r.block)!=null&&s.some(o=>(a=o.call({lexer:this},e,n))?(e=e.substring(a.raw.length),n.push(a),!0):!1))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);const o=n.at(-1);a.raw.length===1&&o!==void 0?o.raw+=`
`:n.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);const o=n.at(-1);(o==null?void 0:o.type)==="paragraph"||(o==null?void 0:o.type)==="text"?(o.raw+=`
`+a.raw,o.text+=`
`+a.text,this.inlineQueue.at(-1).src=o.text):n.push(a);continue}if(a=this.tokenizer.fences(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.heading(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.hr(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.blockquote(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.list(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.html(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);const o=n.at(-1);(o==null?void 0:o.type)==="paragraph"||(o==null?void 0:o.type)==="text"?(o.raw+=`
`+a.raw,o.text+=`
`+a.raw,this.inlineQueue.at(-1).src=o.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title});continue}if(a=this.tokenizer.table(e)){e=e.substring(a.raw.length),n.push(a);continue}if(a=this.tokenizer.lheading(e)){e=e.substring(a.raw.length),n.push(a);continue}let h=e;if((c=this.options.extensions)!=null&&c.startBlock){let o=1/0;const u=e.slice(1);let d;this.options.extensions.startBlock.forEach(p=>{d=p.call({lexer:this},u),typeof d=="number"&&d>=0&&(o=Math.min(o,d))}),o<1/0&&o>=0&&(h=e.substring(0,o+1))}if(this.state.top&&(a=this.tokenizer.paragraph(h))){const o=n.at(-1);i&&(o==null?void 0:o.type)==="paragraph"?(o.raw+=`
`+a.raw,o.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):n.push(a),i=h.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);const o=n.at(-1);(o==null?void 0:o.type)==="text"?(o.raw+=`
`+a.raw,o.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=o.text):n.push(a);continue}if(e){const o="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(o);break}else throw new Error(o)}}return this.state.top=!0,n}inline(e,n=[]){return this.inlineQueue.push({src:e,tokens:n}),n}inlineTokens(e,n=[]){var a,h,o;let i=e,r=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)u.includes(r[0].slice(r[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,r.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(r=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,r.index)+"["+"a".repeat(r[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,c="";for(;e;){s||(c=""),s=!1;let u;if((h=(a=this.options.extensions)==null?void 0:a.inline)!=null&&h.some(p=>(u=p.call({lexer:this},e,n))?(e=e.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(u.raw.length);const p=n.at(-1);u.type==="text"&&(p==null?void 0:p.type)==="text"?(p.raw+=u.raw,p.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(e,i,c)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(e)){e=e.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(e)){e=e.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(e))){e=e.substring(u.raw.length),n.push(u);continue}let d=e;if((o=this.options.extensions)!=null&&o.startInline){let p=1/0;const _=e.slice(1);let f;this.options.extensions.startInline.forEach(g=>{f=g.call({lexer:this},_),typeof f=="number"&&f>=0&&(p=Math.min(p,f))}),p<1/0&&p>=0&&(d=e.substring(0,p+1))}if(u=this.tokenizer.inlineText(d)){e=e.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(c=u.raw.slice(-1)),s=!0;const p=n.at(-1);(p==null?void 0:p.type)==="text"?(p.raw+=u.raw,p.text+=u.text):n.push(u);continue}if(e){const p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return n}},Be=class{constructor(t){R(this,"options");R(this,"parser");this.options=t||de}space(t){return""}code({text:t,lang:e,escaped:n}){var s;const i=(s=(e||"").match(U.notSpaceStart))==null?void 0:s[0],r=t.replace(U.endingNewline,"")+`
`;return i?'<pre><code class="language-'+G(i)+'">'+(n?r:G(r,!0))+`</code></pre>
`:"<pre><code>"+(n?r:G(r,!0))+`</code></pre>
`}blockquote({tokens:t}){return`<blockquote>
${this.parser.parse(t)}</blockquote>
`}html({text:t}){return t}heading({tokens:t,depth:e}){return`<h${e}>${this.parser.parseInline(t)}</h${e}>
`}hr(t){return`<hr>
`}list(t){const e=t.ordered,n=t.start;let i="";for(let c=0;c<t.items.length;c++){const a=t.items[c];i+=this.listitem(a)}const r=e?"ol":"ul",s=e&&n!==1?' start="'+n+'"':"";return"<"+r+s+`>
`+i+"</"+r+`>
`}listitem(t){var n;let e="";if(t.task){const i=this.checkbox({checked:!!t.checked});t.loose?((n=t.tokens[0])==null?void 0:n.type)==="paragraph"?(t.tokens[0].text=i+" "+t.tokens[0].text,t.tokens[0].tokens&&t.tokens[0].tokens.length>0&&t.tokens[0].tokens[0].type==="text"&&(t.tokens[0].tokens[0].text=i+" "+G(t.tokens[0].tokens[0].text),t.tokens[0].tokens[0].escaped=!0)):t.tokens.unshift({type:"text",raw:i+" ",text:i+" ",escaped:!0}):e+=i+" "}return e+=this.parser.parse(t.tokens,!!t.loose),`<li>${e}</li>
`}checkbox({checked:t}){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:t}){return`<p>${this.parser.parseInline(t)}</p>
`}table(t){let e="",n="";for(let r=0;r<t.header.length;r++)n+=this.tablecell(t.header[r]);e+=this.tablerow({text:n});let i="";for(let r=0;r<t.rows.length;r++){const s=t.rows[r];n="";for(let c=0;c<s.length;c++)n+=this.tablecell(s[c]);i+=this.tablerow({text:n})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+i+`</table>
`}tablerow({text:t}){return`<tr>
${t}</tr>
`}tablecell(t){const e=this.parser.parseInline(t.tokens),n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong({tokens:t}){return`<strong>${this.parser.parseInline(t)}</strong>`}em({tokens:t}){return`<em>${this.parser.parseInline(t)}</em>`}codespan({text:t}){return`<code>${G(t,!0)}</code>`}br(t){return"<br>"}del({tokens:t}){return`<del>${this.parser.parseInline(t)}</del>`}link({href:t,title:e,tokens:n}){const i=this.parser.parseInline(n),r=_n(t);if(r===null)return i;t=r;let s='<a href="'+t+'"';return e&&(s+=' title="'+G(e)+'"'),s+=">"+i+"</a>",s}image({href:t,title:e,text:n,tokens:i}){i&&(n=this.parser.parseInline(i,this.parser.textRenderer));const r=_n(t);if(r===null)return G(n);t=r;let s=`<img src="${t}" alt="${n}"`;return e&&(s+=` title="${G(e)}"`),s+=">",s}text(t){return"tokens"in t&&t.tokens?this.parser.parseInline(t.tokens):"escaped"in t&&t.escaped?t.text:G(t.text)}},Jt=class{strong({text:t}){return t}em({text:t}){return t}codespan({text:t}){return t}del({text:t}){return t}html({text:t}){return t}text({text:t}){return t}link({text:t}){return""+t}image({text:t}){return""+t}br(){return""}},Q=class Ct{constructor(e){R(this,"options");R(this,"renderer");R(this,"textRenderer");this.options=e||de,this.options.renderer=this.options.renderer||new Be,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Jt}static parse(e,n){return new Ct(n).parse(e)}static parseInline(e,n){return new Ct(n).parseInline(e)}parse(e,n=!0){var r,s;let i="";for(let c=0;c<e.length;c++){const a=e[c];if((s=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&s[a.type]){const o=a,u=this.options.extensions.renderers[o.type].call({parser:this},o);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){i+=u||"";continue}}const h=a;switch(h.type){case"space":{i+=this.renderer.space(h);continue}case"hr":{i+=this.renderer.hr(h);continue}case"heading":{i+=this.renderer.heading(h);continue}case"code":{i+=this.renderer.code(h);continue}case"table":{i+=this.renderer.table(h);continue}case"blockquote":{i+=this.renderer.blockquote(h);continue}case"list":{i+=this.renderer.list(h);continue}case"html":{i+=this.renderer.html(h);continue}case"paragraph":{i+=this.renderer.paragraph(h);continue}case"text":{let o=h,u=this.renderer.text(o);for(;c+1<e.length&&e[c+1].type==="text";)o=e[++c],u+=`
`+this.renderer.text(o);n?i+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):i+=u;continue}default:{const o='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}parseInline(e,n=this.renderer){var r,s;let i="";for(let c=0;c<e.length;c++){const a=e[c];if((s=(r=this.options.extensions)==null?void 0:r.renderers)!=null&&s[a.type]){const o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){i+=o||"";continue}}const h=a;switch(h.type){case"escape":{i+=n.text(h);break}case"html":{i+=n.html(h);break}case"link":{i+=n.link(h);break}case"image":{i+=n.image(h);break}case"strong":{i+=n.strong(h);break}case"em":{i+=n.em(h);break}case"codespan":{i+=n.codespan(h);break}case"br":{i+=n.br(h);break}case"del":{i+=n.del(h);break}case"text":{i+=n.text(h);break}default:{const o='Token with "'+h.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return i}},vt,Ke=(vt=class{constructor(t){R(this,"options");R(this,"block");this.options=t||de}preprocess(t){return t}postprocess(t){return t}processAllTokens(t){return t}provideLexer(){return this.block?J.lex:J.lexInline}provideParser(){return this.block?Q.parse:Q.parseInline}},R(vt,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),vt),xs=class{constructor(...t){R(this,"defaults",jt());R(this,"options",this.setOptions);R(this,"parse",this.parseMarkdown(!0));R(this,"parseInline",this.parseMarkdown(!1));R(this,"Parser",Q);R(this,"Renderer",Be);R(this,"TextRenderer",Jt);R(this,"Lexer",J);R(this,"Tokenizer",rt);R(this,"Hooks",Ke);this.use(...t)}walkTokens(t,e){var i,r;let n=[];for(const s of t)switch(n=n.concat(e.call(this,s)),s.type){case"table":{const c=s;for(const a of c.header)n=n.concat(this.walkTokens(a.tokens,e));for(const a of c.rows)for(const h of a)n=n.concat(this.walkTokens(h.tokens,e));break}case"list":{const c=s;n=n.concat(this.walkTokens(c.items,e));break}default:{const c=s;(r=(i=this.defaults.extensions)==null?void 0:i.childTokens)!=null&&r[c.type]?this.defaults.extensions.childTokens[c.type].forEach(a=>{const h=c[a].flat(1/0);n=n.concat(this.walkTokens(h,e))}):c.tokens&&(n=n.concat(this.walkTokens(c.tokens,e)))}}return n}use(...t){const e=this.defaults.extensions||{renderers:{},childTokens:{}};return t.forEach(n=>{const i={...n};if(i.async=this.defaults.async||i.async||!1,n.extensions&&(n.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if("renderer"in r){const s=e.renderers[r.name];s?e.renderers[r.name]=function(...c){let a=r.renderer.apply(this,c);return a===!1&&(a=s.apply(this,c)),a}:e.renderers[r.name]=r.renderer}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=e[r.level];s?s.unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}"childTokens"in r&&r.childTokens&&(e.childTokens[r.name]=r.childTokens)}),i.extensions=e),n.renderer){const r=this.defaults.renderer||new Be(this.defaults);for(const s in n.renderer){if(!(s in r))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const c=s,a=n.renderer[c],h=r[c];r[c]=(...o)=>{let u=a.apply(r,o);return u===!1&&(u=h.apply(r,o)),u||""}}i.renderer=r}if(n.tokenizer){const r=this.defaults.tokenizer||new rt(this.defaults);for(const s in n.tokenizer){if(!(s in r))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const c=s,a=n.tokenizer[c],h=r[c];r[c]=(...o)=>{let u=a.apply(r,o);return u===!1&&(u=h.apply(r,o)),u}}i.tokenizer=r}if(n.hooks){const r=this.defaults.hooks||new Ke;for(const s in n.hooks){if(!(s in r))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const c=s,a=n.hooks[c],h=r[c];Ke.passThroughHooks.has(s)?r[c]=o=>{if(this.defaults.async)return Promise.resolve(a.call(r,o)).then(d=>h.call(r,d));const u=a.call(r,o);return h.call(r,u)}:r[c]=(...o)=>{let u=a.apply(r,o);return u===!1&&(u=h.apply(r,o)),u}}i.hooks=r}if(n.walkTokens){const r=this.defaults.walkTokens,s=n.walkTokens;i.walkTokens=function(c){let a=[];return a.push(s.call(this,c)),r&&(a=a.concat(r.call(this,c))),a}}this.defaults={...this.defaults,...i}}),this}setOptions(t){return this.defaults={...this.defaults,...t},this}lexer(t,e){return J.lex(t,e??this.defaults)}parser(t,e){return Q.parse(t,e??this.defaults)}parseMarkdown(t){return(n,i)=>{const r={...i},s={...this.defaults,...r},c=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&r.async===!1)return c(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return c(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return c(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=t);const a=s.hooks?s.hooks.provideLexer():t?J.lex:J.lexInline,h=s.hooks?s.hooks.provideParser():t?Q.parse:Q.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(n):n).then(o=>a(o,s)).then(o=>s.hooks?s.hooks.processAllTokens(o):o).then(o=>s.walkTokens?Promise.all(this.walkTokens(o,s.walkTokens)).then(()=>o):o).then(o=>h(o,s)).then(o=>s.hooks?s.hooks.postprocess(o):o).catch(c);try{s.hooks&&(n=s.hooks.preprocess(n));let o=a(n,s);s.hooks&&(o=s.hooks.processAllTokens(o)),s.walkTokens&&this.walkTokens(o,s.walkTokens);let u=h(o,s);return s.hooks&&(u=s.hooks.postprocess(u)),u}catch(o){return c(o)}}}onError(t,e){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t){const i="<p>An error occurred:</p><pre>"+G(n.message+"",!0)+"</pre>";return e?Promise.resolve(i):i}if(e)return Promise.reject(n);throw n}}},ue=new xs;function T(t,e){return ue.parse(t,e)}T.options=T.setOptions=function(t){return ue.setOptions(t),T.defaults=ue.defaults,oi(T.defaults),T};T.getDefaults=jt;T.defaults=de;T.use=function(...t){return ue.use(...t),T.defaults=ue.defaults,oi(T.defaults),T};T.walkTokens=function(t,e){return ue.walkTokens(t,e)};T.parseInline=ue.parseInline;T.Parser=Q;T.parser=Q.parse;T.Renderer=Be;T.TextRenderer=Jt;T.Lexer=J;T.lexer=J.lex;T.Tokenizer=rt;T.Hooks=Ke;T.parse=T;T.options;T.setOptions;T.use;T.walkTokens;T.parseInline;Q.parse;J.lex;const st=new Be,Ss=st.link.bind(st);st.link=function(t){return Ss(t).replace("<a ",'<a target="_blank" rel="noopener" ')};T.setOptions({renderer:st,gfm:!0,breaks:!0});function Le(t){return T.parse(t,{async:!1})}function $s({message:t}){return t.role==="user"||t.role==="system"?l("div",{class:`message ${t.role}`,children:t.content}):l("div",{class:"message assistant",dangerouslySetInnerHTML:{__html:Le(t.content)}})}function Ts(){return l("div",{class:"thinking",children:[l("span",{}),l("span",{}),l("span",{})]})}function Cs({onScroll:t}){const e=pe(null),n=ce.value,i=Ne.value,r=be.value,s=ie.value;return X(()=>{const c=e.current;c&&(c.scrollTop=c.scrollHeight)},[n,i,s]),l("div",{ref:e,"data-messages":!0,style:Is,onScroll:t,children:[n.map((c,a)=>l($s,{message:c},a)),r&&i&&l("div",{class:"message assistant",dangerouslySetInnerHTML:{__html:Le(i)}}),s&&l(Ts,{})]})}const Is={flex:"1",overflowY:"auto",padding:"16px",display:"flex",flexDirection:"column",gap:"12px"},As="_form_572ba_1",Rs="_input_572ba_10",Ps="_sendBtn_572ba_28",ft={form:As,input:Rs,sendBtn:Ps};function Ls({onSend:t,onCancel:e}){const n=pe(null),i=_e.value,r=fe.value==="connected";function s(h){if(h.preventDefault(),i){e();return}const o=n.current;if(!o)return;const u=o.value.trim();u&&(t(u),o.value="",o.style.height="auto")}function c(){const h=n.current;h&&(h.style.height="auto",h.style.height=Math.min(h.scrollHeight,120)+"px")}function a(h){h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),s(h))}return l("form",{class:ft.form,onSubmit:s,children:[l("textarea",{ref:n,class:ft.input,placeholder:"Type a message...",rows:1,autoComplete:"off",disabled:i,onInput:c,onKeyDown:a}),l("button",{type:"submit",class:ft.sendBtn,disabled:!i&&!r,children:i?"Stop":"Send"})]})}const Ds="_chatArea_850fi_1",Es="_chatBody_850fi_9",Ms="_chatMain_850fi_16",Bs="_scrollBtn_850fi_24",Fe={chatArea:Ds,chatBody:Es,chatMain:Ms,scrollBtn:Bs};function zs({sidebarHidden:t,onNewChat:e,onSwitchChat:n,onDeleteChat:i,onManagePersonas:r}){const s=q.value,c=s?ii(s):null;function a(){s&&ne({type:"cancel",chatId:s}),_e.value=!1,ie.value=!1}X(()=>{function d(p){p.key==="Escape"&&_e.value&&(p.preventDefault(),a())}return document.addEventListener("keydown",d),()=>document.removeEventListener("keydown",d)},[s]);function h(d){if(!s)return;Ve("user",d),ie.value=!0,ni(s,d),xt(s);const p={type:"message",content:d,chatId:s};c&&(p.persona=c),ne(p),_e.value=!0}function o(d){const p=d.target,_=p.scrollHeight-p.scrollTop-p.clientHeight<100,f=document.getElementById("scroll-bottom-btn");f&&f.classList.toggle("hidden",_)}function u(){const d=document.querySelector("[data-messages]");d&&(d.scrollTop=d.scrollHeight)}return l("div",{class:Fe.chatArea,children:l("div",{class:Fe.chatBody,children:[l(Ur,{onNewChat:e,onSwitchChat:n,onDeleteChat:i,onManagePersonas:r,sidebarHidden:t}),l("div",{class:Fe.chatMain,children:[l(Cs,{onScroll:o}),l("button",{id:"scroll-bottom-btn",class:`${Fe.scrollBtn} hidden`,title:"Scroll to bottom",onClick:u,children:"↓"}),l(Ls,{onSend:h,onCancel:a})]})]})})}const vi=A([]),mi=A([]),yi=A({models:[],providers:[],agents:[]}),It=A("-"),At=A("-"),Rt=A("-"),Pt=A("-");function ki(t){return t==null?"0":t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":String(t)}function bi(t){return t==null?"—":t<.01?"<$0.01":"$"+t.toFixed(2)}function Ze(t){let e=0,n=0,i=!1;for(const s of t)e+=s.total_tokens||0,s.estimated_cost!=null&&(n+=s.estimated_cost,i=!0);let r=ki(e);return i&&n>0&&(r+=" ("+bi(n)+")"),r}async function Ns(){try{yi.value=await tr()}catch{}}async function Os(t){try{const n=await er(t);Array.isArray(n)&&(vi.value=n)}catch{}const e={...t};delete e.groupBy;try{const n=await $e(e);Array.isArray(n)&&(mi.value=n)}catch{}await Hs()}async function Hs(){const t=new Date,e=t.toISOString().slice(0,10),n=e+"T00:00:00Z",i=e+"T23:59:59Z";try{const o=await $e({from:n,to:i});It.value=Ze(o)}catch{It.value="-"}const r=t.getDay(),s=r===0?6:r-1,c=new Date(t);c.setDate(t.getDate()-s);const a=c.toISOString().slice(0,10)+"T00:00:00Z";try{const o=await $e({from:a,to:i});At.value=Ze(o)}catch{At.value="-"}const h=e.slice(0,7)+"-01T00:00:00Z";try{const o=await $e({from:h,to:i});Rt.value=Ze(o)}catch{Rt.value="-"}try{const o=await $e({});Pt.value=Ze(o)}catch{Pt.value="-"}}const Us="_view_jyvol_1",js="_content_jyvol_9",qs="_filters_jyvol_25",Fs="_summaryCards_jyvol_58",Zs="_card_jyvol_65",Ws="_cardLabel_jyvol_73",Gs="_cardValue_jyvol_79",Vs="_tableWrap_jyvol_85",Ks="_table_jyvol_85",Js="_sortAsc_jyvol_127",Qs="_sortDesc_jyvol_132",Xs="_noData_jyvol_137",M={view:Us,content:js,filters:qs,summaryCards:Fs,card:Zs,cardLabel:Ws,cardValue:Gs,tableWrap:Vs,table:Ks,sortAsc:Js,sortDesc:Qs,noData:Xs},Ys=[{key:"first",label:"Group"},{key:"calls",label:"Calls"},{key:"input_tokens",label:"Input"},{key:"output_tokens",label:"Output"},{key:"total_tokens",label:"Total"},{key:"cached_input_tokens",label:"Cached"},{key:"estimated_cost",label:"Cost"}];function mn(t){const e=t.trim();return e.endsWith("M")?parseFloat(e)*1e6:e.endsWith("K")?parseFloat(e)*1e3:parseFloat(e)||0}function _t(t,e,n){if(e==="first")return String(t[n]||"-");if(e==="estimated_cost")return bi(t.estimated_cost);const i=t[e];return ki(i)}function yn({rows:t,firstCol:e}){const[n,i]=S("total_tokens"),[r,s]=S(!1),c=Ys.map(o=>o.key==="first"?{...o,label:e==="date"?"Date":"Group"}:o);function a(o){o===n?s(!r):(i(o),s(!1))}const h=[...t].sort((o,u)=>{const d=_t(o,n,e),p=_t(u,n,e),_=mn(d),f=mn(p);return!isNaN(_)&&!isNaN(f)?r?_-f:f-_:r?d.localeCompare(p):p.localeCompare(d)});return t.length?l("div",{class:M.tableWrap,children:l("table",{class:M.table,children:[l("thead",{children:l("tr",{children:c.map(o=>l("th",{class:n===o.key?r?M.sortAsc:M.sortDesc:"",onClick:()=>a(o.key),children:o.label},o.key))})}),l("tbody",{children:h.map((o,u)=>l("tr",{children:c.map(d=>l("td",{children:_t(o,d.key,e)},d.key))},u))})]})}):l("div",{class:M.noData,children:"No data"})}function eo(){const[t,e]=S(""),[n,i]=S(""),[r,s]=S(""),[c,a]=S(""),[h,o]=S(""),[u,d]=S("model"),p=yi.value;X(()=>{Ns(),f()},[]);function _(){const g={};return t&&(g.from=t+"T00:00:00Z"),n&&(g.to=n+"T23:59:59Z"),r&&(g.model=r),c&&(g.provider=c),h&&(g.agent=h),u&&(g.groupBy=u),g}function f(){Os(_())}return l("div",{class:M.view,children:l("div",{class:M.content,children:[l("div",{class:M.filters,children:[l("label",{children:["From",l("input",{type:"date",value:t,onInput:g=>e(g.target.value)})]}),l("label",{children:["To",l("input",{type:"date",value:n,onInput:g=>i(g.target.value)})]}),l("label",{children:["Model",l("select",{value:r,onChange:g=>s(g.target.value),children:[l("option",{value:"",children:"All"}),p.models.map(g=>l("option",{value:g,children:g},g))]})]}),l("label",{children:["Provider",l("select",{value:c,onChange:g=>a(g.target.value),children:[l("option",{value:"",children:"All"}),p.providers.map(g=>l("option",{value:g,children:g},g))]})]}),l("label",{children:["Agent",l("select",{value:h,onChange:g=>o(g.target.value),children:[l("option",{value:"",children:"All"}),p.agents.map(g=>l("option",{value:g,children:g},g))]})]}),l("label",{children:["Group by",l("select",{value:u,onChange:g=>d(g.target.value),children:[l("option",{value:"model",children:"Model"}),l("option",{value:"provider",children:"Provider"}),l("option",{value:"agent",children:"Agent"}),l("option",{value:"session",children:"Session"}),l("option",{value:"call_type",children:"Call Type"})]})]}),l("button",{class:"btn-primary",style:{alignSelf:"flex-end",padding:"6px 16px",fontSize:"13px"},onClick:f,children:"Refresh"})]}),l("div",{class:M.summaryCards,children:[l("div",{class:M.card,children:[l("div",{class:M.cardLabel,children:"Today"}),l("div",{class:M.cardValue,children:It.value})]}),l("div",{class:M.card,children:[l("div",{class:M.cardLabel,children:"This Week"}),l("div",{class:M.cardValue,children:At.value})]}),l("div",{class:M.card,children:[l("div",{class:M.cardLabel,children:"This Month"}),l("div",{class:M.cardValue,children:Rt.value})]}),l("div",{class:M.card,children:[l("div",{class:M.cardLabel,children:"All Time"}),l("div",{class:M.cardValue,children:Pt.value})]})]}),l("h3",{children:"Summary"}),l(yn,{rows:vi.value,firstCol:"group_key"}),l("h3",{children:"Daily Breakdown"}),l(yn,{rows:mi.value,firstCol:"date"})]})})}const wi=A([]),Lt=A(!1);async function ve(){try{wi.value=await nr()}catch(t){console.error("Failed to load tasks:",t)}}function dt({visible:t,onClose:e,wide:n,children:i}){return t?l("div",{class:"modal",onClick:r=>{r.target===r.currentTarget&&e()},children:l("div",{class:`modal-content${n?" modal-wide":""}`,children:i})}):null}const to="_view_sylgi_1",no="_board_sylgi_9",io="_column_sylgi_18",ro="_columnHeader_sylgi_30",so="_columnTitle_sylgi_39",oo="_columnCount_sylgi_47",ao="_cards_sylgi_56",lo="_dragOver_sylgi_66",co="_card_sylgi_56",uo="_dragging_sylgi_88",ho="_cardTitle_sylgi_92",po="_priorityDot_sylgi_101",fo="_priorityLow_sylgi_108",_o="_priorityMedium_sylgi_111",go="_priorityHigh_sylgi_114",vo="_priorityUrgent_sylgi_117",mo="_cardMeta_sylgi_121",yo="_cardAssignee_sylgi_128",ko="_cardTag_sylgi_142",bo="_detailContent_sylgi_152",wo="_detailHeader_sylgi_165",xo="_detailTitleInput_sylgi_173",So="_detailId_sylgi_188",$o="_detailBody_sylgi_202",To="_detailLeft_sylgi_208",Co="_detailRight_sylgi_217",Io="_detailMeta_sylgi_226",Ao="_sectionLabel_sylgi_260",Ro="_description_sylgi_268",Po="_descriptionPlaceholder_sylgi_288",Lo="_descriptionEdit_sylgi_294",Do="_taskMessages_sylgi_310",Eo="_taskMessagesEmpty_sylgi_324",Mo="_taskInputForm_sylgi_331",Bo="_editorForm_sylgi_372",w={view:to,board:no,column:io,columnHeader:ro,columnTitle:so,columnCount:oo,cards:ao,dragOver:lo,card:co,dragging:uo,cardTitle:ho,priorityDot:po,priorityLow:fo,priorityMedium:_o,priorityHigh:go,priorityUrgent:vo,cardMeta:mo,cardAssignee:yo,cardTag:ko,detailContent:bo,detailHeader:wo,detailTitleInput:xo,detailId:So,detailBody:$o,detailLeft:To,detailRight:Co,detailMeta:Io,sectionLabel:Ao,description:Ro,descriptionPlaceholder:Po,descriptionEdit:Lo,taskMessages:Do,taskMessagesEmpty:Eo,taskInputForm:Mo,editorForm:Bo};function zo({visible:t,task:e,onClose:n}){const[i,r]=S(""),[s,c]=S(""),[a,h]=S("medium"),[o,u]=S(""),[d,p]=S(""),_=Y.value;X(()=>{t&&(e?(r(e.title),c(e.description||""),h(e.priority||"medium"),u(e.assignee||""),p((e.tags||[]).join(", "))):(r(""),c(""),h("medium"),u(""),p("")))},[t,e]);async function f(v){v.preventDefault();const y=d.split(",").map(m=>m.trim()).filter(m=>m.length>0);try{if(e){await Kn(e.id,{title:i,description:s,priority:a,tags:y});const m=o||null,L=e.assignee||null;m!==L&&await Xn(e.id,m)}else await ir({title:i,description:s,priority:a,assignee:o||null,tags:y});await ve(),n()}catch(m){console.error("Task save failed:",m)}}async function g(){!e||!confirm("Delete this task?")||(await Jn(e.id),await ve(),n())}return l(dt,{visible:t,onClose:n,wide:!0,children:[l("h3",{children:e?"Edit Task":"New Task"}),l("form",{class:w.editorForm,onSubmit:f,children:[l("label",{children:["Title",l("input",{type:"text",required:!0,placeholder:"Task title",value:i,onInput:v=>r(v.target.value)})]}),l("label",{children:["Description",l("textarea",{rows:3,placeholder:"Markdown description...",value:s,onInput:v=>c(v.target.value)})]}),l("label",{children:["Priority",l("select",{value:a,onChange:v=>h(v.target.value),children:[l("option",{value:"low",children:"Low"}),l("option",{value:"medium",children:"Medium"}),l("option",{value:"high",children:"High"}),l("option",{value:"urgent",children:"Urgent"})]})]}),l("label",{children:["Assignee",l("select",{value:o,onChange:v=>u(v.target.value),children:[l("option",{value:"",children:"Unassigned"}),_.map(v=>l("option",{value:v.key,children:v.name},v.key))]})]}),l("label",{children:["Tags (comma-separated)",l("input",{type:"text",placeholder:"e.g. bug, frontend",value:d,onInput:v=>p(v.target.value)})]}),l("div",{class:"modal-actions",children:[e&&l("button",{type:"button",class:"btn-danger",style:{marginRight:"auto"},onClick:g,children:"Delete"}),l("button",{type:"button",class:"btn-secondary",style:{width:"auto"},onClick:n,children:"Cancel"}),l("button",{type:"submit",class:"btn-primary",children:"Save"})]})]})]})}function No({task:t,onClose:e}){const[n,i]=S(t.title),[r,s]=S(t.status),[c,a]=S(t.priority),[h,o]=S(t.assignee||""),[u,d]=S((t.tags||[]).join(", ")),[p,_]=S(t.description||""),[f,g]=S(!1),v=pe(null),y=pe(null),m=Y.value,L=W.value,k=nt.value,b=Re.value,P=pe(t.status),D=pe(t.assignee||"");X(()=>(St.value=t.id,W.value=[],nt.value="",Re.value=!1,ne({type:"get_task_history",chatId:t.id}),()=>{St.value=null}),[t.id]),X(()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)},[L,k]);async function N(){const x=u.split(",").map(V=>V.trim()).filter(V=>V.length>0),j=[];j.push(Kn(t.id,{title:n,description:p,priority:c,tags:x})),r!==P.current&&j.push(Qn(t.id,r).then(()=>{P.current=r})),h!==D.current&&j.push(Xn(t.id,h||null).then(()=>{D.current=h})),await Promise.all(j).catch(V=>console.error("Save failed:",V))}function F(){N().then(()=>{ve(),e()})}async function ee(){confirm("Delete this task?")&&(await Jn(t.id),await ve(),e())}function Qt(x){x.preventDefault();const j=y.current;if(!j)return;const V=j.value.trim();V&&(W.value=[...W.value,{role:"user",content:V}],j.value="",ne({type:"task_message",chatId:t.id,content:V}))}function xi(){const x="task:"+t.id;navigator.clipboard.writeText(x).catch(()=>{})}return l("div",{class:"modal",onClick:x=>{x.target===x.currentTarget&&F()},children:l("div",{class:w.detailContent,children:[l("div",{class:w.detailHeader,children:[l("input",{type:"text",class:w.detailTitleInput,placeholder:"Task title",value:n,onInput:x=>i(x.target.value),onChange:()=>N()}),l("span",{class:w.detailId,onClick:xi,children:["#",t.id]}),l("button",{class:"btn-danger btn-sm",title:"Delete task",onClick:ee,children:"Delete"}),l("button",{class:"btn-text",title:"Close",onClick:F,children:"×"})]}),l("div",{class:w.detailBody,children:[l("div",{class:w.detailLeft,children:[l("div",{class:w.detailMeta,children:[l("label",{children:["Status",l("select",{value:r,onChange:x=>{s(x.target.value),N()},children:[l("option",{value:"backlog",children:"Backlog"}),l("option",{value:"todo",children:"Todo"}),l("option",{value:"in_progress",children:"In Progress"}),l("option",{value:"done",children:"Done"})]})]}),l("label",{children:["Priority",l("select",{value:c,onChange:x=>{a(x.target.value),N()},children:[l("option",{value:"low",children:"Low"}),l("option",{value:"medium",children:"Medium"}),l("option",{value:"high",children:"High"}),l("option",{value:"urgent",children:"Urgent"})]})]}),l("label",{children:["Assignee",l("select",{value:h,onChange:x=>{o(x.target.value),N()},children:[l("option",{value:"",children:"Unassigned"}),m.map(x=>l("option",{value:x.key,children:x.name},x.key))]})]}),l("label",{children:["Tags",l("input",{type:"text",placeholder:"comma-separated",value:u,onInput:x=>d(x.target.value),onChange:()=>N()})]})]}),l("div",{class:w.sectionLabel,children:"Description"}),f?l("textarea",{class:w.descriptionEdit,placeholder:"Description (markdown supported)...",value:p,onInput:x=>_(x.target.value),onBlur:()=>{g(!1),N()},autoFocus:!0}):l("div",{class:w.description,onClick:()=>g(!0),dangerouslySetInnerHTML:{__html:p?Le(p):'<span class="'+w.descriptionPlaceholder+'">Click to add a description...</span>'}})]}),l("div",{class:w.detailRight,children:[l("div",{class:w.taskMessages,ref:v,children:[L.length===0&&!b&&l("div",{class:w.taskMessagesEmpty,children:"No messages yet. Start a conversation about this task."}),L.map((x,j)=>l("div",{class:`message ${x.role}`,children:x.role==="assistant"?l("span",{dangerouslySetInnerHTML:{__html:Le(x.content)}}):x.content},j)),b&&k&&l("div",{class:"message assistant",dangerouslySetInnerHTML:{__html:Le(k)}})]}),l("form",{class:w.taskInputForm,onSubmit:Qt,children:[l("textarea",{ref:y,placeholder:"Discuss this task...",rows:1,onKeyDown:x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),Qt(x))},onInput:x=>{const j=x.target;j.style.height="auto",j.style.height=Math.min(j.scrollHeight,120)+"px"}}),l("button",{type:"submit",children:"Send"})]})]})]})]})})}const Oo=[{key:"backlog",label:"Backlog"},{key:"todo",label:"Todo"},{key:"in_progress",label:"In Progress"},{key:"done",label:"Done"}],kn={urgent:0,high:1,medium:2,low:3};function Ho(t){switch(t){case"low":return w.priorityLow;case"medium":return w.priorityMedium;case"high":return w.priorityHigh;case"urgent":return w.priorityUrgent;default:return w.priorityMedium}}function Uo({initialTaskId:t}){const[e]=S(null),[n,i]=S(null),[r,s]=S(null),c=Lt.value,a=wi.value,h=Y.value;X(()=>{ve()},[]),X(()=>{if(t&&a.length>0){const f=a.find(g=>g.id===t);f&&i(f)}},[t,a]);const o={backlog:[],todo:[],in_progress:[],done:[]};for(const f of a)o[f.status]&&o[f.status].push(f);for(const f of Object.values(o))f.sort((g,v)=>(kn[g.priority]??3)-(kn[v.priority]??3));function u(f,g){var y;f.preventDefault(),s(null);const v=(y=f.dataTransfer)==null?void 0:y.getData("text/plain");!v||!g||Qn(v,g).then(()=>ve())}function d(f){i(f),Me("tasks",f.id)}function p(){i(null),Me("tasks")}function _(f){const g=h.find(v=>v.key===f);return(g==null?void 0:g.color)||"var(--accent)"}return l("div",{class:w.view,children:[l("div",{class:w.board,children:Oo.map(({key:f,label:g})=>l("div",{class:w.column,children:[l("div",{class:w.columnHeader,children:[l("span",{class:w.columnTitle,children:g}),l("span",{class:w.columnCount,children:o[f].length})]}),l("div",{class:`${w.cards}${r===f?` ${w.dragOver}`:""}`,onDragOver:v=>{v.preventDefault(),s(f)},onDragLeave:()=>s(null),onDrop:v=>u(v,f),children:o[f].map(v=>{var y;return l("div",{class:w.card,draggable:!0,onDragStart:m=>{var L;(L=m.dataTransfer)==null||L.setData("text/plain",v.id),m.target.classList.add(w.dragging)},onDragEnd:m=>{m.target.classList.remove(w.dragging)},onClick:()=>d(v),children:[l("div",{class:w.cardTitle,children:[l("span",{class:`${w.priorityDot} ${Ho(v.priority)}`}),v.title]}),(v.assignee||v.tags&&v.tags.length>0)&&l("div",{class:w.cardMeta,children:[v.assignee&&l("span",{class:w.cardAssignee,style:{background:_(v.assignee)},title:v.assignee,children:v.assignee.charAt(0)}),(y=v.tags)==null?void 0:y.map(m=>l("span",{class:w.cardTag,children:m},m))]})]},v.id)})})]},f))}),l(zo,{visible:c,task:e,onClose:()=>{Lt.value=!1}}),n&&l(No,{task:n,onClose:p})]})}const jo="_list_1b5ps_1",qo="_card_1b5ps_7",Fo="_name_1b5ps_19",Zo="_desc_1b5ps_24",Wo="_tier_1b5ps_30",Se={list:jo,card:qo,name:Fo,desc:Zo,tier:Wo};function Go({visible:t,personas:e,onSelect:n,onCancel:i}){return l(dt,{visible:t,onClose:i,children:[l("h3",{children:"Choose a Persona"}),l("div",{class:Se.list,children:e.map(r=>l("div",{class:Se.card,onClick:()=>n(r.key),children:[l("div",{class:Se.name,children:r.name}),r.description&&l("div",{class:Se.desc,children:r.description}),r.modelTier&&r.modelTier!=="default"&&l("div",{class:Se.tier,children:["Model: ",r.modelTier]})]},r.key))}),l("button",{class:"btn-secondary",onClick:()=>n(null),children:"No Persona (default)"}),l("button",{class:"btn-text",onClick:i,children:"Cancel"})]})}const Vo="_list_1kr7a_1",Ko="_item_1kr7a_7",Jo="_info_1kr7a_16",Qo="_name_1kr7a_21",Xo="_desc_1kr7a_26",Yo="_actions_1kr7a_34",ea="_empty_1kr7a_41",se={list:Vo,item:Ko,info:Jo,name:Qo,desc:Xo,actions:Yo,empty:ea};function ta({visible:t,onClose:e,onEdit:n}){const i=Y.value;async function r(s,c){confirm(`Delete persona "${c}"?`)&&(await Qi(s),await Ut())}return l(dt,{visible:t,onClose:e,wide:!0,children:[l("div",{class:"modal-header",children:[l("h3",{children:"Manage Personas"}),l("button",{class:"btn-text",onClick:e,children:"×"})]}),l("div",{class:se.list,children:[i.map(s=>l("div",{class:se.item,children:[l("div",{class:se.info,children:[l("div",{class:se.name,children:s.name}),l("div",{class:se.desc,children:s.description||s.key})]}),l("div",{class:se.actions,children:[l("button",{class:"btn-text",onClick:()=>{e(),n(s)},children:"Edit"}),l("button",{class:"btn-danger",onClick:()=>r(s.key,s.name),children:"Delete"})]})]},s.key)),i.length===0&&l("div",{class:se.empty,children:"No personas yet. Create one to get started."})]}),l("button",{class:"btn-primary",onClick:()=>{e(),n(null)},children:"+ New Persona"})]})}const na="_form_14npq_1",ia="_labelWithAction_14npq_41",bn={form:na,labelWithAction:ia};function ra({visible:t,persona:e,onClose:n}){const[i,r]=S(""),[s,c]=S(""),[a,h]=S(""),[o,u]=S(""),[d,p]=S(""),[_,f]=S("default"),[g,v]=S(!1),y=si.value;X(()=>{t&&(wr(),e?(r(e.key),c(e.name),h(e.description||""),u(e.preamble||""),p(e.color||""),f(e.modelTier||"default")):(r(""),c(""),h(""),u(""),p(""),f("default")))},[t,e]);async function m(k){k.preventDefault();const b={key:i,name:s,description:a,preamble:o,modelTier:_,color:d};try{e?await Ji(e.key,b):await Ki(b),await Ut(),n()}catch(P){alert("Error: "+(P instanceof Error?P.message:String(P)))}}async function L(){if(!s.trim()){alert("Enter a persona name first.");return}v(!0);try{const k=await Xi({name:s.trim(),description:a.trim()});k.preamble&&u(k.preamble)}catch(k){alert("Generation failed: "+(k instanceof Error?k.message:String(k)))}finally{v(!1)}}return l(dt,{visible:t,onClose:n,wide:!0,children:[l("h3",{children:e?"Edit Persona":"New Persona"}),l("form",{class:bn.form,onSubmit:m,children:[l("label",{children:["Key (unique ID)",l("input",{type:"text",required:!0,placeholder:"e.g. coder",value:i,disabled:!!e,onInput:k=>r(k.target.value)})]}),l("label",{children:["Name",l("input",{type:"text",required:!0,placeholder:"e.g. Code Assistant",value:s,onInput:k=>c(k.target.value)})]}),l("label",{children:["Description",l("input",{type:"text",placeholder:"Short description",value:a,onInput:k=>h(k.target.value)})]}),l("label",{children:["Color",l("div",{class:"color-swatches",children:Sr.map(k=>l("div",{class:`color-swatch${k===d?" selected":""}`,style:{background:k},onClick:()=>p(k)},k))})]}),l("label",{children:[l("span",{class:bn.labelWithAction,children:["System Prompt",l("button",{type:"button",class:"btn-inline",disabled:g,onClick:L,children:g?"Generating...":"Generate"})]}),l("textarea",{rows:5,placeholder:"Custom system prompt...",value:o,onInput:k=>u(k.target.value)})]}),l("label",{children:["Model Tier",l("select",{value:_,onChange:k=>f(k.target.value),children:[!y.includes("default")&&l("option",{value:"default",children:"default"}),y.map(k=>l("option",{value:k,children:k},k))]})]}),l("div",{class:"modal-actions",children:[l("button",{type:"button",class:"btn-secondary",style:{width:"auto"},onClick:n,children:"Cancel"}),l("button",{type:"submit",class:"btn-primary",children:"Save"})]})]})]})}function wn(t){window.innerWidth<=768&&t(!0)}function sa(){const[t,e]=S(window.innerWidth<=768),[n,i]=S(!1),[r,s]=S(!1),[c,a]=S(null),[h,o]=S(!1),u=Ee.value.name,d=Ee.value.param;function p(b){const P=or();ei({id:P,title:"New Chat",updatedAt:new Date().toISOString(),persona:b}),ne({type:"create_session",chatId:P,content:b||""}),q.value=P,Ae(),Me("chats",P),wn(e)}function _(){Y.value.length>0?o(!0):p(null)}function f(b){q.value=b,sr(b),Ae(),ne({type:"get_history",chatId:b}),Me("chats",b),wn(e)}function g(b){fetch(`/api/sessions/${encodeURIComponent(b)}`,{method:"DELETE"}).catch(()=>{}),ne({type:"delete_session",chatId:b}),ti(b),b===q.value&&(E.value.length>0?f(E.value[0].id):(q.value=null,Ae(),_()))}function v(b){a(b),s(!0)}function y(){const b=q.value;if(!b)return;const P="web:"+b;navigator.clipboard.writeText(P).catch(()=>{const D=document.createElement("textarea");D.value=P,D.style.position="fixed",D.style.opacity="0",document.body.appendChild(D),D.select(),document.execCommand("copy"),document.body.removeChild(D)})}function m(){var b;switch(u){case"chats":{const P=q.value,D=P?ii(P):null,N=D?xr(D):null;return l(ae,{children:[N&&l("span",{class:"persona-badge",children:[l("span",{class:"header-avatar",style:{background:N.color||"#888"},children:((b=N.name)==null?void 0:b.charAt(0))||"P"}),l("span",{children:N.name||N.key})]}),P&&l("span",{style:{fontSize:"11px",fontFamily:"monospace",color:"var(--text-secondary)",opacity:.5,cursor:"pointer",userSelect:"none"},title:"Click to copy session key",onClick:y,children:P.slice(0,8)})]})}case"tasks":return l("button",{class:"btn-primary btn-sm",onClick:()=>{Lt.value=!0},children:"+ New Task"});default:return null}}const L=u==="chats";function k(){switch(u){case"tasks":return l(Uo,{initialTaskId:d});case"usage":return l(eo,{});case"chats":default:return l(zs,{sidebarHidden:t,onNewChat:_,onSwitchChat:f,onDeleteChat:g,onManagePersonas:()=>i(!0)})}}return l(ae,{children:[l(br,{onToggleSidebar:()=>e(!t),showSidebarToggle:L,children:m()}),l("div",{class:"mainArea",children:k()}),l(Go,{visible:h,personas:Y.value,onSelect:b=>{o(!1),p(b)},onCancel:()=>{o(!1),E.value.length===0&&p(null)}}),l(ta,{visible:n,onClose:()=>i(!1),onEdit:v}),l(ra,{visible:r,persona:c,onClose:()=>s(!1)})]})}rr();ar();const gt=Ee.peek();gt.name==="chats"&&gt.param?q.value=gt.param:E.value.length>0&&(q.value=E.value[0].id);Ut();Ht();Di(l(sa,{}),document.getElementById("app"));</script>
    <style rel="stylesheet" crossorigin>._header_ps8v4_1{display:flex;align-items:center;height:48px;padding:0 16px;border-bottom:1px solid var(--border);background:var(--bg);flex-shrink:0;gap:12px}._hamburger_ps8v4_12{display:block;background:none;border:none;color:var(--text);font-size:20px;cursor:pointer;padding:4px;flex-shrink:0}._brand_ps8v4_23{font-size:16px;font-weight:700;flex-shrink:0;margin-right:8px}._nav_ps8v4_30{display:flex;gap:2px;flex:1}._navTab_ps8v4_36{padding:6px 14px;background:none;border:none;border-bottom:2px solid transparent;color:var(--text-secondary);font-size:13px;font-weight:500;font-family:inherit;cursor:pointer;transition:color .15s,border-color .15s}._navTab_ps8v4_36:hover{color:var(--text)}._navTabActive_ps8v4_55{color:var(--accent);border-bottom-color:var(--accent)}._actions_ps8v4_61{display:flex;align-items:center;gap:8px}@media(max-width:768px){._brand_ps8v4_23{display:none}}._sidebar_1v6to_1{width:260px;flex-shrink:0;background:var(--sidebar-bg);border-right:1px solid var(--border);display:flex;flex-direction:column;height:100%;overflow:hidden}._header_1v6to_12{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border);flex-shrink:0}._title_1v6to_21{font-size:16px;font-weight:600}._actions_1v6to_26{display:flex;gap:4px}._iconBtn_1v6to_31{width:32px;height:32px;border:1px solid var(--border);border-radius:6px;background:var(--bg);color:var(--text-secondary);font-size:16px;cursor:pointer;display:flex;align-items:center;justify-content:center}._iconBtn_1v6to_31:hover{background:var(--bg-tertiary);color:var(--text)}._newChatBtn_1v6to_50{color:var(--text);font-size:18px}._sessionList_1v6to_56{flex:1;overflow-y:auto;padding:8px}._sessionItem_1v6to_62{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:6px;cursor:pointer;margin-bottom:2px;overflow:hidden;position:relative}._sessionItem_1v6to_62:hover{background:var(--sidebar-hover)}._sessionItem_1v6to_62._active_1v6to_78{background:var(--sidebar-active)}._avatar_1v6to_82{width:28px;height:28px;border-radius:50%;flex-shrink:0;display:flex;align-items:center;justify-content:center;color:#fff;font-size:13px;font-weight:600;text-transform:uppercase}._content_1v6to_96{flex:1;min-width:0}._title_1v6to_21{font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:flex;align-items:center;gap:8px}._unreadDot_1v6to_111{width:8px;height:8px;border-radius:50%;background:var(--accent);flex-shrink:0}._time_1v6to_119{font-size:11px;color:var(--text-secondary);margin-top:2px}._deleteBtn_1v6to_125{display:none;position:absolute;right:8px;top:50%;transform:translateY(-50%);background:var(--bg-secondary);border:1px solid var(--border);border-radius:4px;color:var(--text-secondary);font-size:12px;width:20px;height:20px;cursor:pointer;align-items:center;justify-content:center;padding:0;line-height:1}._deleteBtn_1v6to_125:hover{color:var(--status-disconnected);border-color:var(--status-disconnected)}._sessionItem_1v6to_62:hover ._deleteBtn_1v6to_125{display:flex}._form_572ba_1{display:flex;gap:8px;padding:12px 16px;border-top:1px solid var(--border);background:var(--bg);flex-shrink:0}._input_572ba_10{flex:1;padding:10px 14px;border:1px solid var(--border);border-radius:8px;background:var(--bg-secondary);color:var(--text);font-family:inherit;font-size:16px;resize:none;max-height:120px;outline:none}._input_572ba_10:focus{border-color:var(--accent)}._sendBtn_572ba_28{padding:10px 20px;background:var(--accent);color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;flex-shrink:0}._sendBtn_572ba_28:hover{opacity:.9}._chatArea_850fi_1{flex:1;display:flex;flex-direction:column;height:100%;min-width:0}._chatBody_850fi_9{flex:1;display:flex;flex-direction:row;min-height:0}._chatMain_850fi_16{flex:1;display:flex;flex-direction:column;min-width:0;position:relative}._scrollBtn_850fi_24{position:absolute;bottom:80px;right:24px;width:36px;height:36px;border-radius:50%;border:1px solid var(--border);background:var(--bg-secondary);color:var(--text);font-size:18px;cursor:pointer;opacity:.7;z-index:10}._scrollBtn_850fi_24:hover{opacity:1}._view_jyvol_1{flex:1;display:flex;flex-direction:column;height:100%;min-width:0}._content_jyvol_9{flex:1;overflow-y:auto;padding:16px 24px}._content_jyvol_9 h3{font-size:15px;font-weight:600;margin:20px 0 10px}._content_jyvol_9 h3:first-of-type{margin-top:16px}._filters_jyvol_25{display:flex;flex-wrap:wrap;gap:10px;align-items:flex-end}._filters_jyvol_25 label{display:flex;flex-direction:column;gap:3px;font-size:12px;color:var(--text-secondary)}._filters_jyvol_25 input,._filters_jyvol_25 select{padding:6px 8px;border:1px solid var(--border);border-radius:6px;background:var(--bg-secondary);color:var(--text);font-family:inherit;font-size:13px;outline:none;min-width:120px}._filters_jyvol_25 input:focus,._filters_jyvol_25 select:focus{border-color:var(--accent)}._summaryCards_jyvol_58{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px;margin-top:16px}._card_jyvol_65{background:var(--bg-secondary);border:1px solid var(--border);border-radius:8px;padding:14px 16px;text-align:center}._cardLabel_jyvol_73{font-size:12px;color:var(--text-secondary);margin-bottom:4px}._cardValue_jyvol_79{font-size:22px;font-weight:700;color:var(--text)}._tableWrap_jyvol_85{overflow-x:auto}._table_jyvol_85{width:100%;border-collapse:collapse;font-size:13px}._table_jyvol_85 th,._table_jyvol_85 td{padding:8px 12px;border:1px solid var(--border);text-align:left}._table_jyvol_85 th{background:var(--bg-tertiary);font-weight:600;-webkit-user-select:none;user-select:none;white-space:nowrap;cursor:pointer}._table_jyvol_85 th:hover{background:var(--border)}._table_jyvol_85 td:not(:first-child){text-align:right;font-variant-numeric:tabular-nums}._table_jyvol_85 tr:nth-child(2n){background:color-mix(in srgb,var(--bg-tertiary) 40%,transparent)}._table_jyvol_85 tr:hover{background:color-mix(in srgb,var(--accent) 8%,transparent)}._sortAsc_jyvol_127:after{content:" ▲";font-size:10px}._sortDesc_jyvol_132:after{content:" ▼";font-size:10px}._noData_jyvol_137{text-align:center;color:var(--text-secondary);padding:12px}@media(max-width:768px){._content_jyvol_9{padding:12px}._filters_jyvol_25{flex-direction:column;align-items:stretch}._filters_jyvol_25 label{width:100%}._filters_jyvol_25 input,._filters_jyvol_25 select{width:100%;min-width:0}._summaryCards_jyvol_58{grid-template-columns:repeat(2,1fr)}}._view_sylgi_1{flex:1;display:flex;flex-direction:column;height:100%;min-width:0}._board_sylgi_9{flex:1;display:flex;gap:12px;padding:16px;overflow-x:auto;align-items:flex-start}._column_sylgi_18{flex:1;min-width:220px;max-width:320px;background:var(--bg-secondary);border:1px solid var(--border);border-radius:10px;display:flex;flex-direction:column;max-height:calc(100vh - 90px)}._columnHeader_sylgi_30{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-bottom:1px solid var(--border);flex-shrink:0}._columnTitle_sylgi_39{font-size:13px;font-weight:600;text-transform:uppercase;letter-spacing:.5px;color:var(--text-secondary)}._columnCount_sylgi_47{font-size:11px;font-weight:600;background:var(--bg-tertiary);color:var(--text-secondary);padding:2px 7px;border-radius:10px}._cards_sylgi_56{flex:1;overflow-y:auto;padding:8px;display:flex;flex-direction:column;gap:6px;min-height:40px}._dragOver_sylgi_66{background:color-mix(in srgb,var(--accent) 8%,transparent);border-radius:0 0 10px 10px}._card_sylgi_56{background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:10px 12px;cursor:pointer;transition:box-shadow .15s,border-color .15s;-webkit-user-select:none;user-select:none}._card_sylgi_56:hover{border-color:var(--accent);box-shadow:0 2px 8px #00000014}._dragging_sylgi_88{opacity:.4}._cardTitle_sylgi_92{font-size:13px;font-weight:500;margin-bottom:6px;display:flex;align-items:center;gap:6px}._priorityDot_sylgi_101{width:8px;height:8px;border-radius:50%;flex-shrink:0}._priorityLow_sylgi_108{background:#94a3b8}._priorityMedium_sylgi_111{background:#3b82f6}._priorityHigh_sylgi_114{background:#f59e0b}._priorityUrgent_sylgi_117{background:#ef4444}._cardMeta_sylgi_121{display:flex;align-items:center;gap:6px;flex-wrap:wrap}._cardAssignee_sylgi_128{font-size:11px;font-weight:600;width:20px;height:20px;border-radius:50%;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;text-transform:uppercase}._cardTag_sylgi_142{font-size:10px;padding:1px 6px;background:var(--bg-tertiary);color:var(--text-secondary);border-radius:4px}._detailContent_sylgi_152{background:var(--bg);border:1px solid var(--border);border-radius:12px;max-width:1100px;width:95vw;max-height:90vh;display:flex;flex-direction:column;padding:0;overflow:hidden}._detailHeader_sylgi_165{display:flex;align-items:center;gap:8px;padding:16px 20px 8px;border-bottom:1px solid var(--border)}._detailTitleInput_sylgi_173{flex:1;font-size:18px;font-weight:600;border:none;background:transparent;color:var(--text);outline:none;padding:4px 0}._detailTitleInput_sylgi_173::placeholder{color:var(--text-secondary)}._detailId_sylgi_188{font-size:11px;font-family:monospace;color:var(--text-secondary);flex-shrink:0;opacity:.7;cursor:pointer;-webkit-user-select:none;user-select:none}._detailId_sylgi_188:hover{opacity:1}._detailBody_sylgi_202{display:flex;flex:1;overflow:hidden}._detailLeft_sylgi_208{width:300px;flex-shrink:0;overflow-y:auto;border-right:1px solid var(--border);display:flex;flex-direction:column}._detailRight_sylgi_217{flex:1;display:flex;flex-direction:column;min-width:0;min-height:0;overflow:hidden}._detailMeta_sylgi_226{display:flex;flex-wrap:wrap;gap:8px;padding:10px 16px;border-bottom:1px solid var(--border)}._detailMeta_sylgi_226 label{display:flex;flex-direction:column;gap:2px;font-size:11px;color:var(--text-secondary);flex:1 1 calc(50% - 4px);min-width:100px}._detailMeta_sylgi_226 select,._detailMeta_sylgi_226 input{padding:4px 8px;border:1px solid var(--border);border-radius:4px;background:var(--bg-secondary);color:var(--text);font-size:13px;outline:none}._detailMeta_sylgi_226 select:focus,._detailMeta_sylgi_226 input:focus{border-color:var(--accent)}._sectionLabel_sylgi_260{padding:8px 16px 4px;font-size:11px;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.5px}._description_sylgi_268{padding:12px 20px;font-size:13px;color:var(--text-secondary);flex:1;overflow-y:auto;cursor:pointer;min-height:80px;line-height:1.5}._description_sylgi_268 ul,._description_sylgi_268 ol{padding-left:1.5em}._description_sylgi_268:hover{background:var(--bg-secondary)}._descriptionPlaceholder_sylgi_288{color:var(--text-secondary);font-style:italic;opacity:.6}._descriptionEdit_sylgi_294{padding:12px 20px;font-size:13px;color:var(--text);flex:1;min-height:80px;font-family:inherit;line-height:1.5;border:none;outline:none;background:var(--bg-secondary);resize:none;width:100%;box-sizing:border-box}._taskMessages_sylgi_310{flex:1;overflow-y:auto;padding:12px 20px;display:flex;flex-direction:column;gap:8px;min-height:200px}._taskMessages_sylgi_310 ._message_sylgi_320{max-width:90%}._taskMessagesEmpty_sylgi_324{color:var(--text-secondary);font-size:13px;text-align:center;padding:40px 0}._taskInputForm_sylgi_331{display:flex;gap:8px;padding:10px 20px 16px;border-top:1px solid var(--border)}._taskInputForm_sylgi_331 textarea{flex:1;padding:8px 12px;border:1px solid var(--border);border-radius:8px;background:var(--bg-secondary);color:var(--text);font-family:inherit;font-size:14px;resize:none;outline:none;max-height:120px}._taskInputForm_sylgi_331 textarea:focus{border-color:var(--accent)}._taskInputForm_sylgi_331 button{padding:8px 16px;background:var(--accent);color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;align-self:flex-end}._taskInputForm_sylgi_331 button:hover{opacity:.9}._editorForm_sylgi_372{display:flex;flex-direction:column;gap:12px}._editorForm_sylgi_372 label{display:flex;flex-direction:column;gap:4px;font-size:13px;color:var(--text-secondary)}._editorForm_sylgi_372 input,._editorForm_sylgi_372 textarea,._editorForm_sylgi_372 select{padding:8px 10px;border:1px solid var(--border);border-radius:6px;background:var(--bg-secondary);color:var(--text);font-family:inherit;font-size:14px;outline:none}._editorForm_sylgi_372 input:focus,._editorForm_sylgi_372 textarea:focus,._editorForm_sylgi_372 select:focus{border-color:var(--accent)}._editorForm_sylgi_372 textarea{resize:vertical;min-height:60px}@media(max-width:768px){._board_sylgi_9{padding:8px;gap:8px}._column_sylgi_18{min-width:200px}}@media(max-width:600px){._detailBody_sylgi_202{flex-direction:column}._detailLeft_sylgi_208{width:100%;border-right:none;border-bottom:1px solid var(--border);max-height:40vh;overflow-y:auto}._taskMessages_sylgi_310{min-height:0}}._list_1b5ps_1{display:flex;flex-direction:column;gap:8px}._card_1b5ps_7{padding:10px 12px;border:1px solid var(--border);border-radius:8px;cursor:pointer;transition:border-color .15s}._card_1b5ps_7:hover{border-color:var(--accent)}._name_1b5ps_19{font-size:14px;font-weight:500}._desc_1b5ps_24{font-size:12px;color:var(--text-secondary);margin-top:2px}._tier_1b5ps_30{font-size:11px;color:var(--text-secondary);margin-top:4px;font-style:italic}._list_1kr7a_1{display:flex;flex-direction:column;gap:6px}._item_1kr7a_7{display:flex;align-items:center;justify-content:space-between;padding:8px 10px;border:1px solid var(--border);border-radius:6px}._info_1kr7a_16{flex:1;min-width:0}._name_1kr7a_21{font-size:14px;font-weight:500}._desc_1kr7a_26{font-size:12px;color:var(--text-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}._actions_1kr7a_34{display:flex;gap:4px;flex-shrink:0;margin-left:8px}._empty_1kr7a_41{text-align:center;color:var(--text-secondary);font-size:13px;padding:16px 0}._form_14npq_1{display:flex;flex-direction:column;gap:12px}._form_14npq_1 label{display:flex;flex-direction:column;gap:4px;font-size:13px;color:var(--text-secondary)}._form_14npq_1 input,._form_14npq_1 textarea,._form_14npq_1 select{padding:8px 10px;border:1px solid var(--border);border-radius:6px;background:var(--bg-secondary);color:var(--text);font-family:inherit;font-size:14px;outline:none}._form_14npq_1 input:focus,._form_14npq_1 textarea:focus,._form_14npq_1 select:focus{border-color:var(--accent)}._form_14npq_1 textarea{resize:vertical;min-height:80px;font-family:SF Mono,Fira Code,Cascadia Code,monospace;font-size:13px}._labelWithAction_14npq_41{display:flex;align-items:center;justify-content:space-between}:root{--bg: #ffffff;--bg-secondary: #f5f5f5;--bg-tertiary: #ebebeb;--text: #1a1a1a;--text-secondary: #666666;--border: #e0e0e0;--user-bg: #0066cc;--user-text: #ffffff;--assistant-bg: #f0f0f0;--assistant-text: #1a1a1a;--code-bg: #f5f5f5;--code-border: #ddd;--accent: #0066cc;--status-connected: #22c55e;--status-disconnected: #ef4444;--status-reconnecting: #f59e0b;--sidebar-bg: #f8f8f8;--sidebar-active: #e8e8e8;--sidebar-hover: #f0f0f0}@media(prefers-color-scheme:dark){:root{--bg: #1a1a1a;--bg-secondary: #2a2a2a;--bg-tertiary: #333333;--text: #e0e0e0;--text-secondary: #999999;--border: #333333;--user-bg: #0066cc;--user-text: #ffffff;--assistant-bg: #2a2a2a;--assistant-text: #e0e0e0;--code-bg: #333333;--code-border: #444;--accent: #4d94ff;--sidebar-bg: #222222;--sidebar-active: #333333;--sidebar-hover: #2a2a2a}}*{margin:0;padding:0;box-sizing:border-box}body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;background:var(--bg);color:var(--text);height:100dvh;overflow:hidden}#app{display:flex;flex-direction:column;height:100dvh}.mainArea{display:flex;flex-direction:row;flex:1;min-height:0}.modal{position:fixed;top:0;right:0;bottom:0;left:0;z-index:200;display:flex;align-items:center;justify-content:center;background:#0006}.modal.hidden{display:none}.modal-content{background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:24px;max-width:420px;width:90%;max-height:80vh;overflow-y:auto;display:flex;flex-direction:column;gap:12px}.modal-content.modal-wide{max-width:520px}.modal-content h3{font-size:16px;font-weight:600}.modal-header{display:flex;align-items:center;justify-content:space-between}.modal-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:4px}.btn-primary{padding:8px 16px;background:var(--accent);color:#fff;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer}.btn-primary:hover{opacity:.9}.btn-secondary{padding:8px 16px;background:var(--bg-secondary);color:var(--text);border:1px solid var(--border);border-radius:6px;font-size:13px;cursor:pointer;width:100%}.btn-secondary:hover{background:var(--bg-tertiary)}.btn-text{background:none;border:none;color:var(--text-secondary);font-size:14px;cursor:pointer;padding:4px 8px}.btn-text:hover{color:var(--text)}.btn-danger{background:none;border:none;color:var(--status-disconnected);font-size:12px;cursor:pointer;padding:2px 6px}.btn-danger:hover{text-decoration:underline}.btn-sm{font-size:12px;padding:4px 8px}.btn-inline{background:none;border:none;color:var(--accent);cursor:pointer;font-size:12px;padding:0}.btn-inline:hover{text-decoration:underline}.hidden{display:none!important}.message ul,.message ol{padding-left:1.5em}.message{max-width:80%;padding:10px 14px;border-radius:12px;line-height:1.5;font-size:14px;word-wrap:break-word;overflow-wrap:break-word}.message.user{align-self:flex-end;background:var(--user-bg);color:var(--user-text);border-bottom-right-radius:4px}.message.assistant{align-self:flex-start;background:var(--assistant-bg);color:var(--assistant-text);border-bottom-left-radius:4px}.message.system{align-self:center;background:transparent;color:var(--text-secondary);font-size:12px;font-style:italic}.thinking{display:flex;gap:4px;padding:8px 14px;align-self:flex-start}.thinking span{width:8px;height:8px;border-radius:50%;background:var(--text-secondary);animation:pulse 1.4s infinite ease-in-out}.thinking span:nth-child(2){animation-delay:.2s}.thinking span:nth-child(3){animation-delay:.4s}@keyframes pulse{0%,80%,to{opacity:.3;transform:scale(.8)}40%{opacity:1;transform:scale(1)}}.status{font-size:12px;padding:2px 8px;border-radius:10px;font-weight:500;flex-shrink:0}.status.connected{color:var(--status-connected)}.status.disconnected{color:var(--status-disconnected)}.status.reconnecting{color:var(--status-reconnecting)}.persona-badge{font-size:11px;color:var(--accent);font-weight:500;padding:1px 6px;background:color-mix(in srgb,var(--accent) 10%,transparent);border-radius:4px;display:inline-flex;align-items:center;gap:4px}.header-avatar{width:18px;height:18px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;color:#fff;font-size:10px;font-weight:600;text-transform:uppercase;flex-shrink:0}.color-swatches{display:flex;flex-wrap:wrap;gap:6px;margin-top:4px}.color-swatch{width:24px;height:24px;border-radius:50%;cursor:pointer;border:2px solid transparent;transition:border-color .15s}.color-swatch:hover{border-color:var(--text-secondary)}.color-swatch.selected{border-color:var(--text);box-shadow:0 0 0 2px var(--bg)}.dropdown{position:absolute;left:0;top:calc(100% + 4px);background:var(--bg);border:1px solid var(--border);border-radius:8px;box-shadow:0 4px 12px #00000026;min-width:140px;z-index:50;padding:4px 0}.dropdown-item{display:block;width:100%;padding:8px 14px;background:none;border:none;color:var(--text);font-size:13px;text-align:left;cursor:pointer;font-family:inherit}.dropdown-item:hover{background:var(--sidebar-hover)}.dropdown-item.active{color:var(--accent);font-weight:600}@media(max-width:768px){.sidebar{position:fixed;left:0;top:0;bottom:0;z-index:100;transform:translate(0);transition:transform .2s ease}.sidebar-hidden .sidebar{transform:translate(-100%)}.sidebar-toggle-btn{display:block!important}.sidebar-overlay{position:fixed;top:0;right:0;bottom:0;left:0;background:#0000004d;z-index:99}}.message.assistant p{margin-bottom:8px}.message.assistant p:last-child{margin-bottom:0}.message.assistant code{background:var(--code-bg);padding:2px 5px;border-radius:3px;font-family:SF Mono,Fira Code,Cascadia Code,monospace;font-size:13px}.message.assistant pre{background:var(--code-bg);border:1px solid var(--code-border);border-radius:6px;padding:10px;margin:8px 0;overflow-x:auto;font-size:13px}.message.assistant pre code{background:none;padding:0;font-size:inherit}.message.assistant ul,.message.assistant ol{margin:4px 0;padding-left:20px}.message.assistant a{color:var(--accent);text-decoration:underline}.message.assistant blockquote{border-left:3px solid var(--border);padding-left:10px;margin:4px 0;color:var(--text-secondary)}.message.assistant table{border-collapse:collapse;margin:8px 0;font-size:13px;width:100%}.message.assistant th,.message.assistant td{border:1px solid var(--border);padding:6px 10px}.message.assistant th{background:var(--bg-tertiary);font-weight:600}.message.assistant tr:nth-child(2n){background:color-mix(in srgb,var(--bg-tertiary) 40%,transparent)}</style>
  </head>
  <body>
    <div id="app"></div>
  </body>
</html>
